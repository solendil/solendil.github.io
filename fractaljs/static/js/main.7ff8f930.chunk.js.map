{"version":3,"sources":["engine/scheduler/worker/interface.worker.js","engine/fractals sync //.([jt]s)$","engine/fractals/burningbird.ts","engine/fractals/burningship.ts","engine/fractals/example.ts","engine/fractals/mandelbrot.ts","engine/fractals/mandelbrot3.ts","engine/fractals/mandelbrot4.ts","engine/fractals/tippetts.ts","util/EventBus.ts","engine/scheduler/worker.ts","engine/scheduler/scheduler.ts","engine/redrawer.ts","engine/fractals.ts","engine/renderer.ts","util/palette.ts","engine/painter.ts","engine/math/vector.ts","engine/math/matrix.ts","engine/math/camera.ts","engine/engine.ts","redux/set.ts","util/keybinder.ts","redux/controller.ts","redux/improver.ts","redux/colors.ts","redux/url.ts","redux/ui.ts","redux/rdxengine.ts","ui/pages/Fractal.tsx","ui/pages/Palette.tsx","ui/pages/Settings.tsx","util/misc.ts","ui/pages/About.tsx","ui/pages/Debug.tsx","ui/Share.tsx","ui/Toolbar.tsx","ui/Navigation.tsx","ui/InfoBox.tsx","ui/Snackbar.tsx","ui/App.tsx","serviceWorker.ts","redux/reducer.ts","index.tsx"],"names":["module","exports","Worker","__webpack_public_path__","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","iLog2","Math","log","fractalId","uiOrder","name","preset","x","y","w","iter","fn","normal","cx","cy","zny","zx","zy","sqx","sqy","i","abs","smooth","j","znx","hidden","iLog4","EventBus","constructor","listeners","this","on","evt","callback","push","notify","obj","setTimeout","callbacks","forEach","cb","available","worker","WorkerInterface","postMessage","action","onmessage","bind","draw","order","tile","buffer","length","Float32Array","width","height","event","data","Scheduler","ctx","orders","workers","upperCallback","batchId","handlers","nbThreads","shift","every","interrupt","reject","schedule","Promise","Redrawer","canvas","offCanvas","context","lastId","lastType","lastMatrix","document","createElement","redraw","newMatrix","type","tileSorter","m","inverse","multiply","imageData","getImageData","getContext","putImageData","clearRect","transform","a","b","c","d","f","drawImage","setTransform","reverse","require","byId","filename","default","getPreset","res","Renderer","painter","engine","nbTiles","scheduler","redrawer","imageBuffer","tiles","resize","createImageData","Uint32Array","ratio","tileNbHeight","round","sqrt","tileNbWidth","console","debug","toFixed","x1","x2","y1","y2","indexScreen","getIterationsAt","cpx","getFunction","func","getHistogram","histogram","Array","fill","val","drawColor","paint","params","tileSort","camera","matrix","workerModel","assign","model","t","dist","sort","catch","standardGradients","0","1","2","3","4","5","10","11","12","13","14","15","16","17","18","19","createInterpolant","xs","ys","result","indexes","oldXs","oldYs","dys","dxs","ms","dx","dy","c1s","mNext","dxNext","common","cpx2scr","c3s","c1","invDx","mid","low","high","floor","xHere","max","diff","diffSq","getBufferFromId","resolution","gradient","indices","reds","greens","blues","Int32Array","split","stop","items","Number","parseInt","substring","interR","interG","interB","byteBuffer","Uint8Array","bufferIndex","floatIndex","buildBuffer","buildBufferFromStringGradient","Painter","p","offset","density","set","tx","ty","color","cbuffer","tileIndex","Vector","midPoint","v2","minus","v","plus","times","minVal","min","Matrix","isIdentity","isInvertible","deter","inverseGaussJordan","dt","gje","M","c1i","c2i","c2","gjet","toString","t1px","t1py","t1qx","t1qy","t1rx","t1ry","t2px","t2py","t2qx","t2qy","t2rx","t2ry","STD2T1","STD2T2","T12STD","angle","cos","sin","identity","Camera","screenSize","pos","affineMatrix","matrix_inv","screen","resolutionLimit","extent","reproject","S2Q","affineTransform","q","r","GetTriangleToTriangle","getScreenToSquareMatrix","Q2C","valuex","valuey","GetRotationMatrix","GetShearMatrix","GetScaleMatrix","affineReset","clone","scr2cpx","getPos","setPos","isZoomLimit","Engine","renderer","navigator","hardwareConcurrency","viewport","details","ui","createSlice","initialState","reducers","setSet","state","payload","updateSet","reducer","actions","left","up","right","down","esc","A","B","C","D","E","F","G","H","I","J","K","L","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","keymap","bindings","addEventListener","keyCode","modifier","shiftKey","binding","combo","k","bindKeys","keysStr","keycodes","key","ANGLE","PI","Controller","dispatch","setupKeyboard","setupMouse","setupTouch","pan","scr_vector_delta","cam","scr_vector","cpx_point_0","cpx_point_dest","cpx_vector","cpx_new_point","changeXY","zoom","delta","scr_point_arg","scr_point","cpx_point","Î”","hammer","Hammer","dragStart","cameraStart","isDragging","get","direction","DIRECTION_ALL","threshold","enable","center","cpx_new","isPinching","pinchStart","ev","pc1","pc2","scale","pc0A","z","window","preventDefault","deltaY","point","offsetX","offsetY","Improver","engineArg","getState","frameId","lastState","sleep","duration","analysePicture","histo","nbTotal","reduce","acc","nbInSet","minIter","MAX_VALUE","maxIter","iterRange","nbFringe10p","ceil","percInSet","percFringe10p","shouldIncrease","shouldDecrease","size","analysis","setColorId","setOffset","setDensity","setPaint","defaults","fs","ct","co","cd","cf","va","vb","vc","vd","update","args","String","str","entries","join","history","replaceState","error","read","url","location","hash","startsWith","rawArgs","substr","tuple","parts","desc","parseFloat","readCurrentScheme","readInit","forceCold","urlData","omit","drawer","mouseOnCanvas","tab","infobox","mouse","narrowDevice","orientableDevice","setDrawer","setTab","setInfobox","setMouseOnCanvas","setMouseInfo","setNarrowDevice","setSnack","snack","initEngine","getWindowSize","innerWidth","innerHeight","onMediaChange","media","matches","matchMedia","addListener","debounce","init","throttle","urlUpdate","undefined","changeFractalType","setValues","colorActions","changeSmooth","pt","setColorOffset","setColorDensity","colors","Fractal","useDispatch","useSelector","buttons","values","filter","ListItem","button","onClick","selected","ListItemText","primary","List","component","subheader","ListSubheader","DENSITY","gradients","colorBuffer","dataURL","toDataURL","useStyles","makeStyles","theme","swatches","display","flexWrap","marginRight","spacing","paddingBottom","paddingRight","position","borderRadius","bottom","fontSize","padding","textShadow","txt","Palette","classes","alt","src","className","densitySlider","dense","Typography","Slider","step","value","onChange","_","Settings","ListItemSecondaryAction","Switch","edge","target","checked","createStyles","avatar","backgroundColor","palette","main","inline","verticalAlign","border","background","margin","minWidth","textAlign","Keys","Speech","variant","rel","href","SimpleCard","style","maxWidth","maxTouchPoints","msMaxTouchPoints","ListItemAvatar","Avatar","secondary","orientation","userAgent","indexOf","Divider","data-color-scheme","data-size","data-show-count","aria-label","Debug","Share","props","nav","share","IconButton","title","text","bar","fade","backdropFilter","breakpoints","only","flexDirection","icons","brand","lineHeight","writingMode","fontFamily","paddingTop","letterSpacing","fontWeight","flexGrow","textDecoration","ToolBar","navigation","def","tabId","icon","Boolean","splice","fractal","settings","about","appBar","top","trans","borderTopLeftRadius","borderTopRightRadius","handle","Navigation","bigDevice","useMediaQuery","content","SwipeableDrawer","anchor","open","disableDiscovery","disableSwipeToOpen","PaperProps","BackdropProps","invisible","onClose","onOpen","box","InfoBox","Paper","elevation","gutterBottom","Box","toExponential","snackbar","MySnackbar","Snackbar","message","App","ref","useRef","React","useEffect","current","canvasClass","isLocalhost","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","root","combineReducers","store","configureStore","createMuiTheme","sm","md","lg","xl","ReactDOM","render","ThemeProvider","getElementById","URL","process","origin","fetch","headers","response","contentType","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"2FAAAA,EAAOC,QAAU,WACf,OAAO,IAAIC,OAAOC,IAA0B,oC,gFCD9C,IAAIC,EAAM,CACT,mBAAoB,IACpB,mBAAoB,IACpB,eAAgB,IAChB,kBAAmB,IACnB,mBAAoB,IACpB,mBAAoB,IACpB,gBAAiB,KAIlB,SAASC,EAAeC,GACvB,IAAIC,EAAKC,EAAsBF,GAC/B,OAAOG,EAAoBF,GAE5B,SAASC,EAAsBF,GAC9B,IAAIG,EAAoBC,EAAEN,EAAKE,GAAM,CACpC,IAAIK,EAAI,IAAIC,MAAM,uBAAyBN,EAAM,KAEjD,MADAK,EAAEE,KAAO,mBACHF,EAEP,OAAOP,EAAIE,GAEZD,EAAeS,KAAO,WACrB,OAAOC,OAAOD,KAAKV,IAEpBC,EAAeW,QAAUR,EACzBR,EAAOC,QAAUI,EACjBA,EAAeE,GAAK,K,iCC1BpB,OACA,IAAIU,EAAQ,EAAMC,KAAKC,IAAI,GAEZ,WACbC,UAAW,cACXC,QAAS,IACTC,KAAM,eACNC,OAAQ,CAAEC,GAAI,IAAMC,EAAG,IAAMC,EAAG,KAAMC,KAAM,IAC5CC,GAAI,CACFC,OAAQ,CAACC,EAAIC,EAAIJ,KACf,IAMEK,EANEC,EAAK,EACPC,EAAK,EACLC,EAAM,EACNC,EAAM,EACNC,EAAI,EAIN,IADAN,GAAMA,EAEJC,GAAOC,EAAKA,GAAMC,EAAKH,EAEvBE,EADME,EAAMC,EAAMN,EAElBI,EAAKhB,KAAKoB,IAAIN,OACRK,GAAKV,OACXQ,EAAMF,EAAKA,IACXG,EAAMF,EAAKA,GAzBJ,KA4BT,OAAOG,GAETE,OAAQ,CAACT,EAAIC,EAAIJ,KACf,IAKEa,EAEAR,EAPEC,EAAK,EACPC,EAAK,EACLC,EAAM,EACNC,EAAM,EACNC,EAAI,EAKN,IADAN,GAAMA,EAEJC,GAAOC,EAAKA,GAAMC,EAAKH,EAEvBE,EADME,EAAMC,EAAMN,EAElBI,EAAKhB,KAAKoB,IAAIN,OACRK,GAAKV,OACXQ,EAAMF,EAAKA,IACXG,EAAMF,EAAKA,GA/CJ,KAkDT,GAAIG,IAAMV,EAAM,OAAOU,EACvB,IAAKG,EAAI,EAAGA,EAAI,IAAKA,EACnBR,GAAOC,EAAKA,GAAMC,EAAKH,EAIvBI,GAFAF,EADME,EAAMC,EAAMN,GAGPG,EACXG,GAFAF,EAAKhB,KAAKoB,IAAIN,IAEHE,EAEb,OAAO,EAAIG,EAAInB,KAAKC,IAAID,KAAKC,IAAIgB,EAAMC,IAAQnB,M,iCC3DrD,OACA,IAAIA,EAAQ,EAAMC,KAAKC,IAAI,GAEZ,WACbC,UAAW,cACXC,QAAS,EACTC,KAAM,eACNC,OAAQ,CAAEC,GAAI,GAAKC,EAAG,IAAMC,EAAG,EAAGC,KAAM,IACxCC,GAAI,CACFC,OAAQ,CAACC,EAAIC,EAAIJ,KACf,IAKEc,EACAT,EANEC,EAAK,EACPC,EAAK,EACLC,EAAM,EACNC,EAAM,EACNC,EAAI,EAIN,IADAN,GAAMA,EAEJC,GAAOC,EAAKA,GAAMC,EAAKH,EACvBU,EAAMN,EAAMC,EAAMN,EAClBG,EAAKf,KAAKoB,IAAIG,GACdP,EAAKhB,KAAKoB,IAAIN,OACRK,GAAKV,OACXQ,EAAMF,EAAKA,IACXG,EAAMF,EAAKA,GAzBJ,KA4BT,OAAOG,GAETE,OAAQ,CAACT,EAAIC,EAAIJ,KACf,IAKEa,EACAC,EACAT,EAPEC,EAAK,EACPC,EAAK,EACLC,EAAM,EACNC,EAAM,EACNC,EAAI,EAKN,IADAN,GAAMA,EAEJC,GAAOC,EAAKA,GAAMC,EAAKH,EACvBU,EAAMN,EAAMC,EAAMN,EAClBG,EAAKf,KAAKoB,IAAIG,GACdP,EAAKhB,KAAKoB,IAAIN,OACRK,GAAKV,OACXQ,EAAMF,EAAKA,IACXG,EAAMF,EAAKA,GA/CJ,KAkDT,GAAIG,IAAMV,EAAM,OAAOU,EACvB,IAAKG,EAAI,EAAGA,EAAI,IAAKA,EACnBR,GAAOC,EAAKA,GAAMC,EAAKH,EACvBU,EAAMN,EAAMC,EAAMN,EAGlBK,GAFAF,EAAKf,KAAKoB,IAAIG,IAEHR,EACXG,GAFAF,EAAKhB,KAAKoB,IAAIN,IAEHE,EAEb,OAAO,EAAIG,EAAInB,KAAKC,IAAID,KAAKC,IAAIgB,EAAMC,IAAQnB,M,iCC3CrD,OAAe,WACbG,UAAW,UACXsB,QAAQ,EACRrB,SAAU,EACVC,KAAM,UACNC,OAAQ,CACNC,GAAI,GACJC,EAAG,EACHC,EAAG,IACHC,KAAM,IAERC,GAAI,CACFC,OAAQ,CAACC,EAAIC,EAAIJ,IACR,EAETY,OAAQ,CAACT,EAAIC,EAAIJ,IACR,K,iCChCb,OACA,IAAIV,EAAQ,EAAMC,KAAKC,IAAI,GAEZ,WACbC,UAAW,aACXC,QAAS,EACTC,KAAM,aACNC,OAAQ,CAAEC,GAAI,GAAKC,EAAG,EAAKC,EAAG,IAAKC,KAAM,IACzCC,GAAI,CACFC,OAAQ,CAACC,EAAIC,EAAIJ,KAMf,IALA,IAAIc,EAAM,EACRT,EAAM,EACNG,EAAM,EACNC,EAAM,EACNC,EAAI,EACCA,EAAIV,GAAQQ,EAAMC,GAfhB,IAeiCC,EACxCL,GAAOS,EAAMA,GAAOT,EAAMD,EAE1BI,GADAM,EAAMN,EAAMC,EAAMN,GACNW,EACZL,EAAMJ,EAAMA,EAEd,OAAOK,GAETE,OAAQ,CAACT,EAAIC,EAAIJ,KAOf,IANA,IAAIc,EAAM,EACRT,EAAM,EACNG,EAAM,EACNC,EAAM,EACNC,EAAI,EACJG,EAAI,EACCH,EAAIV,GAAQQ,EAAMC,GA9BhB,IA8BiCC,EACxCL,GAAOS,EAAMA,GAAOT,EAAMD,EAE1BI,GADAM,EAAMN,EAAMC,EAAMN,GACNW,EACZL,EAAMJ,EAAMA,EAEd,GAAIK,IAAMV,EAAM,OAAOU,EACvB,IAAKG,EAAI,EAAGA,EAAI,IAAKA,EACnBR,GAAOS,EAAMA,GAAOT,EAAMD,EAE1BI,GADAM,EAAMN,EAAMC,EAAMN,GACNW,EACZL,EAAMJ,EAAMA,EAEd,OAAO,EAAIK,EAAInB,KAAKC,IAAID,KAAKC,IAAIgB,EAAMC,IAAQnB,M,iCC3CrD,OACA,IAAI0B,EAAQ,EAAMzB,KAAKC,IAAI,GAEZ,WACbC,UAAW,cACXC,QAAS,EACTC,KAAM,eACNC,OAAQ,CAAEC,EAAG,EAAKC,EAAG,EAAKC,EAAG,EAAKC,KAAM,IACxCC,GAAI,CACFC,OAAQ,CAACC,EAAIC,EAAIJ,KAQf,IAPA,IAAIM,EAAK,EACPC,EAAK,EACLC,EAAM,EACNC,EAAM,EACNC,EAAI,EAMJJ,EAFME,EAAMF,EAAK,EAAIA,EAAKG,EAAMN,EAGhCI,EAFM,EAAIC,EAAMD,EAAKE,EAAMF,EAAKH,MAG1BM,GAAKV,OACXQ,EAAMF,EAAKA,IACXG,EAAMF,EAAKA,GAxBJ,KA2BT,OAAOG,GAETE,OAAQ,CAACT,EAAIC,EAAIJ,KASf,IARA,IAKEa,EAEAR,EAPEC,EAAK,EACPC,EAAK,EACLC,EAAM,EACNC,EAAM,EACNC,EAAI,EAOJJ,EAFME,EAAMF,EAAK,EAAIA,EAAKG,EAAMN,EAGhCI,EAFAF,EAAM,EAAIG,EAAMD,EAAKE,EAAMF,EAAKH,MAG1BM,GAAKV,OACXQ,EAAMF,EAAKA,IACXG,EAAMF,EAAKA,GA7CJ,KAgDT,GAAIG,IAAMV,EAAM,OAAOU,EACvB,IAAKG,EAAI,EAAGA,EAAI,IAAKA,EAEnBR,EAAM,EAAIG,EAAMD,EAAKE,EAAMF,EAAKH,EAGhCI,GAFAF,EAFME,EAAMF,EAAK,EAAIA,EAAKG,EAAMN,GAIrBG,EACXG,GAFAF,EAAKF,GAEME,EAEb,OAAO,EAAIG,EAAInB,KAAKC,IAAID,KAAKC,IAAIgB,EAAMC,IAAQO,M,iCCzDrD,OACA,IAAIA,EAAQ,EAAMzB,KAAKC,IAAI,GAEZ,WACbC,UAAW,cACXC,QAAS,EACTC,KAAM,eACNC,OAAQ,CAAEC,EAAG,EAAKC,EAAG,EAAKC,EAAG,EAAKC,KAAM,IACxCC,GAAI,CACFC,OAAQ,CAACC,EAAIC,EAAIJ,KAQf,IAPA,IAMEK,EANEC,EAAK,EACPC,EAAK,EACLC,EAAM,EACNC,EAAM,EACNC,EAAI,EAKJL,EAAM,EAAIG,EAAMF,EAAKC,EAAK,EAAID,EAAKG,EAAMF,EAAKH,EAC9CE,EAFME,EAAMA,EAAM,EAAIA,EAAMC,EAAMA,EAAMA,EAAMN,EAG9CI,EAAKF,MACCK,GAAKV,OACXQ,EAAMF,EAAKA,IACXG,EAAMF,EAAKA,GAxBJ,KA2BT,OAAOG,GAETE,OAAQ,CAACT,EAAIC,EAAIJ,KAQf,IAPA,IAMEK,EANEC,EAAK,EACPC,EAAK,EACLC,EAAM,EACNC,EAAM,EACNC,EAAI,EAKJL,EAAM,EAAIG,EAAMF,EAAKC,EAAK,EAAID,EAAKG,EAAMF,EAAKH,EAC9CE,EAFME,EAAMA,EAAM,EAAIA,EAAMC,EAAMA,EAAMA,EAAMN,EAG9CI,EAAKF,MACCK,GAAKV,OACXQ,EAAMF,EAAKA,IACXG,EAAMF,EAAKA,GA5CJ,KA+CT,OAAIG,IAAMV,EAAaU,EAChB,EAAIA,EAAInB,KAAKC,IAAID,KAAKC,IAAIgB,EAAMC,IAAQO,M,iCChDrD,OAEe,WACbvB,UAAW,WACXC,QAAS,EACTC,KAAM,WACNC,OAAQ,CAAEC,GAAI,GAAKC,EAAG,EAAKC,EAAG,EAAGC,KAAM,IACvCC,GAAI,CACFC,OAAQ,CAACC,EAAIC,EAAIJ,KAMf,IALA,IAAIM,EAAK,EACPC,EAAK,EACLC,EAAM,EACNC,EAAM,EACNC,EAAI,EACCA,EAAIV,GAAQQ,EAAMC,GAdhB,IAciCC,EAGxCF,GAFAF,EAAKE,EAAMC,EAAMN,GAENG,EACXG,GAFAF,GAAMD,EAAKA,GAAMC,EAAKH,GAEXG,EAEb,OAAOG,M,oMCpBE,MAAMO,EAKnBC,cAAe,KAJPC,eAIM,EACZC,KAAKD,UAAY,GAGnBE,GAAGC,EAAaC,GACRD,KAAOF,KAAKD,YAAYC,KAAKD,UAAUG,GAAO,IACpDF,KAAKD,UAAUG,GAAKE,KAAKD,GAG3BE,OAAOH,EAAaI,GAElBC,WAAW,KACT,MAAMC,EAAYR,KAAKD,UAAUG,IAAQ,GACrCI,IAAKA,EAAIJ,IAAMA,GACnBM,EAAUC,QAAQC,IAChBA,EAAGJ,MAEJ,I,8BCVQ,MAAMnD,EAOnB2C,YAAYtC,EAAY2C,GAA0B,KAN3C3C,QAM0C,OAL1CmD,WAAqB,EAKqB,KAHzCC,YAGyC,OAFzCT,cAEyC,EAC/CH,KAAKxC,GAAKA,EACVwC,KAAKY,OAAU,IAAIC,IACnBb,KAAKY,OAAOE,YAAY,CAAEC,OAAQ,OAAQvD,OAC1CwC,KAAKY,OAAOI,UAAYhB,KAAKgB,UAAUC,KAAKjB,MAC5CA,KAAKG,SAAWA,EAGlBe,KAAKC,GACH,MAAMC,EAAOD,EAAMC,KACQ,IAAvBA,EAAKC,OAAOC,SAEdF,EAAKC,OAAS,IAAIE,aAAaH,EAAKI,MAAQJ,EAAKK,SAEnDzB,KAAKW,WAAY,EACjBX,KAAKY,OAAOE,YAAYK,EAAO,CAACC,EAAKC,OAAOA,SAG9CL,UAAUU,GACR,MAAMC,EAAuBD,EAAMC,KACnC3B,KAAKW,WAAY,EACjBX,KAAKG,SAASH,KAAM2B,IChCT,MAAMC,EAUnB9B,YAAY+B,EAAc1B,GAA2C,KAT7D2B,OAAsB,GASsC,KAR5DC,QAAoB,GAQwC,KAP5DC,mBAO4D,OAN5DC,QAAkB,EAM0C,KAL7DC,cAK6D,EAClElC,KAAKgC,cAAgB7B,EACrB,IAAK,IAAIb,EAAI,EAAGA,EAAIuC,EAAIM,UAAW7C,GAAK,EACtCU,KAAK+B,QAAQ3B,KAAK,IAAIjD,EAAOmC,EAAGU,KAAKG,SAASc,KAAKjB,QAI/CG,SAASS,EAAgBe,GAC3BA,EAAKM,UAAYjC,KAAKiC,SAASjC,KAAKgC,cAAcL,GACtD,MAAMR,EAAQnB,KAAK8B,OAAOM,QACtBjB,EACFP,EAAOM,KAAKC,GAERnB,KAAK+B,QAAQM,MAAM1D,GAAKA,EAAEgC,YAAYX,KAAKkC,SAASjE,UAI5DqE,YACEtC,KAAK8B,OAAS,GACV9B,KAAKkC,UAAUlC,KAAKkC,SAASK,SAG7BC,SAASV,GAAsB,IAAD,yHAElC,EAAKG,UACL,EAAKH,OAASA,EAAOzE,IAAIM,GAAC,eAAUA,EAAV,CAAasE,QAAS,EAAKA,WACrD,EAAKF,QAAQtB,QAAQG,IACnB,MAAMO,EAAQ,EAAKW,OAAOM,QACtBjB,GAAOP,EAAOM,KAAKC,KANS,kBAS3B,IAAIsB,QAAQ,CAACxE,EAASsE,KAC3B,EAAKL,SAAW,CAAEjE,UAASsE,aAVK,8CCvCvB,MAAMG,EAQnB5C,YAAY+B,GAAe,KAPnBc,YAOkB,OANlBC,eAMkB,OALlBC,aAKkB,OAJlBC,OAAwB,KAIN,KAHlBC,SAA0B,KAGR,KAFlBC,WAA4B,KAGlChD,KAAK2C,OAASd,EAAIc,OAClB3C,KAAK6C,QAAUhB,EAAIgB,QACnB7C,KAAK4C,UAAYK,SAASC,cAAc,UACxClD,KAAK4C,UAAUpB,MAAQxB,KAAK2C,OAAOnB,MACnCxB,KAAK4C,UAAUnB,OAASzB,KAAK2C,OAAOlB,OAGtC0B,OAAOC,EAAmBC,EAAc7F,GAGtC,GADIwC,KAAK+C,WAAaM,IAAMrD,KAAKgD,WAAa,MAC1ChD,KAAK8C,SAAWtF,EAAI,OACxB,IAAI8F,EAEJ,GAAItD,KAAKgD,WAAY,CAEnB,MAAMO,EAAIvD,KAAKgD,WACZQ,UACAC,SAASL,GACTI,UAGGE,EAAY1D,KAAK6C,QAAQc,aAC7B,EACA,EACA3D,KAAK2C,OAAOnB,MACZxB,KAAK2C,OAAOlB,QAEdzB,KAAK4C,UAAUgB,WAAW,MAAOC,aAAaH,EAAW,EAAG,GAC5D1D,KAAK6C,QAAQiB,UAAU,EAAG,EAAG9D,KAAK2C,OAAOnB,MAAOxB,KAAK2C,OAAOlB,QAC5DzB,KAAK6C,QAAQkB,UAAUR,EAAES,EAAGT,EAAEU,EAAGV,EAAEW,EAAGX,EAAEY,EAAGZ,EAAE3F,EAAG2F,EAAEa,GAClDpE,KAAK6C,QAAQwB,UAAUrE,KAAK4C,UAAW,EAAG,GAC1C5C,KAAK6C,QAAQyB,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,GAMzC,MAAM7F,GACH8E,EAAEW,EAAIX,EAAEa,EAAIb,EAAEY,EAAIZ,EAAE3F,EAAI2F,EAAE3F,IAAM2F,EAAES,EAAIT,EAAEY,EAAIZ,EAAES,EAAIT,EAAEU,EAAIV,EAAEW,EAAIX,EAAEY,EAAI,GACjEzF,GACH6E,EAAES,EAAIT,EAAEa,EAAIb,EAAEU,EAAIV,EAAE3F,EAAI2F,EAAEa,IAC1Bb,EAAES,GAAKT,EAAEY,EAAIZ,EAAES,EAAIT,EAAEU,EAAIV,EAAEW,EAAIX,EAAEY,EAAI,GAGpCZ,EAAES,EAAI,OAAST,EAAEY,EAAI,MACvBb,EAAa,CAAE7E,IAAGC,IAAG6F,SAAS,GACrBhB,EAAES,EAAI,KAAQT,EAAEY,EAAI,IAC7Bb,EAAa,CAAE7E,IAAGC,IAAG6F,SAAS,IACrBpG,KAAKoB,IAAIgE,EAAE3F,GAAK,KAAQO,KAAKoB,IAAIgE,EAAEa,GAAK,OACjDd,EAAa,CACX7E,EAAGuB,KAAK2C,OAAOnB,MAAQ,EACvB9C,EAAGsB,KAAK2C,OAAOlB,OAAS,EACxB8C,SAAS,GAEPhB,EAAE3F,GAAK,MAAM0F,EAAW7E,EAAI,GAC5B8E,EAAE3F,EAAI,MAAM0F,EAAW7E,EAAIuB,KAAK2C,OAAOnB,OACvC+B,EAAEa,GAAK,MAAMd,EAAW5E,EAAI,GAC5B6E,EAAEa,EAAI,MAAMd,EAAW5E,EAAIsB,KAAK2C,OAAOlB,cAG7CzB,KAAK+C,SAAWM,EAKlB,OAFArD,KAAK8C,OAAStF,EACdwC,KAAKgD,WAAaI,EACXE,GC1EX,MAAMT,EAAU2B,OAEVC,EAAsC,GAC5C5B,EAAQ9E,OAAO0C,QAASiE,IACtB,MAAMpE,EAAMuC,EAAQ6B,GAAUC,QAC9BF,EAAKnE,EAAIjC,WAAaiC,IAGjB,MAMMsE,EAAavG,IACxB,MAAMwG,EAAMJ,EAAKpG,GACjB,OAAO,aAAEA,aAAcwG,EAAIrG,SCLd,MAAMsG,EAenBhF,YAAY+B,EAAckD,EAAkBC,GAAe,KAd1CC,QAAkB,IAcuB,KAbzCpD,SAayC,OAXlDkD,aAWkD,OAVlDG,eAUkD,OATlDC,cASkD,OAPlD3D,WAOkD,OANlDC,YAMkD,OALlDiC,eAKkD,OAJlD0B,iBAIkD,OAFlDC,WAEkD,EACxDrF,KAAK6B,IAAMA,EACX7B,KAAKsF,SACLtF,KAAKG,SAAWH,KAAKG,SAASc,KAAKjB,MACnCA,KAAKkF,UAAY,IAAItD,EAAUC,EAAK7B,KAAKG,UACzCH,KAAK+E,QAAUA,EACf/E,KAAKmF,SAAW,IAAIzC,EAASb,GAG/ByD,SACMtF,KAAKkF,WAAWlF,KAAKkF,UAAU5C,YAEnC,MAAMK,EAAS3C,KAAK6B,IAAIc,OACxB3C,KAAK0D,UAAY1D,KAAK6B,IAAIgB,QAAQ0C,gBAChC5C,EAAOnB,MACPmB,EAAOlB,QAETzB,KAAKoF,YAAc,IAAII,YAAYxF,KAAK0D,UAAU/B,KAAKN,QACvDrB,KAAKwB,MAAQmB,EAAOnB,MACpBxB,KAAKyB,OAASkB,EAAOlB,OAGrB,MAAMgE,EAAQzF,KAAKwB,MAAQxB,KAAKyB,OAC1BiE,EAAevH,KAAKwH,MAAMxH,KAAKyH,KAAK5F,KAAKiF,QAAUQ,IACnDI,EAAc1H,KAAKwH,MAAMxH,KAAKyH,KAAK5F,KAAKiF,QAAUQ,GAASA,GACjEK,QAAQC,MACN,iBAAU/F,KAAKwB,MAAf,gBAA4BxB,KAAKyB,OAAjC,qBAAoDgE,EAAMO,QAAQ,GAAlE,iBACMH,EADN,cACuBH,EADvB,cACyCA,EACrCG,EAFJ,mBAE0B7F,KAAKiF,QAF/B,8BAGc9G,KAAKwH,MAAMhD,EAAOnB,MAAQqE,GAHxC,gBAG4D1H,KAAKwH,MAC7D3F,KAAK6B,IAAIc,OAAOlB,OAASiE,GAJ7B,OASF1F,KAAKqF,MAAQ,GACb,IAAK,IAAI5F,EAAI,EAAGA,EAAIiG,EAAcjG,GAAK,EACrC,IAAK,IAAIH,EAAI,EAAGA,EAAIuG,EAAavG,GAAK,EAAG,CACvC,MAAM9B,EAAKwC,KAAKqF,MAAM/D,OAChB2E,EAAK9H,KAAKwH,MAAOrG,EAAIqD,EAAOnB,MAASqE,GACrCK,EAAK/H,KAAKwH,OAAQrG,EAAI,GAAKqD,EAAOnB,MAASqE,GAAe,EAC1DM,EAAKhI,KAAKwH,MAAOlG,EAAIkD,EAAOlB,OAAUiE,GACtCU,EAAKjI,KAAKwH,OAAQlG,EAAI,GAAKkD,EAAOlB,OAAUiE,GAAgB,EAC5DjH,GAAKwH,EAAKC,GAAM,EAChBxH,GAAKyH,EAAKC,GAAM,EAChB5E,EAAQ0E,EAAKD,EAAK,EAClBxE,EAAS2E,EAAKD,EAAK,EACnB9E,EAAS,IAAIE,aAAaC,EAAQC,GAClC4E,EAAcF,EAAKxD,EAAOnB,MAAQyE,EAExCjG,KAAKqF,MAAMjF,KAAK,CAAC5C,KAAI8B,IAAGG,IAAGwG,KAAIC,KAAIC,KAAIC,KAAI3H,IAAGC,IAAG8C,QAAOC,SAAQJ,SAAQgF,iBAK9EC,gBAAgBC,GAEd,MD3EuB,EAAC/I,EAAYgC,KACtC,MAAMqF,EAAMJ,EAAKjH,GACjB,OAAIgC,GAAeqF,EAAIhG,GAAGW,QACnBqF,EAAIhG,GAAGC,QCuEC0H,CAAYxG,KAAK6B,IAAIxD,UAAW2B,KAAK6B,IAAIrC,OAC/CiH,CAAKF,EAAI9H,EAAG8H,EAAI7H,EAAGsB,KAAK6B,IAAIjD,MAGrC8H,eACE,MAAMC,EAAY,IAAIC,MAAM5G,KAAK6B,IAAIjD,KAAO,GAAGiI,KAAK,GAD7B,oBAEJ7G,KAAKqF,OAFD,IAEvB,2BAA+B,CAAC,MAArBjE,EAAoB,QAC7B,IAAK,IAAI9B,KAAK8B,EAAKC,OAAQ,CACzB,MAAMyF,EAAM3I,KAAKwH,MAAMvE,EAAKC,OAAO/B,IAC/BwH,GAAO,GAAKA,GAAO9G,KAAK6B,IAAIjD,OAAM+H,EAAUG,IAAQ,KALrC,8BAQvB,OAAOH,EAITI,YACE/G,KAAK6B,IAAIH,MAAMrB,OAAO,cAAe,IACrCL,KAAKqF,MAAM5E,QAAQW,IACjBpB,KAAK+E,QAAQiC,MAAM5F,EAAMpB,KAAKoF,YAAapF,KAAKwB,SAElDxB,KAAK6B,IAAIgB,QAAQgB,aACf7D,KAAK0D,UACL,EACA,EACA,EACA,EACA1D,KAAKwB,MACLxB,KAAKyB,QAKTP,KAAK+F,GACHjH,KAAK6B,IAAIH,MAAMrB,OAAO,aAAc,IACpCL,KAAKkF,UAAU5C,YACAtC,KAAKmF,SAAShC,OAC7B,IAAI+D,EACAlH,KAAKmF,WACP+B,EAAWlH,KAAKmF,SAAShC,OACvBnD,KAAK6B,IAAIsF,OAAOC,OAChBpH,KAAK6B,IAAIxD,UACT4I,EAAOzJ,KAAO,IAElB,MAAM6J,EAAqBrJ,OAAOsJ,OAAO,GAAItH,KAAK6B,IAAIsF,OAAOC,OAAQ,CACnE/D,KAAMrD,KAAK6B,IAAIxD,UACfmB,OAAQQ,KAAK6B,IAAIrC,OACjBZ,KAAMoB,KAAK6B,IAAIjD,OAEXkD,EAAsB9B,KAAKqF,MAAMhI,IAAI+D,IAAI,CAC7CL,OAAQ,OACRK,OACA6F,SACAM,MAAOF,KAeT,OAZIH,IACFpF,EAAOrB,QAAQ+G,IACbA,EAAEC,KAAOtJ,KAAKyH,KACZ,SAAC4B,EAAEpG,KAAK3C,EAAIyI,EAAUzI,EAAM,GAA5B,SAAiC+I,EAAEpG,KAAK1C,EAAIwI,EAAUxI,EAAM,MAGhEoD,EAAO4F,KAAK,CAAC1D,EAAGC,IAEdiD,EAAU3C,QAAUN,EAAEwD,KAAOzD,EAAEyD,KAAOzD,EAAEyD,KAAOxD,EAAEwD,OAG5BzH,KAAKkF,UAAU1C,SAASV,GAAQ6F,MAAM,QAIjExH,SAASwB,GACP,GAAoB,aAAhBA,EAAKZ,OAAuB,MAAM,IAAIlD,MAC1C,MAAMuD,EAAOO,EAAKP,KAClBpB,KAAKqF,MAAMjE,EAAK5D,IAAI6D,OAASD,EAAKC,OAClCrB,KAAK+E,QAAQiC,MAAM5F,EAAMpB,KAAKoF,YAAapF,KAAKwB,OAChDxB,KAAK6B,IAAIgB,QAAQgB,aACf7D,KAAK0D,UACL,EACA,EACAtC,EAAK6E,GACL7E,EAAK+E,GACL/E,EAAKI,MACLJ,EAAKK,SCxKX,MAAMmG,EAA+C,CACnDC,EAAG,0DACHC,EAAG,4BACHC,EAAG,mCACHC,EAAG,sCACHC,EAAG,8CACHC,EAAG,2DAEHC,GAAI,8CACJC,GAAI,8CACJC,GAAI,8CACJC,GAAI,8CACJC,GAAI,8CACJC,GAAI,8CACJC,GAAI,8CACJC,GAAI,8CACJC,GAAI,8CACJC,GAAI,+CAUN,SAASC,EAAkBC,EAAcC,GACvC,IAAIzJ,EACFgC,EAASwH,EAAGxH,OAGd,GAAIA,IAAWyH,EAAGzH,OAChB,MAAM,IAAIzD,MAAM,qCAElB,GAAe,IAAXyD,EACF,OAAO,SAAS7C,GACd,OAAO,GAGX,GAAe,IAAX6C,EAAc,CAGhB,MAAM0H,GAAUD,EAAG,GACnB,OAAO,SAAStK,GACd,OAAOuK,GAKX,MAAMC,EAAU,GAChB,IAAK3J,EAAI,EAAGA,EAAIgC,EAAQhC,IACtB2J,EAAQ7I,KAAKd,GAEf2J,EAAQvB,KAAK,CAAC1D,EAAGC,IAAO6E,EAAG9E,GAAK8E,EAAG7E,IAAM,EAAI,GAC7C,IAAIiF,EAAQJ,EACVK,EAAQJ,EAKV,IAHAD,EAAK,GACLC,EAAK,GAEAzJ,EAAI,EAAGA,EAAIgC,EAAQhC,IACtBwJ,EAAG1I,MAAM8I,EAAMD,EAAQ3J,KACvByJ,EAAG3I,MAAM+I,EAAMF,EAAQ3J,KAIzB,IAAI8J,EAAM,GACRC,EAAM,GACNC,EAAK,GACP,IAAKhK,EAAI,EAAGA,EAAIgC,EAAS,EAAGhC,IAAK,CAC/B,IAAIiK,EAAKT,EAAGxJ,EAAI,GAAKwJ,EAAGxJ,GACtBkK,EAAKT,EAAGzJ,EAAI,GAAKyJ,EAAGzJ,GACtB+J,EAAIjJ,KAAKmJ,GACTH,EAAIhJ,KAAKoJ,GACTF,EAAGlJ,KAAKoJ,EAAKD,GAIf,MAAME,EAAM,CAACH,EAAG,IAChB,IAAKhK,EAAI,EAAGA,EAAI+J,EAAI/H,OAAS,EAAGhC,IAAK,CACnC,IAAIiE,EAAI+F,EAAGhK,GACToK,EAAQJ,EAAGhK,EAAI,GACjB,GAAIiE,EAAImG,GAAS,EACfD,EAAIrJ,KAAK,OACJ,CACL,IAAImJ,EAAKF,EAAI/J,GACXqK,EAASN,EAAI/J,EAAI,GACjBsK,EAASL,EAAKI,EAChBF,EAAIrJ,KAAM,EAAIwJ,IAAYA,EAASD,GAAUpG,GAAKqG,EAASL,GAAMG,KAGrED,EAAIrJ,KAAKkJ,EAAGA,EAAGhI,OAAS,IAGxB,IAAIuI,EAAoB,GACtBC,EAAgB,GAClB,IAAKxK,EAAI,EAAGA,EAAImK,EAAInI,OAAS,EAAGhC,IAAK,CACnC,IAAIyK,EAAKN,EAAInK,GACXiE,EAAI+F,EAAGhK,GACP0K,EAAQ,EAAIX,EAAI/J,GAChBsK,EAASG,EAAKN,EAAInK,EAAI,GAAKiE,EAAIA,EACjCsG,EAAQzJ,MAAMmD,EAAIwG,EAAKH,GAAUI,GACjCF,EAAI1J,KAAKwJ,EAASI,EAAQA,GAI5B,OAAO,SAASvL,GAEd,IAAIa,EAAIwJ,EAAGxH,OAAS,EACpB,GAAI7C,IAAMqK,EAAGxJ,GACX,OAAOyJ,EAAGzJ,GAIZ,IACE2K,EADEC,EAAM,EAERC,EAAOL,EAAIxI,OAAS,EACtB,KAAO4I,GAAOC,GAAM,CAClBF,EAAM9L,KAAKiM,MAAM,IAAOF,EAAMC,IAC9B,MAAME,EAAQvB,EAAGmB,GACjB,GAAII,EAAQ5L,EACVyL,EAAMD,EAAM,MACP,MAAII,EAAQ5L,GAGjB,OAAOsK,EAAGkB,GAFVE,EAAOF,EAAM,GAKjB3K,EAAInB,KAAKmM,IAAI,EAAGH,GAGhB,IAAII,EAAO9L,EAAIqK,EAAGxJ,GAChBkL,EAASD,EAAOA,EAClB,OAAOxB,EAAGzJ,GAAKmK,EAAInK,GAAKiL,EAAOV,EAAQvK,GAAKkL,EAASV,EAAIxK,GAAKiL,EAAOC,GAIzE,MAiDaC,EAAkB,CAACjN,EAAYqH,EAAM,MAjDZ,EACpC6F,EACAC,KAEA,MAAMC,EAAoB,GACpBC,EAAiB,GACjBC,EAAmB,GACnBC,EAAkB,GAYlB1J,EAAS,IAAI2J,WAAWN,GA2B9B,OAFWC,EAlCLM,MAAM,KAAKxK,QAAQyK,IACrB,MAAMC,EAAQD,EAAKD,MAAM,KACzBL,EAAQxK,KAAKgL,OAAOD,EAAM,KAC1BN,EAAKzK,KAAKiL,SAASF,EAAM,GAAGG,UAAU,EAAG,GAAI,KAC7CR,EAAO1K,KAAKiL,SAASF,EAAM,GAAGG,UAAU,EAAG,GAAI,KAC/CP,EAAM3K,KAAKiL,SAASF,EAAM,GAAGG,UAAU,EAAG,GAAI,OAK9B,MAElBV,EAAQxK,KAAKwK,EAAQ,GAAK,GAC1BC,EAAKzK,KAAKyK,EAAK,IACfC,EAAO1K,KAAK0K,EAAO,IACnBC,EAAM3K,KAAK2K,EAAM,IAEjB,MAAMQ,EAAS1C,EAAkB+B,EAASC,GACpCW,EAAS3C,EAAkB+B,EAASE,GACpCW,EAAS5C,EAAkB+B,EAASG,GAEpCW,EAAa,IAAIC,WAAWtK,EAAOA,QACzC,IAAIuK,EAAc,EAClB,IAAK,IAAItM,EAAI,EAAGA,EAAIoL,EAAYpL,GAAK,EAAG,CACtC,IAAIuM,EAAavM,EAAIoL,EACjBmB,EAAajB,EAAQ,KAAIiB,GAAc,GAC3CH,EAAWE,EAAc,GAAKL,EAAOM,GACrCH,EAAWE,EAAc,GAAKJ,EAAOK,GACrCH,EAAWE,EAAc,GAAKH,EAAOI,GACrCH,EAAWE,EAAc,GAAK,IAC9BA,GAAe,IAKnBE,GACOzK,GAIA0K,CAA8BlH,EAAK+C,EAAkBpK,IClL/C,MAAMwO,EAQnBlM,YAAYmM,GAAiB,KAPtBzO,GAAa,EAOQ,KANrB0O,OAAiB,EAMI,KALrBrN,GAAa,IAKQ,KAJrBsN,QAAkB,EAIG,KAHpBzB,WAAqB,EAGD,KAFpBrJ,OAAqB,IAAI2J,WAG/BhL,KAAKoM,IAAIH,GAGXG,IAAIH,GACE,OAAQA,IAAGjM,KAAKnB,GAAKoN,EAAEpN,IACvB,WAAYoN,IAAGjM,KAAKkM,OAASD,EAAEC,QAC/B,YAAaD,IAAGjM,KAAKmM,QAAUF,EAAEE,SACjC,OAAQF,IACVjM,KAAKxC,GAAKyO,EAAEzO,GACZwC,KAAKqB,OAASoJ,EAAgBwB,EAAEzO,GAAI,KACpCwC,KAAK0K,WAAa1K,KAAKqB,OAAOC,QAMlC0F,MAAM5F,EAAYC,EAAqBG,GACrC,IAMI6K,EAAIC,EAAI1N,EAAM2N,EANdL,EAASlM,KAAKkM,OAASlM,KAAK0K,WAC5ByB,EAAUnM,KAAKmM,QACjBzB,EAAa1K,KAAK0K,WAChB8B,EAAUxM,KAAKqB,OACfoL,EAAY,EACZb,EAAc,EAQlB,IALgB,MAAZ5L,KAAKnB,KACPsN,GAAoB,EACpBD,GAAWlM,KAAKkM,OAAS,KAAQ,EAAKlM,KAAK0K,YAGxC4B,EAAK,EAAGA,EAAKlL,EAAKK,OAAQ6K,GAAM,EAEnC,IADAV,GAAeU,EAAKlL,EAAK+E,IAAM3E,EAAQJ,EAAK6E,GACvCoG,EAAK,EAAGA,EAAKjL,EAAKI,MAAO6K,GAAM,EAErB,KADbzN,EAAOwC,EAAKC,OAAOoL,IAEjBF,EAAQ,YAEQ,MAAZvM,KAAKnB,KACPD,EAAOT,KAAKyH,KAAKhH,IAEnB2N,EAAQC,MAAY5N,EAAOuN,EAAUD,GAAUxB,KAEjDrJ,EAAOuK,GAAeW,EACtBE,GAAa,EACbb,GAAe,GC/DR,MAAMc,EAInB5M,YAAYrB,EAAoBC,GAAa,KAH7BD,OAG4B,OAF5BC,OAE4B,EACtCD,aAAaiO,GACf1M,KAAKvB,EAAIA,EAAEA,EACXuB,KAAKtB,EAAID,EAAEC,IAEXsB,KAAKvB,EAAIA,EACTuB,KAAKtB,EAAIA,GAIbiO,SAASC,GACP,OAAO,IAAIF,GAAQE,EAAGnO,EAAIuB,KAAKvB,GAAK,GAAImO,EAAGlO,EAAIsB,KAAKtB,GAAK,GAG3DmO,MAAMC,GACJ,OAAO,IAAIJ,EAAO1M,KAAKvB,EAAIqO,EAAErO,EAAGuB,KAAKtB,EAAIoO,EAAEpO,GAG7CqO,KAAKD,GACH,OAAO,IAAIJ,EAAO1M,KAAKvB,EAAIqO,EAAErO,EAAGuB,KAAKtB,EAAIoO,EAAEpO,GAG7CsO,MAAMF,GACJ,OAAOA,aAAaJ,EAChB,IAAIA,EAAO1M,KAAKvB,EAAIqO,EAAErO,EAAGuB,KAAKtB,EAAIoO,EAAEpO,GACpC,IAAIgO,EAAO1M,KAAKvB,EAAIqO,EAAG9M,KAAKtB,EAAIoO,GAGtCG,SACE,OAAO9O,KAAK+O,IAAIlN,KAAKvB,EAAGuB,KAAKtB,IC/BlB,MAAMyO,EAGnBrN,YACkBkE,EACAC,EACAC,EACAC,EACAvG,EACAwG,GACf,KANeJ,IAMhB,KALgBC,IAKhB,KAJgBC,IAIhB,KAHgBC,IAGhB,KAFgBvG,IAEhB,KADgBwG,IAGlBL,UAAU+I,GACR,OAAO,IAAIJ,EACTI,EAAErO,EAAIuB,KAAKgE,EAAI8I,EAAEpO,EAAIsB,KAAKkE,EAAIlE,KAAKpC,EACnCkP,EAAErO,EAAIuB,KAAKiE,EAAI6I,EAAEpO,EAAIsB,KAAKmE,EAAInE,KAAKoE,GAIvCgJ,aACE,OACa,IAAXpN,KAAKgE,GACM,IAAXhE,KAAKiE,GACM,IAAXjE,KAAKkE,GACM,IAAXlE,KAAKmE,GACM,IAAXnE,KAAKpC,GACM,IAAXoC,KAAKoE,EAIDiJ,eACN,MAAMC,EAAQtN,KAAKgE,EAAIhE,KAAKmE,EAAInE,KAAKiE,EAAIjE,KAAKkE,EAC9C,OAAO/F,KAAKoB,IAAI+N,GAAS,MAG3B9J,UACE,IAAKxD,KAAKqN,eACR,OAAOrN,KAAKuN,qBAEd,MAAMC,EAAKxN,KAAKgE,EAAIhE,KAAKmE,EAAInE,KAAKiE,EAAIjE,KAAKkE,EAC3C,OAAO,IAAIiJ,EACTnN,KAAKmE,EAAIqJ,GACRxN,KAAKiE,EAAIuJ,GACTxN,KAAKkE,EAAIsJ,EACVxN,KAAKgE,EAAIwJ,GACRxN,KAAKkE,EAAIlE,KAAKoE,EAAIpE,KAAKmE,EAAInE,KAAKpC,GAAK4P,IACpCxN,KAAKgE,EAAIhE,KAAKoE,EAAIpE,KAAKiE,EAAIjE,KAAKpC,GAAK4P,GAI3C/J,SAAS9F,GACP,OAAO,IAAIwP,EACTnN,KAAKgE,EAAIrG,EAAEqG,EAAIhE,KAAKkE,EAAIvG,EAAEsG,EAC1BjE,KAAKiE,EAAItG,EAAEqG,EAAIhE,KAAKmE,EAAIxG,EAAEsG,EAC1BjE,KAAKgE,EAAIrG,EAAEuG,EAAIlE,KAAKkE,EAAIvG,EAAEwG,EAC1BnE,KAAKiE,EAAItG,EAAEuG,EAAIlE,KAAKmE,EAAIxG,EAAEwG,EAC1BnE,KAAKgE,EAAIrG,EAAEC,EAAIoC,KAAKkE,EAAIvG,EAAEyG,EAAIpE,KAAKpC,EACnCoC,KAAKiE,EAAItG,EAAEC,EAAIoC,KAAKmE,EAAIxG,EAAEyG,EAAIpE,KAAKoE,GAI/BmJ,qBACN,SAASE,EAAIC,EAAQC,EAAUC,EAAUxJ,GACvC,MAAM2F,EAAK2D,EAAEC,GACPE,EAAKH,EAAEE,GACb,IAAK,IAAItO,EAAI,EAAGA,EAAI,EAAGA,IACrByK,EAAGzK,IAAMuO,EAAGvO,GAAK8E,EAIrB,SAAS0J,EAAKJ,EAAQC,EAAUvJ,GAC9B,MAAM2F,EAAK2D,EAAEC,GACb,IAAK,IAAIrO,EAAI,EAAGA,EAAI,EAAGA,IACrByK,EAAGzK,IAAM8E,EAGb,MAAMsJ,EAAI,CACR,CAAC1N,KAAKgE,EAAGhE,KAAKkE,EAAGlE,KAAKpC,EAAG,EAAG,EAAG,GAC/B,CAACoC,KAAKiE,EAAGjE,KAAKmE,EAAGnE,KAAKoE,EAAG,EAAG,EAAG,GAC/B,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAQlB,OANAqJ,EAAIC,EAAG,EAAG,GAAIA,EAAE,GAAG,IACnBD,EAAIC,EAAG,EAAG,GAAIA,EAAE,GAAG,IACnBD,EAAIC,EAAG,EAAG,GAAIA,EAAE,GAAG,GAAKA,EAAE,GAAG,IAC7BD,EAAIC,EAAG,EAAG,GAAIA,EAAE,GAAG,GAAKA,EAAE,GAAG,IAC7BI,EAAKJ,EAAG,EAAG,EAAIA,EAAE,GAAG,IACpBI,EAAKJ,EAAG,EAAG,EAAIA,EAAE,GAAG,IACb,IAAIP,EAAOO,EAAE,GAAG,GAAIA,EAAE,GAAG,GAAIA,EAAE,GAAG,GAAIA,EAAE,GAAG,GAAIA,EAAE,GAAG,GAAIA,EAAE,GAAG,IAGtEK,WACE,MAAM,GAAN,OAAU/N,KAAKgE,EAAf,YAAoBhE,KAAKkE,EAAzB,YAA8BlE,KAAKpC,EAAnC,aAAyCoC,KAAKiE,EAA9C,YAAmDjE,KAAKmE,EAAxD,YAA6DnE,KAAKoE,EAAlE,WAIF,6BACE4J,EAAcC,EAAcC,EAAcC,EAAcC,EAAcC,EACtEC,EAAcC,EAAcC,EAAcC,EAAcC,EAAcC,GAEtE,MAAMC,EAAS,IAAIzB,EAAOa,EAAOI,EAAMH,EAAOI,EAAMH,EAAOE,EAAMD,EAAOE,EAAMD,EAAMC,GAC9EQ,EAAS,IAAI1B,EAAOmB,EAAOI,EAAMH,EAAOI,EAAMH,EAAOE,EAAMD,EAAOE,EAAMD,EAAMC,GAC9EG,EAASF,EAAOpL,UACtB,OAAOqL,EAAOpL,SAASqL,GAGzB,yBAAyBC,GACvB,MAAMC,EAAM7Q,KAAK6Q,IAAID,GACfE,EAAM9Q,KAAK8Q,IAAIF,GACrB,OAAO,IAAI5B,EAAO6B,EAAKC,GAAMA,EAAKD,EAAK,EAAG,GAG5C,sBAAsBvQ,EAAWC,GAC/B,OAAO,IAAIyO,EAAO1O,EAAG,EAAG,EAAGC,EAAG,EAAG,GAGnC,sBAAsBD,EAAWC,GAC/B,OAAO,IAAIyO,EAAO,EAAGzO,EAAGD,EAAG,EAAG,EAAG,IApHhB0O,EACI+B,SAAW,IAAI/B,EAAO,EAAG,EAAG,EAAG,EAAG,EAAG,GCsC/C,MAAMgC,EASnBrP,YACEsP,EACAC,EACA1Q,EACA2Q,EAAenC,EAAO+B,UACrB,KAbKK,gBAaN,OAZKnI,YAYL,OAXKkI,kBAWL,OAVKE,YAUL,OATKC,qBASL,OARKJ,SAQL,OAPK1Q,OAOL,EACAqB,KAAKsP,aAAeA,EACpBtP,KAAKwP,OAASJ,EACd,MAAMM,EAASN,EAAWnC,SAC1BjN,KAAKyP,gBAA2B,QAATC,EACvB1P,KAAKqP,IAAMA,EACXrP,KAAKrB,EAAIA,EACTqB,KAAKoH,OAAS+F,EAAO+B,SACrBlP,KAAKuP,WAAapC,EAAO+B,SACzBlP,KAAK2P,YAGPA,YACE3P,KAAKrB,EAAIR,KAAKmM,IAAItK,KAAKrB,EAAGqB,KAAKyP,iBAC/B,MAAMG,EA1DsB,EAC9BC,EACArO,EACAC,KAEA,MAAMwK,EAAI4D,EAAgB9L,UAAU,IAAI2I,EAAO,GAAI,IAC7CoD,EAAID,EAAgB9L,UAAU,IAAI2I,GAAQ,EAAG,IAC7CqD,EAAIF,EAAgB9L,UAAU,IAAI2I,GAAQ,GAAI,IACpD,GAAIlL,GAASC,EAAQ,CACnB,MAAMwE,GAAMzE,EAAQC,GAAU,EACxByE,EAAKD,EAAKxE,EAEhB,OAAO0L,EAAO6C,sBACZ9J,EAAIzE,EAAQwE,EAAI,EAAGA,EAAIxE,EACvBwK,EAAExN,EAAGwN,EAAEvN,EAAGoR,EAAErR,EAAGqR,EAAEpR,EAAGqR,EAAEtR,EAAGsR,EAAErR,GACxB,CACL,MAAMyH,GAAM1E,EAASD,GAAS,EACxB4E,EAAKD,EAAK3E,EAEhB,OAAO2L,EAAO6C,sBACZxO,EAAO4E,EAAI,EAAGD,EAAI,EAAGC,EACrB6F,EAAExN,EAAGwN,EAAEvN,EAAGoR,EAAErR,EAAGqR,EAAEpR,EAAGqR,EAAEtR,EAAGsR,EAAErR,KAqCjBuR,CACVjQ,KAAKsP,aACLtP,KAAKwP,OAAO/Q,EACZuB,KAAKwP,OAAO9Q,GAERwR,GAtEwBzR,EAsEOuB,KAAKqP,IAAI5Q,EAtELC,EAsEQsB,KAAKqP,IAAI3Q,EAtENC,EAsESqB,KAAKrB,EArEpEwO,EAAO6C,sBACL,EAAG,EAAG,EAAG,EAAG,EAAG,EACfvR,EAAIE,EAAI,EAAGD,EAAGD,EAAGC,EAAIC,EAAI,EAAGF,EAAGC,IAHF,IAACD,EAAWC,EAAWC,EAuEpDqB,KAAKoH,OAAS8I,EAAIzM,SAASmM,GAC3B5P,KAAKuP,WAAavP,KAAKoH,OAAO5D,UAGhCqM,gBAAgBxM,EAAc8M,EAAgBC,GAC5C,IAAIrM,EAAYoJ,EAAO+B,SACvB,OAAQ7L,GACN,IAAK,WACHU,EAAYoJ,EAAOkD,kBAAkBF,GACrC,MACF,IAAK,QACHpM,EAAYoJ,EAAOmD,eAAeH,EAAQC,GAC1C,MACF,IAAK,QACHrM,EAAYoJ,EAAOoD,eAAeJ,EAAQC,GAG9CpQ,KAAKsP,aAAetP,KAAKsP,aAAa7L,SAASM,GAC/C/D,KAAK2P,YAGPa,cACExQ,KAAKsP,aAAenC,EAAO+B,SAC3BlP,KAAK2P,YAGPc,QACE,OAAO,IAAItB,EAAOnP,KAAKwP,OAAQxP,KAAKqP,IAAKrP,KAAKrB,EAAGqB,KAAKsP,cAGxDoB,QAAQ5D,GACN,OAAO9M,KAAKoH,OAAOrD,UAAU+I,GAG/BjD,QAAQiD,GACN,OAAO9M,KAAKuP,WAAWxL,UAAU+I,GAGnC6D,SACE,OAAO3Q,KAAKqP,IAGduB,OAAOvB,EAAa1Q,GAClBqB,KAAKqP,IAAMA,EACP1Q,IAAGqB,KAAKrB,EAAIA,GAChBqB,KAAK2P,YAGPrK,OAAO9D,EAAeC,GACpBzB,KAAKwP,OAAS,IAAI9C,EAAOlL,EAAOC,GAChC,MAAMiO,EAASvR,KAAK+O,IAAI1L,EAAOC,GAC/BzB,KAAKyP,gBAA2B,QAATC,EACvB1P,KAAK2P,YAGPkB,cACE,OAAO7Q,KAAKrB,GAAKqB,KAAKyP,iBCnGX,MAAMqB,EAMnBhR,YAAYmM,GAAgB,KALZpK,SAKW,OAJXkD,aAIW,OAFnBgM,cAEmB,EACzB,IAAI5O,EAAY6O,UAAUC,qBAAuB,EAC7C9O,GAAa,GAAGA,IACpBnC,KAAK6B,IAAM,CAETc,OAAQsJ,EAAEtJ,OACVE,QAASoJ,EAAEtJ,OAAOiB,WAAW,MAC7BzB,YACAT,MAAO,IAAI7B,EACXsH,OAAQ,IAAIgI,EACV,IAAIzC,EAAOT,EAAEtJ,OAAOnB,MAAOyK,EAAEtJ,OAAOlB,QACpC,IAAIiL,EAAOT,EAAExN,EAAGwN,EAAEvN,GAClBuN,EAAEtN,EACFsN,EAAEiF,UAGJ1R,OAAQyM,EAAEzM,OACVZ,KAAMqN,EAAErN,KACRP,UAAW4N,EAAE5N,WAEf2B,KAAK+E,QAAU,IAAIiH,EAAQC,EAAElH,SAC7B/E,KAAK+Q,SAAW,IAAIjM,EAAS9E,KAAK6B,IAAK7B,KAAK+E,QAAS/E,MAGvD,aACE,OAAOA,KAAK6B,IAAIc,OAIlByJ,IAAIH,GACE,cAAeA,IAAGjM,KAAK6B,IAAIxD,UAAY4N,EAAE5N,WACzC,WAAY4N,IAAGjM,KAAK6B,IAAIrC,OAASyM,EAAEzM,QACnC,SAAUyM,IAAGjM,KAAK6B,IAAIjD,KAAOqN,EAAErN,MAC/B,MAAOqN,GAAGjM,KAAK6B,IAAIsF,OAAOyJ,OAAO,IAAIlE,EAAOT,EAAExN,EAAGwN,EAAEvN,GAAIuN,EAAEtN,GACzD,YAAasN,GACfjM,KAAK+E,QAAQqH,IAAIH,EAAElH,SAIjB7D,KAAK+F,GAAkB,IAAD,yHACrBA,IAAQA,EAAS,CAAEkK,QAAS,WADP,kBAEnB,EAAKJ,SAAS7P,KAAK+F,IAFA,6CAK5BF,YACE/G,KAAK+Q,SAAShK,YAGhBzB,OAAO9D,EAAeC,GACpBzB,KAAK6B,IAAIsF,OAAO7B,OAAO9D,EAAOC,GAC9BzB,KAAK+Q,SAASzL,SAGhBoB,eACE,OAAO1G,KAAK+Q,SAASrK,eAGvBJ,gBAAgBC,GACd,OAAOvG,KAAK+Q,SAASzK,gBAAgBC,I,YC9FzC,MAAM6K,EAAKC,YAAY,CACrB9S,KAAM,MACN+S,aAAc,CACZjT,UAAW,aACXmB,QAAQ,EACRf,EAAG,EACHC,EAAG,EACHC,EAAG,EACHC,KAAM,GAER2S,SAAU,CACRC,OAAQ,CAACC,EAAO1Q,IAAWA,EAAO2Q,QAClCC,UAAW,CAACF,EAAO1Q,IAAR,eAAyB0Q,EAAzB,GAAmC1Q,EAAO2Q,YAI1CE,EAAqBR,EAArBQ,QAASC,EAAYT,EAAZS,QACTL,EAAsBK,EAAtBL,OAAQG,EAAcE,EAAdF,U,qBCnBvB,MAAMtU,EAAiC,CACrCyU,KAAM,GACNC,GAAI,GACJC,MAAO,GACPC,KAAM,GACN,IAAK,IACL,IAAK,IACLC,IAAK,GACLC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHpF,EAAG,GACHqF,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,IASCC,EAAoB,GACpBC,EAAsB,GAE5B5Q,SAAS6Q,iBAAiB,QAAS5T,IACjC0T,EAAO1T,EAAI6T,UAAW,IAGxB9Q,SAAS6Q,iBAAiB,UAAW5T,IACnC0T,EAAO1T,EAAI6T,UAAW,EACtB,MAAMC,EAAW9T,EAAI+T,SAAW,GAAS,EAFC,oBAGpBJ,GAHoB,IAG1C,2BAAgC,CAAC,MAAtBK,EAAqB,QAE9B,GADcA,EAAQC,MAAM9R,MAAM+R,GAAKR,EAAOQ,IAG5C,YADAF,EAAQzN,KAAKuN,IANyB,iCAYrC,MAAMK,EAAW,CAACC,EAAiB7N,KACxC,MAAM1I,EAAOuW,EAAQrJ,MAAM,KACrBsJ,EAAqB,GAFgC,oBAGzCxW,GAHyC,IAG3D,2BAAwB,CAAC,MAAdyW,EAAa,QACtB,KAAMA,KAAOnX,GAAM,MAAM,IAAIQ,MAAJ,qBAAwB2W,IACjDD,EAASnU,KAAK/C,EAAImX,KALuC,8BAO3DX,EAASzT,KAAK,CAAE+T,MAAOI,EAAU9N,SACjCoN,EAASnM,KAAK,CAAC1D,EAAGC,IAAMA,EAAEkQ,MAAM7S,OAAS0C,EAAEmQ,MAAM7S,SCvD7CmT,EAAQtW,KAAKuW,GAAK,GAET,MAAMC,EAInB7U,YAAYkF,EAAwB4P,GAA0B,KAA1BA,WAAyB,KAHrD5P,YAGqD,OAFrDmC,YAEqD,EAC3DnH,KAAKgF,OAASA,EACdhF,KAAKmH,OAASnC,EAAOnD,IAAIsF,OACzBnH,KAAK6U,gBACL7U,KAAK8U,aACL9U,KAAK+U,aAIPC,IAAIC,GACF,MAAMC,EAAMlV,KAAKmH,OACXgO,EAAaD,EAAI1F,OAAOxC,MAAMiI,GAC9BG,EAAcF,EAAIxE,QAAQ,IAAIhE,EAAO,EAAG,IACxC2I,EAAiBH,EAAIxE,QAAQyE,GAC7BG,EAAaF,EAAYvI,MAAMwI,GAC/BE,EAAgBL,EAAIvE,SAAS5D,KAAKuI,GACxCtV,KAAK4U,SAASY,GAASD,IAIzB1F,gBAAgBxM,EAAc8M,EAAgBC,GAC5CpQ,KAAKmH,OAAO0I,gBAAgBxM,EAAM8M,EAAQC,GAC1CpQ,KAAKgF,OAAO9D,OAGdsP,cACExQ,KAAKmH,OAAOqJ,cACZxQ,KAAKgF,OAAO9D,OAIduU,KAAKC,EAAeC,GAClB,MAAMT,EAAMlV,KAAKmH,OACjB,GAAIuO,EAAQ,GAAKR,EAAIrE,cAEnB,YADA7Q,KAAKgF,OAAOnD,IAAIH,MAAMrB,OAAO,cAI/B,MAAMuV,EAAYD,GAAiBT,EAAI1F,OAAOxC,MAAM,IAC9C6I,EAAYX,EAAIxE,QAAQkF,GAGxBN,EAFaJ,EAAIvE,SAEO9D,MAAMgJ,GAE9BN,EAAgBM,EAAU9I,KAAKuI,EAAWtI,MAAM0I,IACtD1V,KAAK4U,SAASY,GAASD,EAAeL,EAAIvW,EAAI+W,IAGhDb,gBACER,EAAS,KAAOyB,GAAc9V,KAAKgV,IAAI,IAAItI,EAAO,EA1D1C,GA0DmDoJ,KAC3DzB,EAAS,OAASyB,GAAc9V,KAAKgV,IAAI,IAAItI,EAAO,GA3D5C,GA2DsDoJ,KAC9DzB,EAAS,QAAUyB,GAAc9V,KAAKgV,IAAI,IAAItI,GA5DtC,GA4DoDoJ,EAAG,KAC/DzB,EAAS,OAASyB,GAAc9V,KAAKgV,IAAI,IAAItI,EA7DrC,GA6DkDoJ,EAAG,KAC7DzB,EAAS,IAAMyB,GAAc9V,KAAKyV,KAAK,GAhE9B,IAgE0CK,KACnDzB,EAAS,IAAMyB,GAAc9V,KAAKyV,KAjEzB,IAiEqCK,IAC9CzB,EAAS,IAAK,IAAMrU,KAAKwQ,eACzB6D,EAAS,SAAWyB,GAClB9V,KAAK6P,gBAAgB,YAAa4E,EAAQqB,IAE5CzB,EAAS,UAAYyB,GACnB9V,KAAK6P,gBAAgB,YAAa4E,EAAQqB,IAE5CzB,EAAS,UAAYyB,GACnB9V,KAAK6P,gBAAgB,QAAS,GAAK,EAvE3B,GAuEuCiG,GAAI,IAErDzB,EAAS,SAAWyB,GAClB9V,KAAK6P,gBAAgB,QAAS,EA1EtB,GA0EkCiG,EAAG,IAE/CzB,EAAS,OAASyB,GAChB9V,KAAK6P,gBAAgB,QAAS,EAAG,GAAK,EA7E9B,GA6E0CiG,KAEpDzB,EAAS,SAAWyB,GAClB9V,KAAK6P,gBAAgB,QAAS,EAAG,EAhFzB,GAgFqCiG,IAE/CzB,EAAS,UAAYyB,GACnB9V,KAAK6P,gBAAgB,SAlFb,GAkF+BiG,EAAG,IAE5CzB,EAAS,SAAWyB,GAClB9V,KAAK6P,gBAAgB,QArFb,GAqF8BiG,EAAG,IAE3CzB,EAAS,OAASyB,GAChB9V,KAAK6P,gBAAgB,QAAS,GAxFtB,GAwFkCiG,IAE5CzB,EAAS,SAAWyB,GAClB9V,KAAK6P,gBAAgB,QAAS,EA3FtB,GA2FiCiG,IAI7Cf,aACE,IAAIgB,EAAS,IAAIC,IAAOhW,KAAKgF,OAAOrC,OAAQ,IAC5C,IACIsT,EACAC,EAFAC,GAAa,EAIjBJ,EAAOK,IAAI,OAAOhK,IAAI,CACpBiK,UAAWL,IAAOM,cAClBC,UAAW,IAEbR,EAAOK,IAAI,SAAShK,IAAI,CACtBoK,QAAQ,IAGVT,EAAO9V,GAAG,YAAcC,IAEtB,MAAMmP,EAAM,IAAI3C,EAAOxM,EAAIuW,OAAOhY,EAAGyB,EAAIuW,OAAO/X,GAChDsB,KAAKyV,KAAK,GAAc,IAAI/I,EAAO2C,MAGrC0G,EAAO9V,GAAG,WAAaC,IACrBiW,GAAa,EACbF,EAAY,IAAIvJ,EAAOxM,EAAIuW,OAAOhY,EAAGyB,EAAIuW,OAAO/X,GAChDwX,EAAclW,KAAKmH,OAAOsJ,UAG5BsF,EAAO9V,GAAG,SAAWC,IACnBiW,GAAa,IAGfJ,EAAO9V,GAAG,UAAYC,IACpB,GAAIiW,EAAY,CACd,MACMhB,EADM,IAAIzI,EAAOxM,EAAIuW,OAAOhY,EAAGyB,EAAIuW,OAAO/X,GACzBmO,MAAMoJ,GACvBb,EAAcc,EAAYxF,QAAQ,IAAIhE,EAAO,EAAG,IAEhD4I,EADiBY,EAAYxF,QAAQyE,GACTtI,MAAMuI,GAClCsB,EAAUR,EAAYvF,SAAS9D,MAAMyI,GAC3CtV,KAAK4U,SAASY,GAASkB,OAI3B,IAAIC,GAAa,EACjB,IAAIC,EAEJb,EAAO9V,GAAG,aAAe4W,IACvB/Q,QAAQ1H,IAAI,cACZuY,GAAa,EACbC,EAAa,IAAIlK,EAAOmK,EAAGJ,OAAOhY,EAAGoY,EAAGJ,OAAO/X,GAC/CwX,EAAclW,KAAKmH,OAAOsJ,UAG5BsF,EAAO9V,GAAG,YAAY,SAAU4W,GAC9B/Q,QAAQ1H,IAAI,YACZuY,GAAa,KAGfZ,EAAO9V,GAAG,QAAU4W,IAClB,GAAIF,EAAY,CAEd,IAAIG,EAAMZ,EAAYxF,QAAQkG,GAC1BG,EAAMb,EAAYxF,QAAQ,IAAIhE,EAAOmK,EAAGJ,OAAOhY,EAAGoY,EAAGJ,OAAO/X,IAC5D6E,EAAI4J,EAAO6C,sBACb8G,EAAIrY,EACJqY,EAAIpY,EACJoY,EAAIrY,EAAI,EACRqY,EAAIpY,EACJoY,EAAIrY,EACJqY,EAAIpY,EAAI,EACRqY,EAAItY,EACJsY,EAAIrY,EACJqY,EAAItY,EAAIoY,EAAGG,MACXD,EAAIrY,EACJqY,EAAItY,EACJsY,EAAIrY,EAAImY,EAAGG,OAITC,EAAO1T,EAAEC,UAAUO,UAAUmS,EAAY7G,KAE7C,IAAI6H,EAAIhB,EAAYvX,EAAI4E,EAAES,EACtBkT,EAAIlX,KAAKmH,OAAOsI,kBAClBzP,KAAKgF,OAAOnD,IAAIH,MAAMrB,OAAO,cAC7B6W,EAAIlX,KAAKmH,OAAOsI,iBAElBzP,KAAK4U,SAASY,GAASyB,EAAMC,OAKnCpC,aACiB9U,KAAKgF,OAAOrC,OA2CpBmR,iBAAiB,QAVDlW,IACrB,MAAMsC,EAAMtC,GAAKuZ,OAAOzV,MACxBxB,EAAIkX,iBACJ,MAAMpD,EAAW9T,EAAI+T,SAAW,GAAS,EACzC,IAAIyB,EAAQxV,EAAImX,OAChB3B,EAAQA,EAAQ,EApOT,IAoOoB1B,EAAW,GApO/B,IAoO2CA,GAClD,MAAMsD,EAAQ,IAAI5K,EAAOxM,EAAIqX,QAASrX,EAAIsX,SAC1CxX,KAAKyV,KAAKC,EAAO4B,MCnOR,SAASG,EACtBC,EACA9C,EACA+C,GAEA,MAAM3S,EAAS0S,EACTxW,EAAO8D,EAAO9D,KAAKD,KAAK+D,GAC9B,IAAI4S,EAAU,EACVC,EAAY,GAEhB,MAAMC,EAASC,GACb,IAAItV,QAASxE,GAAYsC,WAAW,IAAMtC,IAAW8Z,IAsCjDC,EAAkBC,IAEtB,MAAMrZ,EAAOoG,EAAOnD,IAAIjD,KAClBsZ,EAAUD,EAAME,OAAO,CAACC,EAAKtR,IAAQsR,EAAMtR,EAAK,GAChDuR,EAAUJ,EAAM,GACtB,IAAIK,EAAUlN,OAAOmN,UACjBC,GAAW,EACf,IAAK,IAAIlZ,EAAI,EAAGA,EAAI2Y,EAAM3W,OAAQhC,GAAK,EACpB,IAAb2Y,EAAM3Y,KACRkZ,EAAUlZ,EACVgZ,EAAUna,KAAK+O,IAAI5N,EAAGgZ,IAG1B,MAAMG,EAAYD,EAAUF,EAE5B,IAAII,EAAc,EAClB,IAAK,IAAIpZ,EAFSV,EAAOT,KAAKwa,KAAKF,EAAY,IAEvBnZ,EAAI2Y,EAAM3W,OAAQhC,GAAK,EAC7CoZ,GAAeT,EAAM3Y,GAEvB,MAAMsZ,EAAa,IAAQP,EAAWH,EAChCW,EAAiB,IAAQH,EAAeL,EACxCxT,EAAM,CACViU,gBAAgB,EAChBC,gBAAgB,GAWlB,OATIH,EAAY,GAAKC,EAAgB,EACnChU,EAAIiU,gBAAiB,EAEZF,EAAY,GAAKC,EAAgB,IAC1ChU,EAAIkU,gBAAiB,GAKhBlU,GAITG,EAAO9D,KAAP,sBAAc,oCAAA8C,EAAA,yDAEZ4T,GAAW,EACLpa,EAAKoa,GAGLnG,EAAQzM,EAAOnD,IAAIxD,UAAY2G,EAAOnD,IAAIrC,UAClCqY,EAPF,gCAQJ3W,EAAK,CAAEiQ,QAAS,cAAe6H,KAAM,IARjC,UASNpB,IAAYpa,EATN,iDAWZqa,EAAYpG,EAGRwH,EAAgB,GAdR,yBAgBJ/X,EAAK,CAAEiQ,QAAS,SAAU3T,OAhBtB,WAiBNoa,IAAYpa,EAjBN,mDAkBJmJ,EAAY3B,EAAO0B,gBAEzBuS,EAAWjB,EAAerR,IACbmS,iBACLla,EAAOoG,EAAOnD,IAAIjD,KACxBgW,EAASjD,EAAU,CAAE/S,KAAa,IAAPA,KAC3BoG,EAAOnD,IAAIjD,KAAOT,KAAKwH,MAAa,IAAP/G,IAxBrB,WA0BHqa,EAASH,eA1BN,0CA6BNhB,EAAM,KA7BA,WA8BRF,IAAYpa,EA9BJ,oEA+BN0D,EAAK,CAAEiQ,QAAS,gBAAiB6H,KAAM,EAAGxb,OA/BpC,4CCjGhB,MAAM4T,GAAKC,YAAY,CACrB9S,KAAM,SACN+S,aAAc,CACZpF,OAAQ,EACR1O,GAAI,EACJ2O,QAAS,GACTtN,GAAI,KAEN0S,SAAU,CACR2H,WAAY,CAACzH,EAAO1Q,IAAR,eAAyB0Q,EAAzB,CAAgCjU,GAAIuD,EAAO2Q,UACvDyH,UAAW,CAAC1H,EAAO1Q,IAAR,eAAyB0Q,EAAzB,CAAgCvF,OAAQnL,EAAO2Q,UAC1D0H,WAAY,CAAC3H,EAAO1Q,IAAR,eAAyB0Q,EAAzB,CAAgCtF,QAASpL,EAAO2Q,UAC5D2H,SAAU,CAAC5H,EAAO1Q,IAAR,eAAyB0Q,EAAzB,GAAmC1Q,EAAO2Q,YAIzCE,GAAqBR,GAArBQ,QAASC,GAAYT,GAAZS,QACTsH,GAAgDtH,GAAhDsH,UAAWD,GAAqCrH,GAArCqH,WAAYE,GAAyBvH,GAAzBuH,WAAYC,GAAaxH,GAAbwH,S,wBCGlD,MAAMC,GAAgB,CACpB9R,EAAG,aACHlI,EAAG,KACHia,GAAI,IACJC,GAAI,IACJC,GAAI,IACJC,GAAI,KACJC,GAAI,IACJC,GAAI,SACJC,GAAI,SACJC,GAAI,SACJC,GAAI,UAGOC,GAAUhV,IACrB,MAAMmC,EAASnC,EAAOnD,IAAIsF,OACpBpC,EAAUC,EAAOD,QACvB,IACE,MAAMkV,EAAY,GAElBA,EAAKzS,EAAIxC,EAAOnD,IAAIxD,UACpB4b,EAAKxb,EAAI0I,EAAOkI,IAAI5Q,EACpBwb,EAAKvb,EAAIyI,EAAOkI,IAAI3Q,EACpBub,EAAKtb,EAAIwI,EAAOxI,EAChBsb,EAAK3a,EAAI4a,OAAOlV,EAAOnD,IAAIjD,MAC3Bqb,EAAKV,GAAKvU,EAAOnD,IAAIrC,OAAS,IAAM,IAEpCya,EAAKT,GAAKU,OAAOnV,EAAQvH,IACzByc,EAAKR,GAAKS,OAAO/b,KAAKwH,MAAuB,IAAjBZ,EAAQmH,SACpC+N,EAAKP,GAAKQ,QAAQnV,EAAQoH,QAAQnG,QAAQ,IAC1CiU,EAAKN,GAAK5U,EAAQlG,GAElBob,EAAKL,GAAKzS,EAAOmI,aAAatL,EAAEgC,QAAQ,GACxCiU,EAAKJ,GAAK1S,EAAOmI,aAAarL,EAAE+B,QAAQ,GACxCiU,EAAKH,GAAK3S,EAAOmI,aAAapL,EAAE8B,QAAQ,GACxCiU,EAAKF,GAAK5S,EAAOmI,aAAanL,EAAE6B,QAAQ,GAExC,IAAK,IAAIwO,KAAOyF,EAAUA,EAAKzF,KAAS8E,GAAS9E,WAAayF,EAAKzF,GAEnE,MAAM2F,EAAMnc,OAAOoc,QAAQH,GACxB5c,IAAI,EAAE+W,EAAGtH,KAAL,UAAesH,EAAf,YAAoBtH,IACxBuN,KAAK,KACRlD,OAAOmD,QAAQC,aAAa,GAAI,GAAhC,YAAyCJ,IACzC,MAAOvc,GACPkI,QAAQ0U,MAAM,oBAAqB5c,KAwChC,MAAM6c,GAAO,KAClB,IACE,MAAMC,EAAMzX,SAAS0X,SAASC,KAC9B,GAAIF,EAAIG,WAAW,MACjB,OAxCN,SAA2BH,GAEzB,MACMI,EADMJ,EAAIK,OAAO,GACE9P,MAAM,KAAKkN,OAAO,CAACC,EAAK4C,KAC/C,MAAMC,EAAQD,EAAM/P,MAAM,KAC1B,OAAOjN,OAAOsJ,OAAO8Q,EAAK,CAAE,CAAC6C,EAAM,IAAKA,EAAM,MAC7C,IAEGhB,EAAI,eAAQX,GAAR,GAAqBwB,GAEzBI,EAAO,CACXzc,EAAG0c,WAAWlB,EAAKxb,GACnBC,EAAGyc,WAAWlB,EAAKvb,GACnBC,EAAGwc,WAAWlB,EAAKtb,GACnBC,KAAMyM,SAAS4O,EAAK3a,GACpBjB,UAAW4b,EAAKzS,EAChBhI,OAA8B,IAAtB6L,SAAS4O,EAAKV,IACtBrI,SAAU/D,EAAO+B,UAgBnB,OAdAgM,EAAKhK,SAAW,IAAI/D,EAClBgO,WAAWlB,EAAKL,IAChBuB,WAAWlB,EAAKJ,IAChBsB,WAAWlB,EAAKH,IAChBqB,WAAWlB,EAAKF,IAChB,EACA,GAQK,CAAEmB,OAAMnW,QANC,CACdmH,OAAQb,SAAS4O,EAAKR,IAAM,IAC5BtN,QAASgP,WAAWlB,EAAKP,IACzBlc,GAAI6N,SAAS4O,EAAKT,GAAI,IACtB3a,GAAIob,EAAKN,KASAyB,CAAkBV,GAE3B,MAAO9c,GACPkI,QAAQ0U,MAAM,qBAAsB5c,GAEtC,OAAO,MAGIyd,GAAW,CACtBzG,EACA0G,GAAY,KAEZ,MAAMC,EAAUd,KAChB,IAAKc,GAAWD,EAAW,CAEzB,IAAIJ,EAAI,eACHtW,EAAU,cADP,CAENpF,QAAQ,EACR0R,SAAU/D,EAAO+B,WAEfnK,EAAuB,CACzBmH,OAAQ,EACRC,QAAS,GACT3O,GAAI,EACJqB,GAAI,KAMN,OAJA+V,EAASpD,EAAOgK,KAAKN,EAAM,cAC3BtG,EAASsE,GAAWnU,EAAQvH,KAC5BoX,EAASuE,GAAU,IACnBvE,EAASwE,GAAW,KACb,CAAE8B,OAAMnW,WACV,CAAC,MACEmW,EAAkBK,EAAlBL,KAAMnW,EAAYwW,EAAZxW,QAKd,OAJA6P,EAASpD,EAAOgK,KAAKD,EAAQL,KAAM,cACnCtG,EAASsE,GAAWnU,EAAQvH,KAC5BoX,EAASuE,GAAUpU,EAAQmH,SAC3B0I,EAASwE,GAAWrU,EAAQoH,UACrB,CACL+O,OACAnW,a,4CCpIN,MAAMqM,GAAKC,YAAY,CACrB9S,KAAM,KACN+S,aAAc,CACZmK,QAAQ,EACRC,eAAe,EACfC,IAAK,UACLC,SAAS,EACTC,MAAO,CAAEpd,EAAG,EAAGC,EAAG,EAAGE,KAAM,GAC3Bkd,cAAc,EACdC,kBAAkB,GAEpBxK,SAAU,CACRyK,UAAW,CAACvK,EAAO1Q,IAAR,eAAyB0Q,EAAzB,CAAgCgK,OAAQ1a,EAAO2Q,UAC1DuK,OAAQ,CAACxK,EAAO1Q,IAAR,eAAyB0Q,EAAzB,CAAgCkK,IAAK5a,EAAO2Q,UACpDwK,WAAY,CAACzK,EAAO1Q,IAAR,eAAyB0Q,EAAzB,CAAgCmK,QAAS7a,EAAO2Q,UAC5DyK,iBAAkB,CAAC1K,EAAO1Q,IAAR,eACb0Q,EADa,CAEhBiK,cAAe3a,EAAO2Q,UAExB0K,aAAc,CAAC3K,EAAO1Q,IAAR,eAAyB0Q,EAAzB,CAAgCoK,MAAO9a,EAAO2Q,UAC5D2K,gBAAiB,CAAC5K,EAAO1Q,IAAR,eACZ0Q,EADY,CAEfqK,aAAc/a,EAAO2Q,UAEvB4K,SAAU,CAAC7K,EAAO1Q,IAAR,eAAyB0Q,EAAzB,CAAgC8K,MAAOxb,EAAO2Q,aAI7CE,GAAqBR,GAArBQ,QAASC,GAAYT,GAAZS,QAEtBmK,GAOEnK,GAPFmK,UACAC,GAMEpK,GANFoK,OACAC,GAKErK,GALFqK,WACAC,GAIEtK,GAJFsK,iBACAC,GAGEvK,GAHFuK,aACAE,GAEEzK,GAFFyK,SACAD,GACExK,GADFwK,gBC9BF,IAAIrX,GAEG,MAEMwX,GAAc7Z,GAAD,uCAAoC,WAC5DiS,EACA+C,GAF4D,+BAAA3T,EAAA,sDAK5DqQ,EAAS,IAAK,IAAMO,EAASsH,IAAYvE,IAAWvG,GAAGwK,WACvDvH,EAAS,MAAO,IAAMO,EAASoH,IAAWrE,IAAWvG,GAAGqK,UACxDpH,EAAS,IAAK,KACZO,EAASoH,IAAU,IACnBpH,EAASqH,GAAO,YAT0C,GAatDQ,EAAgB,IAAM,CAACtF,OAAOuF,WAAYvF,OAAOwF,gBAbK,mBAc3Dha,EAAOnB,MAdoD,KAc7CmB,EAAOlB,OAdsC,KAe5D0V,OAAOrD,iBAAiB,SAAU,KAAO,IAAD,EACN2I,IADM,mBACrC9Z,EAAOnB,MAD8B,KACvBmB,EAAOlB,OADgB,KAEtCuD,GAAOM,OAAO3C,EAAOnB,MAAOmB,EAAOlB,QACnCuD,GAAO9D,SAIH0b,EAAiBC,GACrBjI,EAASyH,GAAgBQ,EAAMC,UAC3BC,EAAa5F,OAAO4F,WAAW,sBACrCH,EAAcG,GACdA,EAAWC,YAAYJ,GAEvBzF,OAAOrD,iBACL,QACAmJ,KAAS,KACPnX,QAAQ0U,MAAM,kCACd,MAAM0C,EAAOxC,GAAa9F,GAAU,GACpC5P,GAAOoH,IAAP,eAAgB8Q,IAChBlY,GAAO9D,QACN,MAILyB,EAAOmR,iBAAiB,aAAc,KACpCc,EAASuH,IAAiB,MAE5BxZ,EAAOmR,iBAAiB,aAAc,KACpCc,EAASuH,IAAiB,MAE5BxZ,EAAOmR,iBACL,YACAqJ,KAASjd,IACP,MAAMqG,EAAMvB,GAAOnD,IAAIsF,OAAOuJ,QAC5B,IAAIhE,EAAOxM,EAAIqX,QAASrX,EAAIsX,UAExB5Y,EAAOoG,GAAOsB,gBAAgBC,GACpCqO,EAASwH,GAAa,CAAE3d,EAAG8H,EAAI9H,EAAGC,EAAG6H,EAAI7H,EAAGE,WAC3C,KArDuD,EAyDlC8b,GAAa9F,GAA/BsG,EAzDoD,EAyDpDA,KAAMnW,EAzD8C,EAyD9CA,QACdC,GAAS,IAAI8L,EAAJ,eAAgBoK,EAAhB,CAAsBnW,UAASpC,YAExCwU,OAAOnS,OAASA,GAEVoY,EAAYH,KAAS,KACzBvC,GAAW1V,KACV,KACHA,GAAOnD,IAAIH,MAAMzB,GAAG,aAAcmd,GAClCpY,GAAOnD,IAAIH,MAAMzB,GAAG,cAAemd,GACnCpY,GAAOnD,IAAIH,MAAMzB,GAAG,aAAc,KAChC2U,EAAS0H,GAAS,8CAEpBtX,GAAOnD,IAAIH,MAAMzB,GACf,aACAgd,KAAS,KACPrI,EAAS0H,QAASe,KACjB,MAGL,IAAI1I,EAAW3P,GAAQ4P,GACvB6C,EAASzS,GAAQ4P,GACjB5P,GAAO9D,OA/EqD,4CAApC,wDAkFboc,GAAqBja,GAAD,uCAAuB,WACtDuR,EACA+C,GAFsD,eAAA3T,EAAA,sDAIhDuZ,EAAY3Y,EAAUvB,GAC5BuR,EAASjD,EAAU4L,IACnBvY,GAAOnD,IAAIsF,OAAOqJ,cAClBoE,EAAS4I,GAAsB,CAAErR,QAAS,MAC1CnH,GAAOD,QAAQqH,IAAI,CAAED,QAAS,KAC9BnH,GAAOoH,IAAImR,GACXvY,GAAO9D,OAV+C,2CAAvB,wDAapBuc,GAAgBje,GAAD,uCAA0B,WACpDoV,EACA+C,GAFoD,SAAA3T,EAAA,sDAIpD4Q,EAASjD,EAAU,CAAEnS,YACrBwF,GAAOoH,IAAI,CAAE5M,WACbwF,GAAO9D,OAN6C,2CAA1B,wDASfsU,GAAW,CAACkI,EAAY/e,IAAb,uCAAiC,WACvDiW,GADuD,SAAA5Q,EAAA,2DAG7CqZ,IAAN1e,GACFiW,EAASjD,EAAU,CAAElT,EAAGif,EAAGjf,EAAGC,EAAGgf,EAAGhf,KACpCsG,GAAOnD,IAAIsF,OAAOyJ,OAAO8M,KAEzB9I,EAASjD,EAAU,CAAElT,EAAGif,EAAGjf,EAAGC,EAAGgf,EAAGhf,EAAGC,OACvCqG,GAAOnD,IAAIsF,OAAOyJ,OAAO8M,EAAI/e,IAE/BqG,GAAO9D,OAVgD,2CAAjC,sDAaXyc,GAAkB7W,GAAD,uCAAsB,WAClD8N,GADkD,SAAA5Q,EAAA,sDAGlD4Q,EAAS4I,GAAuB1W,IAChC9B,GAAOD,QAAQqH,IAAI,CAAEF,OAAQpF,IAC7B9B,GAAO+B,YAL2C,2CAAtB,sDAQjB6W,GAAmB9W,GAAD,uCAAsB,WACnD8N,EACA+C,GAFmD,SAAA3T,EAAA,sDAInD4Q,EAAS4I,GAAwB1W,IACjC9B,GAAOD,QAAQqH,IAAI,CAAED,QAASwL,IAAWkG,OAAO1R,UAChDnH,GAAO+B,YAN4C,2CAAtB,wDASlBmS,GAAc1b,GAAD,uCAAqB,WAC7CoX,EACA+C,GAF6C,SAAA3T,EAAA,sDAI7C4Q,EAAS4I,GAAsB,CAAEhgB,KAAIqB,GAAI,OACzCmG,GAAOD,QAAQqH,IAAI,CAAE5O,KAAIqB,GAAI,MAC7BmG,GAAO+B,YANsC,2CAArB,wDCzHX+W,OA9Bf,WACE,MAAMlJ,EAAWmJ,cACX1a,EAAO2a,YAAavM,GAAgBA,EAAMrF,IAAI/N,WAE9C4f,EhBSNjgB,OAAOkgB,OAAOzZ,GACX0Z,OAAO/Z,IAAMA,EAAEzE,QACf+H,KAAK,CAAC1D,EAAGC,KAAOD,EAAE1F,SAAW,IAAM2F,EAAE3F,SAAW,IgBXvBjB,IAAKM,GAE7B,kBAACygB,EAAA,EAAD,CACE5J,IAAK7W,EAAEU,UACPggB,QAAM,EACNC,QAAS,IAAM1J,EAAS0I,GAAkB3f,EAAEU,YAC5CkgB,SAAUlb,IAAS1F,EAAEU,WAErB,kBAACmgB,EAAA,EAAD,CAAcC,QAAS9gB,EAAEY,SAI/B,OACE,6BACE,kBAACmgB,EAAA,EAAD,CACEC,UAAU,MACVC,UACE,kBAACC,EAAA,EAAD,CAAeF,UAAU,OAAzB,uBAGDV,K,mBCjBT,MAAMa,GAAO,SAAI,IAAa,KAExBC,GAAY,MAChB,MAAMla,EAAyC,GAIzClC,EAASM,SAASC,cAAc,UAChCL,EAAUF,EAAOiB,WAAW,MAClCjB,EAAOnB,MALO,IAMdmB,EAAOlB,OALQ,GAMf,MAAMiC,EAAYb,EAAQ0C,gBAAgB5C,EAAOnB,MAAOmB,EAAOlB,QACzD2D,EAAc,IAAII,YAAY9B,EAAU/B,KAAKN,QAanD,MAZA,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,IAAIZ,QAASjD,IAC/D,MAAMwhB,EAAcvU,EAAgBjN,EAVxB,KAWZ,IAAK,IAAI8B,EAAI,EAAGA,EAXJ,IAWeA,GAAK,EAC9B,IAAK,IAAIG,EAAI,EAAGA,EAXL,GAWiBA,GAAK,EAC/B2F,EAbQ,IAaI3F,EAAYH,GACtB0f,EAAY7gB,KAAKwH,MAAU,GAAJrG,EAAc,GAAJG,GAd3B,KAiBZoD,EAAQgB,aAAaH,EAAW,EAAG,EAAG,EAAG,EAAGf,EAAOnB,MAAOmB,EAAOlB,QACjE,MAAMwd,EAAUtc,EAAOuc,UAAU,aACjCra,EAAIzE,KAAK,CAAE5C,KAAIyhB,cAEVpa,GAvBS,GA0BZsa,GAAYC,YAAYC,IAAD,CAC3BC,SAAU,CACRC,QAAS,OACTC,SAAU,OACVC,aAAcJ,EAAMK,QAAQ,GAC5B,QAAS,CACPC,cAAeN,EAAMK,QAAQ,GAC7BE,aAAcP,EAAMK,QAAQ,GAC5Ble,MAAO,MACPC,OAAQ,OACRoe,SAAU,WACV,UAAW,CACTre,MAAO,OACPC,OAAQ,OACRqe,aAAc,OAEhB,QAAS,CACPD,SAAU,WACVE,OAAQ,EACR/N,MAAO,EACPzF,MAAO,QACPyT,SAAU,OACVC,QAAS,MACTC,WAAY,sBAIlBC,IAAK,CACH3e,MAAO,YAyDI4e,OArDf,WACE,MAAMC,EAAUlB,KACVvK,EAAWmJ,cACXF,EAASG,YAAavM,GAAgBA,EAAMoM,QAC5CyB,EAAWP,GAAU1hB,IAAKsN,GAC9B,yBAAK6J,IAAK7J,EAASnN,GAAI8gB,QAAS,IAAM1J,EAASsE,GAAWvO,EAASnN,MACjE,yBAAK8iB,IAAI,GAAGC,IAAK5V,EAASsU,UACzBpB,EAAOrgB,KAAOmN,EAASnN,GACtB,uBAAGgjB,UAAU,kBAAb,gBACE,OAIFC,EAAgBtiB,KAAKC,IAAI,GAAKyf,EAAO1R,SAAWhO,KAAKC,IAAI0gB,IAG/D,OACE,6BACE,kBAACJ,EAAA,EAAD,CAAMC,UAAU,MAAM+B,OAAK,GACzB,kBAAC7B,EAAA,EAAD,CAAeF,UAAU,OAAzB,iCAGA,kBAACP,EAAA,EAAD,KACE,yBAAKoC,UAAWH,EAAQf,UAAWA,IAErC,kBAAClB,EAAA,EAAD,KACE,kBAACuC,GAAA,EAAD,CAAYH,UAAWH,EAAQF,KAA/B,QACA,kBAACS,GAAA,EAAD,CACE1T,IAAK,EACL5C,IAAK,EACLuW,KAAM,KACNC,MAAOjD,EAAO3R,OACd6U,SAAU5D,KAAS,CAAC6D,EAAGlU,IAAM8H,EAAS+I,GAAe7Q,IAAK,QAG9D,kBAACsR,EAAA,EAAD,KACE,kBAACuC,GAAA,EAAD,CAAYH,UAAWH,EAAQF,KAA/B,WACA,kBAACS,GAAA,EAAD,CACE1T,IAAK,EACL5C,IAAK,IACLuW,KAAM,EACNC,MAAOL,EACPM,SAAU5D,KACR,CAAC6D,EAAGlU,KAAM8H,SAASgJ,IA7BX9W,EA6BsCgG,EA7BrB,IAAD,SAAWgS,GAAWhY,MAAtCA,OA8BR,W,oBC/DCma,OA9Cf,WACE,MAAMrM,EAAWmJ,cACXve,EAASwe,YAAavM,GAAgBA,EAAMrF,IAAI5M,QAChD4R,EAAK4M,YAAavM,GAAgBA,EAAML,IAE9C,OACE,6BACE,kBAACsN,EAAA,EAAD,CACEC,UAAU,MACVC,UACE,kBAACC,EAAA,EAAD,CAAeF,UAAU,OAAzB,sBAGF,kBAACP,EAAA,EAAD,KACE,kBAACI,EAAA,EAAD,CAAcC,QAAQ,qBACtB,kBAACyC,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CACEC,KAAK,MACLL,SAAWrf,IACTkT,EAAS6I,GAAa/b,EAAM2f,OAAOC,WAErCA,QAAS9hB,EACT+M,MAAM,cAIX6E,EAAG0K,aAAe,KACjB,kBAACsC,EAAA,EAAD,KACE,kBAACI,EAAA,EAAD,CAAcC,QAAQ,oBACtB,kBAACyC,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CACEC,KAAK,MACLL,SAAWrf,IACTkT,EAASsH,GAAWxa,EAAM2f,OAAOC,WAEnCA,QAASlQ,EAAGwK,QACZrP,MAAM,iB,kDChDf,MCaD4S,GAAYC,YAAYC,GAC5BkC,aAAa,CACXC,OAAQ,CACNC,gBAAiBpC,EAAMqC,QAAQjD,QAAQkD,MAEzCC,OAAQ,CACNrC,QAAS,UAEX/K,IAAK,CACH+K,QAAS,eACTsC,cAAe,SACfC,OAAQ,iBACRC,WAAY,OACZjC,aAAc,MACdG,QAAS,UACT+B,OAAQ,UACRhC,SAAU,OACViC,SAAU,QACVC,UAAW,SACX3V,MAAO,YAKP4V,GAAO,KACX,MAAM9B,EAAUlB,KAChB,OACE,+BACE,0BAAMqB,UAAWH,EAAQ7L,KAAzB,UAA8C,IAC9C,0BAAMgM,UAAWH,EAAQ7L,KAAzB,UAA8C,IAC9C,0BAAMgM,UAAWH,EAAQ7L,KAAzB,UAA8C,IAC9C,0BAAMgM,UAAWH,EAAQ7L,KAAzB,UAJF,KAIkD,IAChD,0BAAMgM,UAAWH,EAAQ7L,KAAzB,KAAuC,IACvC,0BAAMgM,UAAWH,EAAQ7L,KAAzB,KACA,6BAPF,MAQK,0BAAMgM,UAAWH,EAAQ7L,KAAzB,KAAuC,IAC1C,0BAAMgM,UAAWH,EAAQ7L,KAAzB,KAAuC,IACvC,0BAAMgM,UAAWH,EAAQ7L,KAAzB,KAVF,IAU0C,IACxC,0BAAMgM,UAAWH,EAAQ7L,KAAzB,KAXF,KAYE,6BAZF,MAaK,0BAAMgM,UAAWH,EAAQ7L,KAAzB,SAbL,OAkBE4N,GAAS,KACb,MAAM/B,EAAUlB,KAChB,OACE,kBAACwB,GAAA,EAAD,CACEhC,UAAU,OACV0D,QAAQ,QACR7B,UAAWH,EAAQuB,OACnBrV,MAAM,eAJR,+FAOoB,IAClB,uBACE8U,OAAO,SACPiB,IAAI,sBACJC,KAAK,0CAHP,UARF,MAoBW,SAASC,KACtB,MAAMnC,EAAUlB,KAEhB,OACE,oCACE,kBAACT,EAAA,EAAD,CAAMC,UAAU,MAAM8D,MAAO,CAAEC,SAAS,UACtC,kBAAC7D,EAAA,EAAD,CAAeF,UAAU,OAAzB,YDlFN,iBAAkBxH,QAClBnG,UAAU2R,eAAiB,GAC3B3R,UAAU4R,iBAAmB,ECkFrB,kBAACxE,EAAA,EAAD,KACE,kBAACyE,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAQtC,UAAWH,EAAQmB,QACzB,uBAAGhB,UAAU,kBAAb,eAGJ,kBAAChC,EAAA,EAAD,CAAcC,QAAQ,QAAQsE,UAAU,2BAExC,KDvFVhG,WAAW,kBAAkBD,SAAWC,WAAW,iBAAiBD,QCyF5D,kBAACsB,EAAA,EAAD,KACE,kBAACyE,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAQtC,UAAWH,EAAQmB,QACzB,uBAAGhB,UAAU,kBAAb,WAGJ,kBAAChC,EAAA,EAAD,CAAcC,QAAQ,QAAQsE,UAAU,uBAExC,KD1GoB,qBAAvB5L,OAAO6L,cAC+B,IAA7ChS,UAAUiS,UAAUC,QAAQ,YC2GpB,kBAAC9E,EAAA,EAAD,KACE,kBAACyE,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAQtC,UAAWH,EAAQmB,QACzB,uBAAGhB,UAAU,kBAAb,cAGJ,kBAAChC,EAAA,EAAD,CAAcC,QAAQ,WAAWsE,UAAW,kBAACZ,GAAD,SAE5C,KACJ,kBAACgB,GAAA,EAAD,MACA,kBAACtE,EAAA,EAAD,CAAeF,UAAU,OAAzB,SACA,kBAACP,EAAA,EAAD,KACE,kBAACgE,GAAD,OAEF,kBAAChE,EAAA,EAAD,KACE,kBAAC,KAAD,CACEmE,KAAK,wCACLa,oBAAkB,mDAClBC,YAAU,QACVC,mBAAiB,EACjBC,aAAW,qCALb,QAQgB,OC9HX,SAASC,KACtB,MAAMxe,ENkBuBA,GMjBvBmC,EAASnC,EAAOnD,IAAIsF,OAC1B,OACE,6BACE,kBAACuX,EAAA,EAAD,CAAMC,UAAU,OACd,kBAACE,EAAA,EAAD,CAAeF,UAAU,OAAzB,SACA,kBAACP,EAAA,EAAD,iBAAoBpZ,EAAOnD,IAAIM,WAC/B,kBAACic,EAAA,EAAD,gBACWjX,EAAOqI,OAAO/Q,EADzB,MAC+B0I,EAAOqI,OAAO9Q,K,6CCgBtC+kB,OAnBAC,IACb,MAAMC,EAAO3S,UACb,OAAK2S,EAAIC,MAEP,kBAACC,GAAA,EAAD,CACErD,UAAWkD,EAAMlD,UACjBlC,QAAS,KACPqF,EAAIC,MAAM,CACRE,MAAO,YACPC,KAAM,mCACNrJ,IAAKvD,OAAOwD,SAAS4H,SAIzB,uBAAG/B,UAAU,kBAAb,UAZmB,MCJzB,MAAMrB,GAAYC,YAAYC,IAAD,CAC3B2E,IAAK,CACHvC,gBAAiBwC,gBAAK5E,EAAMqC,QAAQjD,QAAQkD,KAAM,IAClDuC,eAAgB,YAChBrE,SAAU,QACVN,QAAS,OACT,CAACF,EAAM8E,YAAYC,KAAK,OAAQ,CAC9B5iB,MAAO,OACPC,OAAQ,OACRse,OAAQ,GAEV,CAACV,EAAM8E,YAAYpS,GAAG,OAAQ,CAC5BtQ,OAAQ,OACR4iB,cAAe,SACfvS,KAAM,EACN0N,SAAU,iBAGd8E,MAAO,CACL/X,MAAO,QACP,CAAC8S,EAAM8E,YAAYC,KAAK,OAAQ,CAC9B5iB,MAAO,QAET,CAAC6d,EAAM8E,YAAYpS,GAAG,OAAQ,CAC5BvQ,MAAO,SAGX+iB,MAAO,CACL,CAAClF,EAAM8E,YAAYC,KAAK,OAAQ,CAC9B7E,QAAS,QAEXhT,MAAO,QACPyT,SAAU,OACVwE,WAAY,OACZC,YAAa,cACb1gB,UAAW,iBACX2gB,WAAY,SACZ/E,cAAe,OACfgF,WAAY,QACZC,cAAe,MACfC,WAAY,IACZC,SAAU,EACVC,eAAgB,WAoCLC,OAhCC,KACd,MAAM3E,EAAUlB,KACVvK,EAAWmJ,cACXE,EAAU5gB,KAAI4nB,GAAY,CAACC,EAAKC,IACnCD,EAAIvlB,OAWD,KAVF,kBAACkkB,GAAA,EAAD,CACErP,IAAK2Q,EACL3E,UAAWH,EAAQiE,MACnBhG,QAAS,KACP1J,EAASqH,GAAOkJ,IAChBvQ,EAASoH,IAAU,MAGrB,uBAAGwE,UAAU,kBAAkB0E,EAAIE,QAGvCjH,OAAOkH,SAaT,OAZApH,EAAQ7d,KACN,uBACEmiB,KAAK,wCACLlB,OAAO,IACPb,UAAWH,EAAQkE,MACnB/P,IAAI,SAJN,cASFyJ,EAAQqH,OAAO,EAAG,EAAG,kBAAC,GAAD,CAAO9Q,IAAI,QAAQgM,UAAWH,EAAQiE,SAEpD,yBAAK9D,UAAWH,EAAQ2D,KAAM/F,ICtEhC,MAAMgH,GAAqC,CAChDM,QAAS,CAAEH,KAAM,OAAQzG,UAAW,kBAAC,GAAD,OACpC+C,QAAS,CAAE0D,KAAM,gBAAiBzG,UAAW,kBAAC,GAAD,OAE7C6G,SAAU,CAAEJ,KAAM,WAAYzG,UAAW,kBAAC,GAAD,OACzC8G,MAAO,CAAEL,KAAM,eAAgBzG,UAAW,kBAAC,GAAD,OAC1C5Y,MAAO,CAAEpG,QAAQ,EAAMgf,UAAW,kBAAC6E,GAAD,QAG9BrE,GAAYC,YAAYC,IAAD,CAC3BqG,OAAQ,CACNC,IAAK,OACL5F,OAAQ,GAEVtE,OAAQ,CACNwG,SAAU,QACV,CAAC5C,EAAM8E,YAAYpS,GAAG,OAAQ,CAC5BvQ,MAAO,UAGXokB,MAAO,CAIL,CAACvG,EAAM8E,YAAYC,KAAK,OAAQ,CAC9ByB,oBAAqB,OACrBC,qBAAsB,SAG1BC,OAAQ,CACNvkB,MAAO,MACPwgB,OAAQ,qBACRvgB,OAAQ,UAoCGukB,OAhCI,KACjB,MAAM3F,EAAUlB,KACVvK,EAAWmJ,cAFM,EAGCC,YAAavM,IAAD,CAClCgK,OAAQhK,EAAML,GAAGqK,OACjBE,IAAKlK,EAAML,GAAGuK,OAFRF,EAHe,EAGfA,OAAQE,EAHO,EAGPA,IAIVsK,EAAYC,YAAc,qBAC1BC,EAAUlB,GAAWtJ,GAAO,WAAWgD,UAE7C,OACE,oCACE,kBAAC,GAAD,MACA,kBAACyH,EAAA,EAAD,CACEC,OAAQJ,EAAY,OAAS,SAC7BK,KAAM7K,EACN8K,kBAAgB,EAChBC,oBAAkB,EAClBC,WAAY,CAAEjG,UAAWH,EAAQuF,OACjCc,cAAe,CAAEC,WAAW,GAC5BC,QAAS,IAAMhS,EAASoH,IAAU,IAClC6K,OAAQ,IAAMjS,EAASoH,IAAU,KAEjC,yBAAKwE,UAAWH,EAAQ5E,QACpBwK,EAAqD,KAAzC,kBAAC9C,GAAA,EAAD,CAAS3C,UAAWH,EAAQ0F,SACzCI,M,oBCpEX,MAAMhH,GAAYC,YAAYC,IAAD,CAC3ByH,IAAK,CACHjH,SAAU,QACVE,OAAQ,EACR/N,MAAO,EACPgQ,OAAQ,OACRD,WAAY,QACZ9B,QAAS,WAqCE8G,OAjCf,WACE,MAAM1G,EAAUlB,KACV/S,EAAM4R,YAAavM,GAAgBA,EAAMrF,KACzCgF,EAAK4M,YAAavM,GAAgBA,EAAML,IAC9C,GAAIA,EAAG0K,aAAc,OAAO,KAC5B,IAAK1K,EAAGwK,QAAS,OAAO,KACxB,MAAMzX,EAAS,GAYf,OAXIiN,EAAGsK,eACLvX,EAAE1F,EAAI2S,EAAGyK,MAAMpd,EACf0F,EAAEzF,EAAI0S,EAAGyK,MAAMnd,EACfyF,EAAEvF,KAAOwS,EAAGyK,MAAMjd,KAClBuF,EAAExF,EAAIyN,EAAIzN,IAEVwF,EAAE1F,EAAI2N,EAAI3N,EACV0F,EAAEzF,EAAI0N,EAAI1N,EACVyF,EAAEvF,KAAOwN,EAAIxN,KACbuF,EAAExF,EAAIyN,EAAIzN,GAGV,kBAACqoB,GAAA,EAAD,CAAOC,UAAW,EAAGzG,UAAWH,EAAQyG,KACtC,kBAACnG,GAAA,EAAD,CAAYpU,MAAM,UAAU2a,cAAY,EAAC7E,QAAQ,MAC9CjR,EAAGsK,cAAgB,QAAU,UAEhC,kBAACiF,GAAA,EAAD,CAAYhC,UAAU,OACpB,kBAACwI,GAAA,EAAD,CAAKzC,WAAW,aAAhB,MAAgCvgB,EAAE1F,EAAEuH,QAAQ,KAC5C,kBAACmhB,GAAA,EAAD,CAAKzC,WAAW,aAAhB,MAAgCvgB,EAAEzF,EAAEsH,QAAQ,KAC5C,kBAACmhB,GAAA,EAAD,CAAKzC,WAAW,aAAhB,eAAyCvgB,EAAEvF,KAAKoH,QAAQ,IACxD,kBAACmhB,GAAA,EAAD,CAAKzC,WAAW,aAAhB,WAAqCvgB,EAAExF,EAAEyoB,cAAc,O,UCxC/D,MAAMjI,GAAYC,YAAYC,IAAD,CAC3BgI,SAAU,CACR,CAAChI,EAAM8E,YAAYC,KAAK,OAAQ,CAC9BrE,OAAQ,QAmBCuH,OAdI,KACjB,MAAMlW,EAAK4M,YAAavM,GAAgBA,EAAML,IACxCiP,EAAUlB,KAChB,OAAK/N,EAAGmL,MAGN,kBAACgL,GAAA,EAAD,CACEjB,MAAM,EACN9F,UAAWH,EAAQgH,SACnBG,QAAQ,4CANU,MCkBTC,OAzBH,KACV,MAAM7S,EAAWmJ,cACX2J,EAAMC,iBAAO,MACbvW,EAAK4M,YAAavM,GAAgBA,EAAML,IACxC6U,EAAYC,YAAc,qBAEhC0B,IAAMC,UAAU,KACd,MAAMllB,EAAU+kB,EAAII,QACpBlT,EAAS4H,GAAW7Z,KACnB,CAACiS,IAEJ,IAAImT,EAAc,GAIlB,OAHI3W,EAAGqK,SACLsM,EAAc9B,EAAY,cAAH,qBAAiC7U,EAAGuK,MAG3D,6BACE,4BAAQ+L,IAAKA,EAAKlH,UAAWuH,IAC7B,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,Q,UClBN,MAAMC,GAAc3C,QACW,cAA7BlO,OAAOwD,SAASsN,UAEe,UAA7B9Q,OAAOwD,SAASsN,UAEhB9Q,OAAOwD,SAASsN,SAASC,MACvB,2DA8CN,SAASC,GAAgBC,EAAeC,GACtCrX,UAAUsX,cACPC,SAASH,GACTI,KAAKC,IACJA,EAAaC,cAAgB,KAC3B,MAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,KACA,cAA3BF,EAAiBlX,QACfT,UAAUsX,cAAcQ,YAI1BhjB,QAAQ1H,IACN,iHAKEiqB,GAAUA,EAAOU,UACnBV,EAAOU,SAASN,KAMlB3iB,QAAQ1H,IAAI,sCAGRiqB,GAAUA,EAAOW,WACnBX,EAAOW,UAAUP,UAO5B9gB,MAAM6S,IACL1U,QAAQ0U,MAAM,4CAA6CA,K,aC7FlDyO,OANFC,aAAgB,CAC3B9X,MACAhF,MACAyR,Y,UCEF,MAAMsL,GAAQC,YAAe,CAAExX,aAEzByN,GAAQgK,aAAe,CAC3B3H,QAAS,GAGTyC,YAAa,CACXjG,OAAQ,CACNpV,GAAI,EACJwgB,GAAI,IACJC,GAAI,IACJC,GAAI,KACJC,GAAI,SAKVC,IAASC,OACP,kBAAC,IAAD,CAAUR,MAAOA,IACf,kBAACS,GAAA,EAAD,CAAevK,MAAOA,IACpB,kBAAC,GAAD,QAGJpc,SAAS4mB,eAAe,SFNnB,SAAkBxB,GACvB,GAA6C,kBAAmBrX,UAAW,CAMzE,GAJkB,IAAI8Y,IACpBC,IACA5S,OAAOwD,SAAS4H,MAEJyH,SAAW7S,OAAOwD,SAASqP,OAIvC,OAGF7S,OAAOrD,iBAAiB,OAAQ,KAC9B,MAAMsU,EAAK,UAAM2B,IAAN,sBAEP/B,KAgEV,SAAiCI,EAAeC,GAE9C4B,MAAM7B,EAAO,CACX8B,QAAS,CAAE,iBAAkB,YAE5B1B,KAAK2B,IAEJ,MAAMC,EAAcD,EAASD,QAAQ9T,IAAI,gBAEnB,MAApB+T,EAASE,QACO,MAAfD,IAA8D,IAAvCA,EAAYlH,QAAQ,cAG5ClS,UAAUsX,cAAcgC,MAAM9B,KAAKC,IACjCA,EAAa8B,aAAa/B,KAAK,KAC7BrR,OAAOwD,SAAS6P,aAKpBrC,GAAgBC,EAAOC,KAG1B1gB,MAAM,KACL7B,QAAQ1H,IACN,mEAvFAqsB,CAAwBrC,EAAOC,GAI/BrX,UAAUsX,cAAcgC,MAAM9B,KAAK,KACjC1iB,QAAQ1H,IACN,gHAMJ+pB,GAAgBC,EAAOC,MEtB/BC,K","file":"static/js/main.7ff8f930.chunk.js","sourcesContent":["module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"184f355f6bc47b7f0801.worker.js\");\n};","var map = {\n\t\"./burningbird.ts\": 154,\n\t\"./burningship.ts\": 155,\n\t\"./example.ts\": 156,\n\t\"./mandelbrot.ts\": 157,\n\t\"./mandelbrot3.ts\": 158,\n\t\"./mandelbrot4.ts\": 159,\n\t\"./tippetts.ts\": 160\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 153;","import { FractalDef } from \"./example\";\n\nconst escape = 4;\nvar iLog2 = 1.0 / Math.log(2.0);\n\nexport default {\n  fractalId: \"burningbird\",\n  uiOrder: 2.5,\n  name: \"Burning Bird\",\n  preset: { x: -0.46, y: 0.07, w: 3.26, iter: 50 },\n  fn: {\n    normal: (cx, cy, iter) => {\n      var zx = 0,\n        zy = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0,\n        znx,\n        zny;\n      cy = -cy; // this fractal is usually represented upside down\n      while (true) {\n        zny = (zx + zx) * zy + cy;\n        znx = sqx - sqy + cx;\n        zx = znx;\n        zy = Math.abs(zny);\n        if (++i >= iter) break;\n        sqx = zx * zx;\n        sqy = zy * zy;\n        if (sqx + sqy > escape) break;\n      }\n      return i;\n    },\n    smooth: (cx, cy, iter) => {\n      var zx = 0,\n        zy = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0,\n        j,\n        znx,\n        zny;\n      cy = -cy; // this fractal is usually represented upside down\n      while (true) {\n        zny = (zx + zx) * zy + cy;\n        znx = sqx - sqy + cx;\n        zx = znx;\n        zy = Math.abs(zny);\n        if (++i >= iter) break;\n        sqx = zx * zx;\n        sqy = zy * zy;\n        if (sqx + sqy > escape) break;\n      }\n      if (i === iter) return i;\n      for (j = 0; j < 4; ++j) {\n        zny = (zx + zx) * zy + cy;\n        znx = sqx - sqy + cx;\n        zx = znx;\n        zy = Math.abs(zny);\n        sqx = zx * zx;\n        sqy = zy * zy;\n      }\n      return 5 + i - Math.log(Math.log(sqx + sqy)) * iLog2;\n    },\n  },\n} as FractalDef;\n","import { FractalDef } from \"./example\";\n\nconst escape = 4;\nvar iLog2 = 1.0 / Math.log(2.0);\n\nexport default {\n  fractalId: \"burningship\",\n  uiOrder: 2,\n  name: \"Burning Ship\",\n  preset: { x: -0.4, y: 0.55, w: 3, iter: 50 },\n  fn: {\n    normal: (cx, cy, iter) => {\n      var zx = 0,\n        zy = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0,\n        znx,\n        zny;\n      cy = -cy; // this fractal is usually represented upside down\n      while (true) {\n        zny = (zx + zx) * zy + cy;\n        znx = sqx - sqy + cx;\n        zx = Math.abs(znx);\n        zy = Math.abs(zny);\n        if (++i >= iter) break;\n        sqx = zx * zx;\n        sqy = zy * zy;\n        if (sqx + sqy > escape) break;\n      }\n      return i;\n    },\n    smooth: (cx, cy, iter) => {\n      var zx = 0,\n        zy = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0,\n        j,\n        znx,\n        zny;\n      cy = -cy; // this fractal is usually represented upside down\n      while (true) {\n        zny = (zx + zx) * zy + cy;\n        znx = sqx - sqy + cx;\n        zx = Math.abs(znx);\n        zy = Math.abs(zny);\n        if (++i >= iter) break;\n        sqx = zx * zx;\n        sqy = zy * zy;\n        if (sqx + sqy > escape) break;\n      }\n      if (i === iter) return i;\n      for (j = 0; j < 4; ++j) {\n        zny = (zx + zx) * zy + cy;\n        znx = sqx - sqy + cx;\n        zx = Math.abs(znx);\n        zy = Math.abs(zny);\n        sqx = zx * zx;\n        sqy = zy * zy;\n      }\n      return 5 + i - Math.log(Math.log(sqx + sqy)) * iLog2;\n    },\n  },\n} as FractalDef;\n","export type RenderFn = (cx: number, cy: number, iter: number) => number;\nexport interface FractalDef {\n  fractalId: string;\n  hidden?: boolean;\n  uiOrder?: number;\n  name: string;\n  preset: {\n    x: number;\n    y: number;\n    w: number;\n    iter: number;\n  };\n  fn: {\n    normal: RenderFn;\n    smooth?: RenderFn;\n  };\n}\n\nexport default {\n  fractalId: \"example\",\n  hidden: true,\n  uiOrder: -1,\n  name: \"example\",\n  preset: {\n    x: -0.7,\n    y: 0.0,\n    w: 2.5,\n    iter: 50,\n  },\n  fn: {\n    normal: (cx, cy, iter) => {\n      return 0;\n    },\n    smooth: (cx, cy, iter) => {\n      return 0;\n    },\n  },\n} as FractalDef;\n","import { FractalDef } from \"./example\";\n\nconst escape = 4;\nvar iLog2 = 1.0 / Math.log(2.0);\n\nexport default {\n  fractalId: \"mandelbrot\",\n  uiOrder: 0,\n  name: \"Mandelbrot\",\n  preset: { x: -0.7, y: 0.0, w: 2.5, iter: 50 },\n  fn: {\n    normal: (cx, cy, iter) => {\n      var znx = 0,\n        zny = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0;\n      for (; i < iter && sqx + sqy <= escape; ++i) {\n        zny = (znx + znx) * zny + cy;\n        znx = sqx - sqy + cx;\n        sqx = znx * znx;\n        sqy = zny * zny;\n      }\n      return i;\n    },\n    smooth: (cx, cy, iter) => {\n      var znx = 0,\n        zny = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0,\n        j = 0;\n      for (; i < iter && sqx + sqy <= escape; ++i) {\n        zny = (znx + znx) * zny + cy;\n        znx = sqx - sqy + cx;\n        sqx = znx * znx;\n        sqy = zny * zny;\n      }\n      if (i === iter) return i;\n      for (j = 0; j < 4; ++j) {\n        zny = (znx + znx) * zny + cy;\n        znx = sqx - sqy + cx;\n        sqx = znx * znx;\n        sqy = zny * zny;\n      }\n      return 5 + i - Math.log(Math.log(sqx + sqy)) * iLog2;\n    },\n  },\n} as FractalDef;\n","import { FractalDef } from \"./example\";\n\nconst escape = 4;\nvar iLog4 = 1.0 / Math.log(4.0);\n\nexport default {\n  fractalId: \"mandelbrot3\",\n  uiOrder: 3,\n  name: \"Multibrot *3\",\n  preset: { x: 0.0, y: 0.0, w: 3.0, iter: 50 },\n  fn: {\n    normal: (cx, cy, iter) => {\n      var zx = 0,\n        zy = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0,\n        znx,\n        zny;\n      while (true) {\n        znx = sqx * zx - 3 * zx * sqy + cx;\n        zny = 3 * sqx * zy - sqy * zy + cy;\n        zx = znx;\n        zy = zny;\n        if (++i >= iter) break;\n        sqx = zx * zx;\n        sqy = zy * zy;\n        if (sqx + sqy > escape) break;\n      }\n      return i;\n    },\n    smooth: (cx, cy, iter) => {\n      var zx = 0,\n        zy = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0,\n        j,\n        znx,\n        zny;\n      while (true) {\n        znx = sqx * zx - 3 * zx * sqy + cx;\n        zny = 3 * sqx * zy - sqy * zy + cy;\n        zx = znx;\n        zy = zny;\n        if (++i >= iter) break;\n        sqx = zx * zx;\n        sqy = zy * zy;\n        if (sqx + sqy > escape) break;\n      }\n      if (i === iter) return i;\n      for (j = 0; j < 4; ++j) {\n        znx = sqx * zx - 3 * zx * sqy + cx;\n        zny = 3 * sqx * zy - sqy * zy + cy;\n        zx = znx;\n        zy = zny;\n        sqx = zx * zx;\n        sqy = zy * zy;\n      }\n      return 5 + i - Math.log(Math.log(sqx + sqy)) * iLog4;\n    },\n  },\n} as FractalDef;\n","import { FractalDef } from \"./example\";\n\nconst escape = 4;\nvar iLog4 = 1.0 / Math.log(4.0);\n\nexport default {\n  fractalId: \"mandelbrot4\",\n  uiOrder: 4,\n  name: \"Multibrot *4\",\n  preset: { x: 0.0, y: 0.0, w: 3.0, iter: 50 },\n  fn: {\n    normal: (cx, cy, iter) => {\n      var zx = 0,\n        zy = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0,\n        znx,\n        zny;\n      while (true) {\n        znx = sqx * sqx - 6 * sqx * sqy + sqy * sqy + cx;\n        zny = 4 * sqx * zx * zy - 4 * zx * sqy * zy + cy;\n        zx = znx;\n        zy = zny;\n        if (++i >= iter) break;\n        sqx = zx * zx;\n        sqy = zy * zy;\n        if (sqx + sqy > escape) break;\n      }\n      return i;\n    },\n    smooth: (cx, cy, iter) => {\n      var zx = 0,\n        zy = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0,\n        znx,\n        zny;\n      while (true) {\n        znx = sqx * sqx - 6 * sqx * sqy + sqy * sqy + cx;\n        zny = 4 * sqx * zx * zy - 4 * zx * sqy * zy + cy;\n        zx = znx;\n        zy = zny;\n        if (++i >= iter) break;\n        sqx = zx * zx;\n        sqy = zy * zy;\n        if (sqx + sqy > escape) break;\n      }\n      if (i === iter) return i;\n      return 5 + i - Math.log(Math.log(sqx + sqy)) * iLog4;\n    },\n  },\n} as FractalDef;\n","import { FractalDef } from \"./example\";\n\nconst escape = 4;\n\nexport default {\n  fractalId: \"tippetts\",\n  uiOrder: 1,\n  name: \"Tippetts\",\n  preset: { x: -0.5, y: 0.0, w: 4, iter: 50 },\n  fn: {\n    normal: (cx, cy, iter) => {\n      var zx = 0,\n        zy = 0,\n        sqx = 0,\n        sqy = 0,\n        i = 0;\n      for (; i < iter && sqx + sqy <= escape; ++i) {\n        zx = sqx - sqy + cx;\n        zy = (zx + zx) * zy + cy;\n        sqx = zx * zx;\n        sqy = zy * zy;\n      }\n      return i;\n    },\n  },\n} as FractalDef;\n","export type Callback = (x: any) => void;\n\nexport default class EventBus {\n  private listeners: {\n    [key: string]: Callback[];\n  };\n\n  constructor() {\n    this.listeners = {};\n  }\n\n  on(evt: string, callback: Callback) {\n    if (!(evt in this.listeners)) this.listeners[evt] = [];\n    this.listeners[evt].push(callback);\n  }\n\n  notify(evt: string, obj?: any) {\n    // force the notification to occur from the event loop (always async callback)\n    setTimeout(() => {\n      const callbacks = this.listeners[evt] || [];\n      if (obj) obj.evt = evt;\n      callbacks.forEach(cb => {\n        cb(obj);\n      });\n    }, 0);\n  }\n}\n","// @ts-ignore\nimport WorkerInterface from \"./worker/interface.worker.js\";\nimport { DrawOrder, Order, WorkerResponse } from \"./types\";\n\ninterface TWorker {\n  postMessage: (x: Order, y?: any[]) => void;\n  onmessage: (x: any) => void;\n}\ntype LocalCallback = (worker: Worker, data: WorkerResponse) => void;\n\n/*\n  A typed, object, and generally simplified proxy in front of the worker.\n  Handles neutered arrays.\n*/\nexport default class Worker {\n  public id: number;\n  public available: boolean = true;\n\n  private worker: TWorker;\n  private callback: LocalCallback;\n\n  constructor(id: number, callback: LocalCallback) {\n    this.id = id;\n    this.worker = (new WorkerInterface() as unknown) as TWorker;\n    this.worker.postMessage({ action: \"init\", id });\n    this.worker.onmessage = this.onmessage.bind(this);\n    this.callback = callback;\n  }\n\n  draw(order: DrawOrder) {\n    const tile = order.tile;\n    if (tile.buffer.length === 0) {\n      // recreate if neutered\n      tile.buffer = new Float32Array(tile.width * tile.height);\n    }\n    this.available = false;\n    this.worker.postMessage(order, [tile.buffer.buffer]);\n  }\n\n  onmessage(event: any) {\n    const data: WorkerResponse = event.data;\n    this.available = true;\n    this.callback(this, data);\n  }\n}\n","import Worker from \"./worker\";\nimport { DrawOrder, WorkerResponse } from \"./types\";\nimport { Context } from \"../engine\";\n\n/*\nMaintains the list of webworkers.\nReceive list of orders from the renderer and dispatches them to the workers.\nCan be interrupted in the middle of a rendering.\nDeal with neutered arrays (arrays passed by reference between main thread and workers).\n*/\nexport default class Scheduler {\n  private orders: DrawOrder[] = [];\n  private workers: Worker[] = [];\n  private upperCallback: (data: WorkerResponse) => void;\n  private batchId: number = 1;\n  public handlers!: {\n    resolve: () => any;\n    reject: () => any;\n  };\n\n  constructor(ctx: Context, callback: (data: WorkerResponse) => void) {\n    this.upperCallback = callback;\n    for (let i = 0; i < ctx.nbThreads; i += 1) {\n      this.workers.push(new Worker(i, this.callback.bind(this)));\n    }\n  }\n\n  private callback(worker: Worker, data: WorkerResponse) {\n    if (data.batchId === this.batchId) this.upperCallback(data);\n    const order = this.orders.shift();\n    if (order) {\n      worker.draw(order);\n    } else {\n      if (this.workers.every(w => w.available)) this.handlers.resolve();\n    }\n  }\n\n  interrupt() {\n    this.orders = [];\n    if (this.handlers) this.handlers.reject();\n  }\n\n  async schedule(orders: DrawOrder[]) {\n    // store current draw orders, and assign one to each worker\n    this.batchId++;\n    this.orders = orders.map(o => ({ ...o, batchId: this.batchId }));\n    this.workers.forEach(worker => {\n      const order = this.orders.shift();\n      if (order) worker.draw(order);\n    });\n    // return a pending promise\n    return new Promise((resolve, reject) => {\n      this.handlers = { resolve, reject };\n    });\n  }\n}\n","import Matrix from \"./math/matrix\";\nimport { Context } from \"./engine\";\n\nexport default class Redrawer {\n  private canvas: HTMLCanvasElement;\n  private offCanvas: HTMLCanvasElement;\n  private context: CanvasRenderingContext2D;\n  private lastId: number | null = null;\n  private lastType: string | null = null;\n  private lastMatrix: Matrix | null = null;\n\n  constructor(ctx: Context) {\n    this.canvas = ctx.canvas;\n    this.context = ctx.context;\n    this.offCanvas = document.createElement(\"canvas\");\n    this.offCanvas.width = this.canvas.width;\n    this.offCanvas.height = this.canvas.height;\n  }\n\n  redraw(newMatrix: Matrix, type: string, id: number) {\n    // if type has changed, don't redraw\n    if (this.lastType !== type) this.lastMatrix = null;\n    if (this.lastId === id) return;\n    let tileSorter;\n\n    if (this.lastMatrix) {\n      // compute movement matrix\n      const m = this.lastMatrix\n        .inverse()\n        .multiply(newMatrix)\n        .inverse();\n\n      // use movement to quickly redraw last picture at new position\n      const imageData = this.context.getImageData(\n        0,\n        0,\n        this.canvas.width,\n        this.canvas.height,\n      );\n      this.offCanvas.getContext(\"2d\")!.putImageData(imageData, 0, 0);\n      this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n      this.context.transform(m.a, m.b, m.c, m.d, m.e, m.f);\n      this.context.drawImage(this.offCanvas, 0, 0);\n      this.context.setTransform(1, 0, 0, 1, 0, 0);\n\n      // use movement to infer an optimal redrawing order of tiles\n      // tiles are sorted according to their distance to the tileSorter x, y point\n      // compute invariant point\n      /* eslint-disable no-mixed-operators */\n      const x =\n        (m.c * m.f - m.d * m.e + m.e) / (m.a * m.d - m.a - m.b * m.c - m.d + 1);\n      const y =\n        (m.a * m.f - m.b * m.e - m.f) /\n        (m.a * -m.d + m.a + m.b * m.c + m.d - 1);\n      /* eslint-enable no-mixed-operators */\n\n      if (m.a > 1.001 && m.d > 1.001) {\n        tileSorter = { x, y, reverse: false };\n      } else if (m.a < 0.99 && m.d < 0.99) {\n        tileSorter = { x, y, reverse: true };\n      } else if (Math.abs(m.e) > 0.01 || Math.abs(m.f) > 0.01) {\n        tileSorter = {\n          x: this.canvas.width / 2,\n          y: this.canvas.height / 2,\n          reverse: true,\n        };\n        if (m.e < -0.01) tileSorter.x = 0;\n        if (m.e > 0.01) tileSorter.x = this.canvas.width;\n        if (m.f < -0.01) tileSorter.y = 0;\n        if (m.f > 0.01) tileSorter.y = this.canvas.height;\n      }\n    } else {\n      this.lastType = type;\n    }\n\n    this.lastId = id;\n    this.lastMatrix = newMatrix;\n    return tileSorter;\n  }\n}\n","import { FractalDef } from \"./fractals/example\";\n\n// @ts-ignore\nconst context = require.context(\"./fractals/\", true, /\\.([jt]s)$/);\n\nconst byId: { [key: string]: FractalDef } = {};\ncontext.keys().forEach((filename: string) => {\n  const obj = context(filename).default;\n  byId[obj.fractalId] = obj;\n});\n\nexport const getFunction = (id: string, smooth: boolean) => {\n  const res = byId[id];\n  if (smooth) return res.fn.smooth || res.fn.normal;\n  return res.fn.normal;\n};\n\nexport const getPreset = (fractalId: string) => {\n  const res = byId[fractalId];\n  return { fractalId, ...res.preset };\n};\n\nexport const listForUi = () =>\n  Object.values(byId)\n    .filter(f => !f.hidden)\n    .sort((a, b) => (a.uiOrder || 0) - (b.uiOrder || 0));\n","import Scheduler from \"./scheduler/scheduler\";\nimport Redrawer from \"./redrawer\";\nimport { getFunction } from \"./fractals\";\nimport Painter from \"./painter\";\nimport Main, { Context } from \"./engine\";\nimport {\n  Tile,\n  WorkerResponse,\n  Params,\n  Model,\n  DrawOrder,\n} from \"./scheduler/types\";\nimport Vector from \"./math/vector\";\n\nexport default class Renderer {\n  private readonly nbTiles: number = 100;\n  private readonly ctx: Context;\n\n  private painter: Painter;\n  private scheduler: Scheduler;\n  private redrawer: Redrawer;\n\n  private width!: number;\n  private height!: number;\n  private imageData!: ImageData;\n  private imageBuffer!: Uint32Array;\n\n  private tiles!: Tile[];\n\n  constructor(ctx: Context, painter: Painter, engine: Main) {\n    this.ctx = ctx;\n    this.resize();\n    this.callback = this.callback.bind(this);\n    this.scheduler = new Scheduler(ctx, this.callback);\n    this.painter = painter;\n    this.redrawer = new Redrawer(ctx);\n  }\n\n  resize() {\n    if (this.scheduler) this.scheduler.interrupt();\n\n    const canvas = this.ctx.canvas;\n    this.imageData = this.ctx.context.createImageData(\n      canvas.width,\n      canvas.height,\n    );\n    this.imageBuffer = new Uint32Array(this.imageData.data.buffer);\n    this.width = canvas.width;\n    this.height = canvas.height;\n\n    // compute tiling\n    const ratio = this.width / this.height;\n    const tileNbHeight = Math.round(Math.sqrt(this.nbTiles / ratio));\n    const tileNbWidth = Math.round(Math.sqrt(this.nbTiles / ratio) * ratio);\n    console.debug(\n      `Screen ${this.width}px * ${this.height}px (ratio ${ratio.toFixed(2)}),` +\n        ` ${tileNbWidth} * ${tileNbHeight} = ${tileNbHeight *\n          tileNbWidth} tiles (${this.nbTiles} asked)` +\n        `, each ~ ${Math.round(canvas.width / tileNbWidth)}px * ${Math.round(\n          this.ctx.canvas.height / tileNbHeight,\n        )}px`,\n    );\n\n    // instanciate tiles\n    this.tiles = [];\n    for (let j = 0; j < tileNbHeight; j += 1) {\n      for (let i = 0; i < tileNbWidth; i += 1) {\n        const id = this.tiles.length;\n        const x1 = Math.round((i * canvas.width) / tileNbWidth);\n        const x2 = Math.round(((i + 1) * canvas.width) / tileNbWidth) - 1;\n        const y1 = Math.round((j * canvas.height) / tileNbHeight);\n        const y2 = Math.round(((j + 1) * canvas.height) / tileNbHeight) - 1;\n        const x = (x1 + x2) / 2; // center of tile\n        const y = (y1 + y2) / 2;\n        const width = x2 - x1 + 1;\n        const height = y2 - y1 + 1;\n        const buffer = new Float32Array(width * height);\n        const indexScreen = y1 * canvas.width + x1;\n        // prettier-ignore\n        this.tiles.push({id, i, j, x1, x2, y1, y2, x, y, width, height, buffer, indexScreen});\n      }\n    }\n  }\n\n  getIterationsAt(cpx: Vector) {\n    const func = getFunction(this.ctx.fractalId, this.ctx.smooth);\n    return func(cpx.x, cpx.y, this.ctx.iter);\n  }\n\n  getHistogram(): number[] {\n    const histogram = new Array(this.ctx.iter + 1).fill(0);\n    for (const tile of this.tiles) {\n      for (let i in tile.buffer) {\n        const val = Math.round(tile.buffer[i]);\n        if (val >= 0 && val <= this.ctx.iter) histogram[val] += 1;\n      }\n    }\n    return histogram;\n  }\n\n  // redraws the current float buffer\n  drawColor() {\n    this.ctx.event.notify(\"draw.redraw\", {});\n    this.tiles.forEach(tile => {\n      this.painter.paint(tile, this.imageBuffer, this.width);\n    });\n    this.ctx.context.putImageData(\n      this.imageData,\n      0,\n      0,\n      0,\n      0,\n      this.width,\n      this.height,\n    );\n  }\n\n  // performs a full draw: floatbuffer + colors\n  draw(params: Params) {\n    this.ctx.event.notify(\"draw.start\", {});\n    this.scheduler.interrupt();\n    const redraw = this.redrawer.redraw;\n    let tileSort: ReturnType<typeof redraw>;\n    if (this.redrawer)\n      tileSort = this.redrawer.redraw(\n        this.ctx.camera.matrix,\n        this.ctx.fractalId,\n        params.id || -1,\n      );\n    const workerModel: Model = Object.assign({}, this.ctx.camera.matrix, {\n      type: this.ctx.fractalId,\n      smooth: this.ctx.smooth,\n      iter: this.ctx.iter,\n    });\n    const orders: DrawOrder[] = this.tiles.map(tile => ({\n      action: \"draw\",\n      tile,\n      params,\n      model: workerModel,\n    }));\n    // if redrawer was able to find a tile sorting, sort them\n    if (tileSort) {\n      orders.forEach(t => {\n        t.dist = Math.sqrt(\n          (t.tile.x - tileSort!.x) ** 2 + (t.tile.y - tileSort!.y) ** 2,\n        );\n      });\n      orders.sort((a, b) =>\n        // @ts-ignore\n        tileSort!.reverse ? b.dist - a.dist : a.dist - b.dist,\n      );\n    }\n    const schedulerPromise = this.scheduler.schedule(orders).catch(() => {});\n    return schedulerPromise;\n  }\n\n  callback(data: WorkerResponse) {\n    if (data.action !== \"end-draw\") throw new Error();\n    const tile = data.tile;\n    this.tiles[tile.id].buffer = tile.buffer;\n    this.painter.paint(tile, this.imageBuffer, this.width);\n    this.ctx.context.putImageData(\n      this.imageData,\n      0,\n      0,\n      tile.x1,\n      tile.y1,\n      tile.width,\n      tile.height,\n    );\n  }\n}\n","const standardGradients: { [key: number]: string } = {\n  0: \"0#080560;0.2#2969CB;0.40#F1FEFE;0.60#FCA425;0.85#000000\",\n  1: \"0.0775#78591e;0.55#d6e341\", // gold\n  2: \"0#0000FF;0.33#FFFFFF;0.66#FF0000\", // bleublancrouge\n  3: \"0.08#09353e;0.44#1fc3e6;0.77#08173e\", // night\n  4: \"0#000085;0.25#fffff5;0.5#ffb500;0.75#9c0000\", // defaultProps\n  5: \"0#000000;0.25#000000;0.5#7f7f7f;0.75#ffffff;0.975#ffffff\", // emboss\n  // flatUI palettes (http://designmodo.github.io/Flat-UI/)\n  10: \"0#000000;0.25#16A085;0.5#FFFFFF;0.75#16A085\", // green sea\n  11: \"0#000000;0.25#27AE60;0.5#FFFFFF;0.75#27AE60\", // nephritis\n  12: \"0#000000;0.25#2980B9;0.5#FFFFFF;0.75#2980B9\", // nephritis\n  13: \"0#000000;0.25#8E44AD;0.5#FFFFFF;0.75#8E44AD\", // wisteria\n  14: \"0#000000;0.25#2C3E50;0.5#FFFFFF;0.75#2C3E50\", // midnight blue\n  15: \"0#000000;0.25#F39C12;0.5#FFFFFF;0.75#F39C12\", // orange\n  16: \"0#000000;0.25#D35400;0.5#FFFFFF;0.75#D35400\", // pumpkin\n  17: \"0#000000;0.25#C0392B;0.5#FFFFFF;0.75#C0392B\", // pmoegranate\n  18: \"0#000000;0.25#BDC3C7;0.5#FFFFFF;0.75#BDC3C7\", // silver\n  19: \"0#000000;0.25#7F8C8D;0.5#FFFFFF;0.75#7F8C8D\", // asbestos\n};\n\n/*\n * Monotone cubic spline interpolation\n *     let f = createInterpolant([0, 1, 2, 3, 4], [0, 1, 4, 9, 16]);\n *     for (let x = 0; x <= 4; x += 0.1)\n *        let xSquared = f(x);\n * https://en.wikipedia.org/wiki/Monotone_cubic_interpolation\n */\nfunction createInterpolant(xs: number[], ys: number[]) {\n  let i,\n    length = xs.length;\n\n  // Deal with length issues\n  if (length !== ys.length) {\n    throw new Error(\"Need an equal count of xs and ys.\");\n  }\n  if (length === 0) {\n    return function(x: any) {\n      return 0;\n    };\n  }\n  if (length === 1) {\n    // Impl: Precomputing the result prevents problems if ys is mutated later and allows garbage collection of ys\n    // Impl: Unary plus properly converts values to numbers\n    const result = +ys[0];\n    return function(x: any) {\n      return result;\n    };\n  }\n\n  // Rearrange xs and ys so that xs is sorted\n  const indexes = [];\n  for (i = 0; i < length; i++) {\n    indexes.push(i);\n  }\n  indexes.sort((a, b) => (xs[a] < xs[b] ? -1 : 1));\n  let oldXs = xs,\n    oldYs = ys;\n  // Impl: Creating new arrays also prevents problems if the input arrays are mutated later\n  xs = [];\n  ys = [];\n  // Impl: Unary plus properly converts values to numbers\n  for (i = 0; i < length; i++) {\n    xs.push(+oldXs[indexes[i]]);\n    ys.push(+oldYs[indexes[i]]);\n  }\n\n  // Get consecutive differences and slopes\n  let dys = [],\n    dxs = [],\n    ms = [];\n  for (i = 0; i < length - 1; i++) {\n    let dx = xs[i + 1] - xs[i],\n      dy = ys[i + 1] - ys[i];\n    dxs.push(dx);\n    dys.push(dy);\n    ms.push(dy / dx);\n  }\n\n  // Get degree-1 coefficients\n  const c1s = [ms[0]];\n  for (i = 0; i < dxs.length - 1; i++) {\n    let m = ms[i],\n      mNext = ms[i + 1];\n    if (m * mNext <= 0) {\n      c1s.push(0);\n    } else {\n      let dx = dxs[i],\n        dxNext = dxs[i + 1],\n        common = dx + dxNext;\n      c1s.push((3 * common) / ((common + dxNext) / m + (common + dx) / mNext));\n    }\n  }\n  c1s.push(ms[ms.length - 1]);\n\n  // Get degree-2 and degree-3 coefficients\n  let cpx2scr: number[] = [],\n    c3s: number[] = [];\n  for (i = 0; i < c1s.length - 1; i++) {\n    let c1 = c1s[i],\n      m = ms[i],\n      invDx = 1 / dxs[i],\n      common = c1 + c1s[i + 1] - m - m;\n    cpx2scr.push((m - c1 - common) * invDx);\n    c3s.push(common * invDx * invDx);\n  }\n\n  // Return interpolant function\n  return function(x: number) {\n    // The rightmost point in the dataset should give an exact result\n    let i = xs.length - 1;\n    if (x === xs[i]) {\n      return ys[i];\n    }\n\n    // Search for the interval x is in, returning the corresponding y if x is one of the original xs\n    let low = 0,\n      mid,\n      high = c3s.length - 1;\n    while (low <= high) {\n      mid = Math.floor(0.5 * (low + high));\n      const xHere = xs[mid];\n      if (xHere < x) {\n        low = mid + 1;\n      } else if (xHere > x) {\n        high = mid - 1;\n      } else {\n        return ys[mid];\n      }\n    }\n    i = Math.max(0, high);\n\n    // Interpolate\n    let diff = x - xs[i],\n      diffSq = diff * diff;\n    return ys[i] + c1s[i] * diff + cpx2scr[i] * diffSq + c3s[i] * diff * diffSq;\n  };\n}\n\nconst buildBufferFromStringGradient = (\n  resolution: number,\n  gradient: string,\n) => {\n  const indices: number[] = [];\n  const reds: number[] = [];\n  const greens: number[] = [];\n  const blues: number[] = [];\n\n  const buildStops = (str: string) => {\n    str.split(\";\").forEach(stop => {\n      const items = stop.split(\"#\");\n      indices.push(Number(items[0]));\n      reds.push(parseInt(items[1].substring(0, 2), 16));\n      greens.push(parseInt(items[1].substring(2, 4), 16));\n      blues.push(parseInt(items[1].substring(4, 6), 16));\n    });\n  };\n\n  const buffer = new Int32Array(resolution);\n  const buildBuffer = () => {\n    // loop first stop to end\n    indices.push(indices[0] + 1);\n    reds.push(reds[0]);\n    greens.push(greens[0]);\n    blues.push(blues[0]);\n\n    const interR = createInterpolant(indices, reds);\n    const interG = createInterpolant(indices, greens);\n    const interB = createInterpolant(indices, blues);\n\n    const byteBuffer = new Uint8Array(buffer.buffer); // create an 8-bit view on the buffer\n    let bufferIndex = 0;\n    for (let i = 0; i < resolution; i += 1) {\n      let floatIndex = i / resolution;\n      if (floatIndex < indices[0]) floatIndex += 1;\n      byteBuffer[bufferIndex + 0] = interR(floatIndex);\n      byteBuffer[bufferIndex + 1] = interG(floatIndex);\n      byteBuffer[bufferIndex + 2] = interB(floatIndex);\n      byteBuffer[bufferIndex + 3] = 255;\n      bufferIndex += 4;\n    }\n  };\n\n  buildStops(gradient);\n  buildBuffer();\n  return buffer;\n};\n\nexport const getBufferFromId = (id: number, res = 400) => {\n  return buildBufferFromStringGradient(res, standardGradients[id]);\n};\n","import { Tile } from \"./scheduler/types\";\nimport { getBufferFromId } from \"../util/palette\";\n\nexport interface PainterArgs {\n  offset: number;\n  density: number;\n  id: number;\n  fn: \"s\" | \"n\";\n}\n\nexport default class Painter {\n  public id: number = 0;\n  public offset: number = 0;\n  public fn: string = \"s\";\n  public density: number = 0;\n  private resolution: number = 0;\n  private buffer: Int32Array = new Int32Array();\n\n  constructor(p: PainterArgs) {\n    this.set(p);\n  }\n\n  set(p: any) {\n    if (\"fn\" in p) this.fn = p.fn;\n    if (\"offset\" in p) this.offset = p.offset;\n    if (\"density\" in p) this.density = p.density;\n    if (\"id\" in p) {\n      this.id = p.id;\n      this.buffer = getBufferFromId(p.id, 1000);\n      this.resolution = this.buffer.length;\n    }\n  }\n\n  // this function is not pure : it modifies buffer\n  // this function need maximum speed : it uses only vars\n  paint(tile: Tile, buffer: Uint32Array, width: number) {\n    var offset = this.offset * this.resolution;\n    var density = this.density,\n      resolution = this.resolution;\n    var cbuffer = this.buffer;\n    var tileIndex = 0;\n    var bufferIndex = 0;\n    var tx, ty, iter, color;\n\n    if (this.fn === \"s\") {\n      density = density * 7;\n      offset = ((this.offset + 0.85) % 1) * this.resolution;\n    }\n\n    for (ty = 0; ty < tile.height; ty += 1) {\n      bufferIndex = (ty + tile.y1) * width + tile.x1;\n      for (tx = 0; tx < tile.width; tx += 1) {\n        iter = tile.buffer[tileIndex];\n        if (iter === 0) {\n          color = 0xff000000;\n        } else {\n          if (this.fn === \"s\") {\n            iter = Math.sqrt(iter);\n          }\n          color = cbuffer[~~((iter * density + offset) % resolution)];\n        }\n        buffer[bufferIndex] = color;\n        tileIndex += 1;\n        bufferIndex += 1;\n      }\n    }\n  }\n}\n","export default class Vector {\n  public readonly x: number;\n  public readonly y: number;\n\n  constructor(x: Vector | number, y?: number) {\n    if (x instanceof Vector) {\n      this.x = x.x;\n      this.y = x.y;\n    } else {\n      this.x = x;\n      this.y = y as number;\n    }\n  }\n\n  midPoint(v2: Vector) {\n    return new Vector((v2.x + this.x) / 2, (v2.y + this.y) / 2);\n  }\n\n  minus(v: Vector) {\n    return new Vector(this.x - v.x, this.y - v.y);\n  }\n\n  plus(v: Vector) {\n    return new Vector(this.x + v.x, this.y + v.y);\n  }\n\n  times(v: Vector | number) {\n    return v instanceof Vector\n      ? new Vector(this.x * v.x, this.y * v.y)\n      : new Vector(this.x * v, this.y * v);\n  }\n\n  minVal() {\n    return Math.min(this.x, this.y);\n  }\n}\n","import Vector from \"./vector\";\n\nexport default class Matrix {\n  public static readonly identity = new Matrix(1, 0, 0, 1, 0, 0);\n\n  constructor(\n    public readonly a: number,\n    public readonly b: number,\n    public readonly c: number,\n    public readonly d: number,\n    public readonly e: number,\n    public readonly f: number,\n  ) {}\n\n  transform(v: Vector) {\n    return new Vector(\n      v.x * this.a + v.y * this.c + this.e,\n      v.x * this.b + v.y * this.d + this.f,\n    );\n  }\n\n  isIdentity() {\n    return (\n      this.a === 1 &&\n      this.b === 0 &&\n      this.c === 0 &&\n      this.d === 1 &&\n      this.e === 0 &&\n      this.f === 0\n    );\n  }\n\n  private isInvertible() {\n    const deter = this.a * this.d - this.b * this.c;\n    return Math.abs(deter) > 1e-15;\n  }\n\n  inverse() {\n    if (!this.isInvertible()) {\n      return this.inverseGaussJordan();\n    }\n    const dt = this.a * this.d - this.b * this.c;\n    return new Matrix(\n      this.d / dt,\n      -this.b / dt,\n      -this.c / dt,\n      this.a / dt,\n      (this.c * this.f - this.d * this.e) / dt,\n      -(this.a * this.f - this.b * this.e) / dt,\n    );\n  }\n\n  multiply(o: Matrix) {\n    return new Matrix(\n      this.a * o.a + this.c * o.b,\n      this.b * o.a + this.d * o.b,\n      this.a * o.c + this.c * o.d,\n      this.b * o.c + this.d * o.d,\n      this.a * o.e + this.c * o.f + this.e,\n      this.b * o.e + this.d * o.f + this.f,\n    );\n  }\n\n  private inverseGaussJordan() {\n    function gje(M: any, c1i: any, c2i: any, f: any) {\n      const c1 = M[c1i];\n      const c2 = M[c2i];\n      for (let i = 0; i < 6; i++) {\n        c1[i] += c2[i] * f;\n      }\n    }\n\n    function gjet(M: any, c1i: any, f: any) {\n      const c1 = M[c1i];\n      for (let i = 0; i < 6; i++) {\n        c1[i] *= f;\n      }\n    }\n    const M = [\n      [this.a, this.c, this.e, 1, 0, 0],\n      [this.b, this.d, this.f, 0, 1, 0],\n      [0, 0, 1, 0, 0, 1],\n    ];\n    gje(M, 1, 2, -M[1][2]); // c2 = c2 + c3 * -f\n    gje(M, 0, 2, -M[0][2]); // c1 = c1 + c3 * -e\n    gje(M, 1, 0, -M[1][0] / M[0][0]);\n    gje(M, 0, 1, -M[0][1] / M[1][1]);\n    gjet(M, 0, 1 / M[0][0]);\n    gjet(M, 1, 1 / M[1][1]);\n    return new Matrix(M[0][3], M[1][3], M[0][4], M[1][4], M[0][5], M[1][5]);\n  }\n\n  toString() {\n    return `${this.a} ${this.c} ${this.e}\\n${this.b} ${this.d} ${this.f}\\n0 0 1`;\n  }\n\n  // prettier-ignore\n  static GetTriangleToTriangle(\n    t1px: number, t1py: number, t1qx: number, t1qy: number, t1rx: number, t1ry: number,\n    t2px: number, t2py: number, t2qx: number, t2qy: number, t2rx: number, t2ry: number\n  ) {\n    const STD2T1 = new Matrix(t1px - t1rx, t1py - t1ry, t1qx - t1rx, t1qy - t1ry, t1rx, t1ry);\n    const STD2T2 = new Matrix(t2px - t2rx, t2py - t2ry, t2qx - t2rx, t2qy - t2ry, t2rx, t2ry);\n    const T12STD = STD2T1.inverse();\n    return STD2T2.multiply(T12STD);\n  }\n\n  static GetRotationMatrix(angle: number) {\n    const cos = Math.cos(angle);\n    const sin = Math.sin(angle);\n    return new Matrix(cos, sin, -sin, cos, 0, 0);\n  }\n\n  static GetScaleMatrix(x: number, y: number) {\n    return new Matrix(x, 0, 0, y, 0, 0);\n  }\n\n  static GetShearMatrix(x: number, y: number) {\n    return new Matrix(1, y, x, 1, 0, 0);\n  }\n}\n","import Matrix from \"./matrix\";\nimport Vector from \"./vector\";\n\n// prettier-ignore\nconst getSquareToComplexMatrix = (x: number, y: number, w: number) =>\n  Matrix.GetTriangleToTriangle(\n    1, 0, 0, 1, 0, 0,\n    x + w / 2, y, x, y + w / 2, x, y);\n\nexport type Affine = \"rotation\" | \"scale\" | \"shear\";\n\nconst getScreenToSquareMatrix = (\n  affineTransform: Matrix,\n  width: number,\n  height: number,\n) => {\n  const p = affineTransform.transform(new Vector(1, -1));\n  const q = affineTransform.transform(new Vector(-1, 1));\n  const r = affineTransform.transform(new Vector(-1, -1));\n  if (width >= height) {\n    const x1 = (width - height) / 2;\n    const x2 = x1 + height;\n    // prettier-ignore\n    return Matrix.GetTriangleToTriangle(\n      x2, height, x1, 0, x1, height,\n      p.x, p.y, q.x, q.y, r.x, r.y);\n  } else {\n    const y1 = (height - width) / 2;\n    const y2 = y1 + width;\n    // prettier-ignore\n    return Matrix.GetTriangleToTriangle(\n      width, y2, 0, y1, 0, y2,\n      p.x, p.y, q.x, q.y, r.x, r.y);\n  }\n};\n\n// The camera projects view space on complex space and vice-verse.\n// The \"square\" or Q is the maximum centered square that can be inscribed in the view.\n// X and Y are the complex coordinates @ the center of the view\n// W is the complex size of the square\n// A viewport affine transformation can be applied on the square to rotate/scale/shear the view\nexport default class Camera {\n  private matrix_inv: Matrix;\n  public matrix: Matrix;\n  public affineMatrix: Matrix;\n  public screen: Vector;\n  public resolutionLimit: number;\n  public pos: Vector;\n  public w: number;\n\n  constructor(\n    screenSize: Vector,\n    pos: Vector,\n    w: number,\n    affineMatrix = Matrix.identity,\n  ) {\n    this.affineMatrix = affineMatrix;\n    this.screen = screenSize;\n    const extent = screenSize.minVal();\n    this.resolutionLimit = extent * 1.11e-15;\n    this.pos = pos;\n    this.w = w;\n    this.matrix = Matrix.identity;\n    this.matrix_inv = Matrix.identity;\n    this.reproject();\n  }\n\n  reproject() {\n    this.w = Math.max(this.w, this.resolutionLimit);\n    const S2Q = getScreenToSquareMatrix(\n      this.affineMatrix,\n      this.screen.x,\n      this.screen.y,\n    );\n    const Q2C = getSquareToComplexMatrix(this.pos.x, this.pos.y, this.w);\n    this.matrix = Q2C.multiply(S2Q);\n    this.matrix_inv = this.matrix.inverse();\n  }\n\n  affineTransform(type: Affine, valuex: number, valuey?: number) {\n    let transform = Matrix.identity;\n    switch (type) {\n      case \"rotation\":\n        transform = Matrix.GetRotationMatrix(valuex);\n        break;\n      case \"shear\":\n        transform = Matrix.GetShearMatrix(valuex, valuey!);\n        break;\n      case \"scale\":\n        transform = Matrix.GetScaleMatrix(valuex, valuey!);\n        break;\n    }\n    this.affineMatrix = this.affineMatrix.multiply(transform);\n    this.reproject();\n  }\n\n  affineReset() {\n    this.affineMatrix = Matrix.identity;\n    this.reproject();\n  }\n\n  clone() {\n    return new Camera(this.screen, this.pos, this.w, this.affineMatrix);\n  }\n\n  scr2cpx(v: Vector) {\n    return this.matrix.transform(v);\n  }\n\n  cpx2scr(v: Vector) {\n    return this.matrix_inv.transform(v);\n  }\n\n  getPos() {\n    return this.pos;\n  }\n\n  setPos(pos: Vector, w?: number) {\n    this.pos = pos;\n    if (w) this.w = w;\n    this.reproject();\n  }\n\n  resize(width: number, height: number) {\n    this.screen = new Vector(width, height);\n    const extent = Math.min(width, height); // extent of the min square\n    this.resolutionLimit = extent * 1.11e-15;\n    this.reproject();\n  }\n\n  isZoomLimit() {\n    return this.w <= this.resolutionLimit;\n  }\n}\n","/* global navigator */\nimport EventBus from \"../util/EventBus\";\nimport Renderer from \"./renderer\";\nimport Painter, { PainterArgs } from \"./painter\";\nimport Camera from \"./math/camera\";\nimport Vector from \"./math/vector\";\nimport { Params } from \"./scheduler/types\";\nimport Matrix from \"./math/matrix\";\n\nexport interface Context {\n  readonly canvas: HTMLCanvasElement;\n  readonly context: CanvasRenderingContext2D;\n  readonly event: EventBus;\n  readonly nbThreads: number;\n  readonly camera: Camera;\n  smooth: boolean;\n  iter: number;\n  fractalId: string;\n}\n\ninterface EngineInit {\n  canvas: HTMLCanvasElement;\n  x: number;\n  y: number;\n  w: number;\n  viewport?: Matrix;\n  painter: PainterArgs;\n  fractalId: string;\n  smooth: boolean;\n  iter: number;\n}\n\nexport default class Engine {\n  public readonly ctx: Context;\n  public readonly painter: Painter;\n\n  private renderer: Renderer;\n\n  constructor(p: EngineInit) {\n    let nbThreads = navigator.hardwareConcurrency || 4;\n    if (nbThreads >= 6) nbThreads--; // sacrifice a thread for responsiveness if we have enough\n    this.ctx = {\n      // readonly\n      canvas: p.canvas,\n      context: p.canvas.getContext(\"2d\") as CanvasRenderingContext2D,\n      nbThreads,\n      event: new EventBus(),\n      camera: new Camera(\n        new Vector(p.canvas.width, p.canvas.height),\n        new Vector(p.x, p.y),\n        p.w,\n        p.viewport,\n      ),\n      // changeable\n      smooth: p.smooth,\n      iter: p.iter,\n      fractalId: p.fractalId,\n    };\n    this.painter = new Painter(p.painter);\n    this.renderer = new Renderer(this.ctx, this.painter, this);\n  }\n\n  get canvas() {\n    return this.ctx.canvas;\n  }\n\n  // realtime modification of engine parameters\n  set(p: any) {\n    if (\"fractalId\" in p) this.ctx.fractalId = p.fractalId;\n    if (\"smooth\" in p) this.ctx.smooth = p.smooth;\n    if (\"iter\" in p) this.ctx.iter = p.iter;\n    if (\"x\" in p) this.ctx.camera.setPos(new Vector(p.x, p.y), p.w);\n    if (\"painter\" in p) {\n      this.painter.set(p.painter);\n    }\n  }\n\n  async draw(params?: Params) {\n    if (!params) params = { details: \"normal\" };\n    return this.renderer.draw(params);\n  }\n\n  drawColor() {\n    this.renderer.drawColor();\n  }\n\n  resize(width: number, height: number) {\n    this.ctx.camera.resize(width, height);\n    this.renderer.resize();\n  }\n\n  getHistogram() {\n    return this.renderer.getHistogram();\n  }\n\n  getIterationsAt(cpx: Vector) {\n    return this.renderer.getIterationsAt(cpx);\n  }\n}\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nconst ui = createSlice({\n  name: \"set\",\n  initialState: {\n    fractalId: \"mandelbrot\",\n    smooth: true,\n    x: 0,\n    y: 0,\n    w: 0,\n    iter: 0,\n  },\n  reducers: {\n    setSet: (state, action) => action.payload,\n    updateSet: (state, action) => ({ ...state, ...action.payload }),\n  },\n});\n\nexport const { reducer, actions } = ui;\nexport const { setSet, updateSet } = actions;\n","const map: { [key: string]: number } = {\n  left: 37,\n  up: 38,\n  right: 39,\n  down: 40,\n  \"+\": 107,\n  \"-\": 109,\n  esc: 27,\n  A: 65,\n  B: 66,\n  C: 67,\n  D: 68,\n  E: 69,\n  F: 70,\n  G: 71,\n  H: 72,\n  I: 73,\n  J: 74,\n  K: 75,\n  L: 76,\n  M: 77,\n  N: 78,\n  O: 79,\n  P: 80,\n  Q: 81,\n  R: 82,\n  S: 83,\n  T: 84,\n  U: 85,\n  V: 86,\n  W: 87,\n  X: 88,\n  Y: 89,\n  Z: 90,\n};\n\ntype Callback = (mod: number) => void;\ninterface Binding {\n  combo: number[];\n  func: Callback;\n}\n\nconst keymap: boolean[] = [];\nconst bindings: Binding[] = [];\n\ndocument.addEventListener(\"keyup\", evt => {\n  keymap[evt.keyCode] = false;\n});\n\ndocument.addEventListener(\"keydown\", evt => {\n  keymap[evt.keyCode] = true;\n  const modifier = evt.shiftKey ? 1 / 10 : 1;\n  for (const binding of bindings) {\n    const match = binding.combo.every(k => keymap[k]);\n    if (match) {\n      binding.func(modifier);\n      return;\n    }\n  }\n});\n\nexport const bindKeys = (keysStr: string, func: Callback) => {\n  const keys = keysStr.split(\" \");\n  const keycodes: number[] = [];\n  for (const key of keys) {\n    if (!(key in map)) throw new Error(`Unknown key${key}`);\n    keycodes.push(map[key]);\n  }\n  bindings.push({ combo: keycodes, func });\n  bindings.sort((a, b) => b.combo.length - a.combo.length);\n};\n","import Vector from \"../engine/math/vector\";\nimport Camera, { Affine } from \"../engine/math/camera\";\nimport { Dispatch } from \"@reduxjs/toolkit\";\nimport { changeXY } from \"./rdxengine\";\nimport Hammer from \"hammerjs\";\nimport Matrix from \"../engine/math/matrix\";\nimport { bindKeys } from \"../util/keybinder\";\nimport Engine from \"../engine/engine\";\n\nconst ZOOM = 1.3;\nconst ZOOM_TAP = 2.5;\nconst PAN = 0.1;\nconst SCALE = 0.1; // 1+\nconst SHEAR = 0.1;\nconst ANGLE = Math.PI / 18;\n\nexport default class Controller {\n  private engine: Engine;\n  private camera: Camera;\n\n  constructor(engine: Engine, private dispatch: Dispatch<any>) {\n    this.engine = engine;\n    this.camera = engine.ctx.camera;\n    this.setupKeyboard();\n    this.setupMouse();\n    this.setupTouch();\n  }\n\n  // pan the screen by the given vector (as a ratio of its size)\n  pan(scr_vector_delta: Vector) {\n    const cam = this.camera;\n    const scr_vector = cam.screen.times(scr_vector_delta);\n    const cpx_point_0 = cam.scr2cpx(new Vector(0, 0));\n    const cpx_point_dest = cam.scr2cpx(scr_vector);\n    const cpx_vector = cpx_point_0.minus(cpx_point_dest);\n    const cpx_new_point = cam.getPos().plus(cpx_vector);\n    this.dispatch(changeXY(cpx_new_point));\n  }\n\n  // transforms the current viewport\n  affineTransform(type: Affine, valuex: number, valuey?: number) {\n    this.camera.affineTransform(type, valuex, valuey);\n    this.engine.draw();\n  }\n\n  affineReset() {\n    this.camera.affineReset();\n    this.engine.draw();\n  }\n\n  // zoom the screen at the given screen point, using the given delta ratio\n  zoom(delta: number, scr_point_arg?: Vector) {\n    const cam = this.camera;\n    if (delta < 1 && cam.isZoomLimit()) {\n      this.engine.ctx.event.notify(\"zoom.limit\");\n      return;\n    }\n    // zoom @ center of screen by default\n    const scr_point = scr_point_arg || cam.screen.times(0.5);\n    const cpx_point = cam.scr2cpx(scr_point);\n    const cpx_center = cam.getPos();\n    // complex vector from point to view center\n    const cpx_vector = cpx_center.minus(cpx_point);\n    // scale vector and compute new center\n    const cpx_new_point = cpx_point.plus(cpx_vector.times(delta));\n    this.dispatch(changeXY(cpx_new_point, cam.w * delta));\n  }\n\n  setupKeyboard() {\n    bindKeys(\"up\", (Î”: number) => this.pan(new Vector(0, PAN * Î”)));\n    bindKeys(\"down\", (Î”: number) => this.pan(new Vector(0, -PAN * Î”)));\n    bindKeys(\"right\", (Î”: number) => this.pan(new Vector(-PAN * Î”, 0)));\n    bindKeys(\"left\", (Î”: number) => this.pan(new Vector(PAN * Î”, 0)));\n    bindKeys(\"+\", (Î”: number) => this.zoom(1 / (ZOOM * Î”)));\n    bindKeys(\"-\", (Î”: number) => this.zoom(ZOOM * Î”));\n    bindKeys(\"V\", () => this.affineReset());\n    bindKeys(\"R left\", (Î”: number) =>\n      this.affineTransform(\"rotation\", -ANGLE * Î”),\n    );\n    bindKeys(\"R right\", (Î”: number) =>\n      this.affineTransform(\"rotation\", +ANGLE * Î”),\n    );\n    bindKeys(\"S right\", (Î”: number) =>\n      this.affineTransform(\"scale\", 1 / (1 + SCALE * Î”), 1),\n    );\n    bindKeys(\"S left\", (Î”: number) =>\n      this.affineTransform(\"scale\", 1 + SCALE * Î”, 1),\n    );\n    bindKeys(\"S up\", (Î”: number) =>\n      this.affineTransform(\"scale\", 1, 1 / (1 + SCALE * Î”)),\n    );\n    bindKeys(\"S down\", (Î”: number) =>\n      this.affineTransform(\"scale\", 1, 1 + SCALE * Î”),\n    );\n    bindKeys(\"H right\", (Î”: number) =>\n      this.affineTransform(\"shear\", -SHEAR * Î”, 0),\n    );\n    bindKeys(\"H left\", (Î”: number) =>\n      this.affineTransform(\"shear\", SHEAR * Î”, 0),\n    );\n    bindKeys(\"H up\", (Î”: number) =>\n      this.affineTransform(\"shear\", 0, -SHEAR * Î”),\n    );\n    bindKeys(\"H down\", (Î”: number) =>\n      this.affineTransform(\"shear\", 0, SHEAR * Î”),\n    );\n  }\n\n  setupTouch() {\n    var hammer = new Hammer(this.engine.canvas, {});\n    let isDragging = false;\n    let dragStart: Vector;\n    let cameraStart: Camera;\n\n    hammer.get(\"pan\").set({\n      direction: Hammer.DIRECTION_ALL,\n      threshold: 1,\n    });\n    hammer.get(\"pinch\").set({\n      enable: true,\n    });\n\n    hammer.on(\"doubletap\", (evt) => {\n      // console.log(\"double\", evt);\n      const pos = new Vector(evt.center.x, evt.center.y);\n      this.zoom(1 / ZOOM_TAP, new Vector(pos));\n    });\n\n    hammer.on(\"panstart\", (evt) => {\n      isDragging = true;\n      dragStart = new Vector(evt.center.x, evt.center.y);\n      cameraStart = this.camera.clone();\n    });\n\n    hammer.on(\"panend\", (evt) => {\n      isDragging = false;\n    });\n\n    hammer.on(\"panmove\", (evt) => {\n      if (isDragging) {\n        const pos = new Vector(evt.center.x, evt.center.y);\n        const scr_vector = pos.minus(dragStart);\n        const cpx_point_0 = cameraStart.scr2cpx(new Vector(0, 0));\n        const cpx_point_dest = cameraStart.scr2cpx(scr_vector);\n        const cpx_vector = cpx_point_dest.minus(cpx_point_0);\n        const cpx_new = cameraStart.getPos().minus(cpx_vector);\n        this.dispatch(changeXY(cpx_new));\n      }\n    });\n\n    var isPinching = false;\n    let pinchStart: Vector;\n\n    hammer.on(\"pinchstart\", (ev) => {\n      console.log(\"pinchstart\");\n      isPinching = true;\n      pinchStart = new Vector(ev.center.x, ev.center.y);\n      cameraStart = this.camera.clone();\n    });\n\n    hammer.on(\"pinchend\", function (ev) {\n      console.log(\"pinchend\");\n      isPinching = false;\n    });\n\n    hammer.on(\"pinch\", (ev) => {\n      if (isPinching) {\n        // compute matrix that transforms an original triangle to the transformed triangle\n        var pc1 = cameraStart.scr2cpx(pinchStart);\n        var pc2 = cameraStart.scr2cpx(new Vector(ev.center.x, ev.center.y));\n        var m = Matrix.GetTriangleToTriangle(\n          pc1.x,\n          pc1.y,\n          pc1.x + 1,\n          pc1.y,\n          pc1.x,\n          pc1.y + 1,\n          pc2.x,\n          pc2.y,\n          pc2.x + ev.scale,\n          pc2.y,\n          pc2.x,\n          pc2.y + ev.scale,\n        );\n\n        // apply inverse of this matrix to starting point\n        var pc0A = m.inverse().transform(cameraStart.pos);\n\n        let z = cameraStart.w / m.a;\n        if (z < this.camera.resolutionLimit) {\n          this.engine.ctx.event.notify(\"zoom.limit\");\n          z = this.camera.resolutionLimit;\n        }\n        this.dispatch(changeXY(pc0A, z));\n      }\n    });\n  }\n\n  setupMouse() {\n    const canvas = this.engine.canvas;\n\n    // disable mouse pan because it is handled by hammer\n    // let isDragging = false;\n    // let dragStart: Vector;\n    // let cameraStart: Camera;\n\n    // canvas.addEventListener(\"mousedown\", (e: MouseEvent) => {\n    //   const evt = e || window.event;\n    //   if (evt.button !== 0) return;\n    //   isDragging = true;\n    //   dragStart = new Vector(evt.screenX, evt.screenY);\n    //   cameraStart = this.camera.clone();\n    // });\n\n    // window.addEventListener(\"mouseup\", () => {\n    //   isDragging = false;\n    // });\n\n    // window.addEventListener(\"mousemove\", e => {\n    //   const evt = e || window.event;\n    //   if (isDragging) {\n    //     console.log(\"mousemove\", e);\n    //     const pos = new Vector(evt.screenX, evt.screenY);\n    //     const scr_vector = pos.minus(dragStart);\n    //     const cpx_point_0 = cameraStart.scr2cpx(new Vector(0, 0));\n    //     const cpx_point_dest = cameraStart.scr2cpx(scr_vector);\n    //     const cpx_vector = cpx_point_dest.minus(cpx_point_0);\n    //     const cpx_new = cameraStart.getPos().minus(cpx_vector);\n    //     this.dispatch(changeXY(cpx_new));\n    //   }\n    // });\n\n    const wheelFunction = (e: WheelEvent) => {\n      const evt = e || window.event;\n      evt.preventDefault();\n      const modifier = evt.shiftKey ? 1 / 10 : 1;\n      let delta = evt.deltaY;\n      delta = delta > 0 ? ZOOM * modifier : 1 / (ZOOM * modifier);\n      const point = new Vector(evt.offsetX, evt.offsetY);\n      this.zoom(delta, point);\n    };\n\n    canvas.addEventListener(\"wheel\", wheelFunction);\n  }\n}\n","import { updateSet } from \"./set\";\nimport { Dispatch } from \"@reduxjs/toolkit\";\nimport Engine from \"../engine/engine\";\n// import sum from \"lodash/sum\";\nimport { Root } from \"./reducer\";\n// import { setColorDensity } from \"./rdxengine\";\n\n/*\nThe improver hijacks engine to use a more complex rendering; so it's\nimplemented as a function and a closure instead of a class (whose 'this'\nwould have been messy)\n*/\nexport default function Improver(\n  engineArg: Engine,\n  dispatch: Dispatch<any>,\n  getState: () => Root,\n) {\n  const engine = engineArg;\n  const draw = engine.draw.bind(engine);\n  let frameId = 0;\n  let lastState = \"\";\n\n  const sleep = (duration: number) =>\n    new Promise((resolve) => setTimeout(() => resolve(), duration));\n\n  // array contains a count per index; total of this count is 100%\n  // this function finds the range in the array that brings back perc% of the values\n  // it works by trimming smallest value from start and end until\n  // const getRangeContaining = (\n  //   array: number[],\n  //   perc: number,\n  // ): [number, number] => {\n  //   let a = 0;\n  //   let b = array.length - 1;\n  //   let count = sum(array);\n  //   const target = count * (perc / 100);\n  //   while (count >= target) {\n  //     if (array[a] < array[b]) {\n  //       count -= array[a];\n  //       a++;\n  //     } else {\n  //       count -= array[b];\n  //       b--;\n  //     }\n  //   }\n  //   return [a, b];\n  // };\n\n  // const analyseColors = (histo: number[]) => {\n  //   console.log(histo);\n  //   const [pa, pb] = getRangeContaining(histo.slice(1), 98);\n  //   console.log(pa, pb);\n  //   const range = pb - pa;\n  //   const resolution = 1000;\n  //   let density = resolution / range;\n  //   density = Math.min(20, density);\n  //   density = Math.max(0.05, density);\n  //   console.log(density);\n  //   dispatch(setColorDensity(density));\n  // };\n\n  const analysePicture = (histo: number[]) => {\n    // takes the same old algorithm\n    const iter = engine.ctx.iter;\n    const nbTotal = histo.reduce((acc, val) => acc + val, 0);\n    const nbInSet = histo[0];\n    let minIter = Number.MAX_VALUE;\n    let maxIter = -1;\n    for (let i = 1; i < histo.length; i += 1) {\n      if (histo[i] !== 0) {\n        maxIter = i;\n        minIter = Math.min(i, minIter);\n      }\n    }\n    const iterRange = maxIter - minIter;\n    const fringe10p = iter - Math.ceil(iterRange / 10);\n    let nbFringe10p = 0;\n    for (let i = fringe10p; i < histo.length; i += 1) {\n      nbFringe10p += histo[i];\n    }\n    const percInSet = (100.0 * nbInSet) / nbTotal;\n    const percFringe10p = (100.0 * nbFringe10p) / nbInSet;\n    const res = {\n      shouldIncrease: false,\n      shouldDecrease: false,\n    };\n    if (percInSet > 1 && percFringe10p > 1) {\n      res.shouldIncrease = true;\n      // console.log(\"we should increase iter\");\n    } else if (percInSet > 1 && percFringe10p > 1) {\n      res.shouldDecrease = true;\n      // console.log(\"we should decrease iter\");\n    } else {\n      // console.log(\"iter is good\");\n    }\n    return res;\n  };\n\n  // @ts-ignore\n  engine.draw = async () => {\n    // ID detects when a rendering is interrupted\n    frameId += 1;\n    const id = frameId;\n\n    // state detects when the fractal is drew afresh, needing a coarse rendering first\n    const state = engine.ctx.fractalId + engine.ctx.smooth;\n    if (state !== lastState) {\n      await draw({ details: \"subsampling\", size: 4 });\n      if (frameId !== id) return;\n    }\n    lastState = state;\n\n    // draw, then analyze, then increase iterations if needed\n    let analysis: any = {};\n    do {\n      await draw({ details: \"normal\", id });\n      if (frameId !== id) return;\n      const histogram = engine.getHistogram();\n      // analyseColors(histogram);\n      analysis = analysePicture(histogram);\n      if (analysis.shouldIncrease) {\n        const iter = engine.ctx.iter;\n        dispatch(updateSet({ iter: iter * 1.5 }));\n        engine.ctx.iter = Math.round(iter * 1.5);\n      }\n    } while (analysis.shouldIncrease);\n\n    // wait one sec, then supersample\n    await sleep(1000);\n    if (frameId !== id) return;\n    await draw({ details: \"supersampling\", size: 4, id });\n  };\n}\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nconst ui = createSlice({\n  name: \"colors\",\n  initialState: {\n    offset: 0,\n    id: 0,\n    density: 20, // 0.05 - 20\n    fn: \"s\",\n  },\n  reducers: {\n    setColorId: (state, action) => ({ ...state, id: action.payload }),\n    setOffset: (state, action) => ({ ...state, offset: action.payload }),\n    setDensity: (state, action) => ({ ...state, density: action.payload }),\n    setPaint: (state, action) => ({ ...state, ...action.payload }),\n  },\n});\n\nexport const { reducer, actions } = ui;\nexport const { setOffset, setColorId, setDensity, setPaint } = actions;\n","import Matrix from \"../engine/math/matrix\";\nimport { Dispatch } from \"@reduxjs/toolkit\";\nimport { setOffset, setDensity, setColorId } from \"./colors\";\nimport { setSet } from \"./set\";\nimport omit from \"lodash/omit\";\nimport { getPreset } from \"../engine/fractals\";\nimport Engine from \"../engine/engine\";\nimport { PainterArgs } from \"../engine/painter\";\n\ninterface UrlOutputObject {\n  painter: PainterArgs;\n  desc: {\n    x: number;\n    y: number;\n    w: number;\n    iter: number;\n    fractalId: string;\n    smooth: boolean;\n    viewport: Matrix;\n  };\n}\n\nconst defaults: any = {\n  t: \"mandelbrot\",\n  i: \"50\",\n  fs: \"1\",\n  ct: \"0\",\n  co: \"0\",\n  cd: \"20\",\n  cf: \"n\",\n  va: \"1.0000\",\n  vb: \"0.0000\",\n  vc: \"0.0000\",\n  vd: \"1.0000\",\n};\n\nexport const update = (engine: Engine) => {\n  const camera = engine.ctx.camera;\n  const painter = engine.painter;\n  try {\n    const args: any = {};\n    // engine\n    args.t = engine.ctx.fractalId;\n    args.x = camera.pos.x;\n    args.y = camera.pos.y;\n    args.w = camera.w;\n    args.i = String(engine.ctx.iter);\n    args.fs = engine.ctx.smooth ? \"1\" : \"0\";\n    // painter\n    args.ct = String(painter.id);\n    args.co = String(Math.round(painter.offset * 100));\n    args.cd = String(+painter.density.toFixed(2));\n    args.cf = painter.fn;\n    // affine matrix\n    args.va = camera.affineMatrix.a.toFixed(4);\n    args.vb = camera.affineMatrix.b.toFixed(4);\n    args.vc = camera.affineMatrix.c.toFixed(4);\n    args.vd = camera.affineMatrix.d.toFixed(4);\n    // remove args with default values\n    for (let key in args) if (args[key] === defaults[key]) delete args[key];\n    // build url\n    const str = Object.entries(args)\n      .map(([k, v]) => `${k}_${v}`)\n      .join(\"&\");\n    window.history.replaceState(\"\", \"\", `#B${str}`);\n  } catch (e) {\n    console.error(\"Could not set URL\", e);\n  }\n};\n\nfunction readCurrentScheme(url: string): UrlOutputObject {\n  // parse url\n  const str = url.substr(2);\n  const rawArgs: any = str.split(\"&\").reduce((acc, tuple) => {\n    const parts = tuple.split(\"_\");\n    return Object.assign(acc, { [parts[0]]: parts[1] });\n  }, {});\n  // add default arguments\n  const args = { ...defaults, ...rawArgs };\n  // build objet\n  const desc = {\n    x: parseFloat(args.x),\n    y: parseFloat(args.y),\n    w: parseFloat(args.w),\n    iter: parseInt(args.i),\n    fractalId: args.t,\n    smooth: parseInt(args.fs) === 1,\n    viewport: Matrix.identity,\n  };\n  desc.viewport = new Matrix(\n    parseFloat(args.va),\n    parseFloat(args.vb),\n    parseFloat(args.vc),\n    parseFloat(args.vd),\n    0,\n    0,\n  );\n  const painter = {\n    offset: parseInt(args.co) / 100.0,\n    density: parseFloat(args.cd),\n    id: parseInt(args.ct, 10),\n    fn: args.cf,\n  };\n  return { desc, painter };\n}\n\nexport const read = (): UrlOutputObject | null => {\n  try {\n    const url = document.location.hash;\n    if (url.startsWith(\"#B\")) {\n      return readCurrentScheme(url);\n    }\n  } catch (e) {\n    console.error(\"Could not read URL\", e);\n  }\n  return null;\n};\n\nexport const readInit = (\n  dispatch: Dispatch<any>,\n  forceCold = false,\n): UrlOutputObject => {\n  const urlData = read();\n  if (!urlData || forceCold) {\n    // coldstart\n    let desc = {\n      ...getPreset(\"mandelbrot\"),\n      smooth: true,\n      viewport: Matrix.identity,\n    };\n    let painter: PainterArgs = {\n      offset: 0,\n      density: 20,\n      id: 0,\n      fn: \"s\",\n    };\n    dispatch(setSet(omit(desc, \"viewport\")));\n    dispatch(setColorId(painter.id));\n    dispatch(setOffset(0));\n    dispatch(setDensity(20));\n    return { desc, painter };\n  } else {\n    const { desc, painter } = urlData;\n    dispatch(setSet(omit(urlData.desc, \"viewport\")));\n    dispatch(setColorId(painter.id));\n    dispatch(setOffset(painter.offset));\n    dispatch(setDensity(painter.density));\n    return {\n      desc,\n      painter,\n    };\n  }\n};\n","import { createSlice } from \"@reduxjs/toolkit\";\n\ntype Tab = \"settings\" | \"fractal\" | \"palette\" | \"about\" | \"social\" | \"debug\";\ninterface Int {\n  drawer: boolean;\n  infobox: boolean;\n  mouseOnCanvas: boolean;\n  narrowDevice: boolean; // less than 450 px\n  tab: Tab;\n  snack?: string;\n  mouse: {\n    x: number;\n    y: number;\n    iter: number;\n  };\n}\n\nconst ui = createSlice({\n  name: \"ui\",\n  initialState: {\n    drawer: false,\n    mouseOnCanvas: false,\n    tab: \"fractal\",\n    infobox: false,\n    mouse: { x: 0, y: 0, iter: 0 },\n    narrowDevice: false,\n    orientableDevice: false,\n  } as Int,\n  reducers: {\n    setDrawer: (state, action) => ({ ...state, drawer: action.payload }),\n    setTab: (state, action) => ({ ...state, tab: action.payload }),\n    setInfobox: (state, action) => ({ ...state, infobox: action.payload }),\n    setMouseOnCanvas: (state, action) => ({\n      ...state,\n      mouseOnCanvas: action.payload,\n    }),\n    setMouseInfo: (state, action) => ({ ...state, mouse: action.payload }),\n    setNarrowDevice: (state, action) => ({\n      ...state,\n      narrowDevice: action.payload,\n    }),\n    setSnack: (state, action) => ({ ...state, snack: action.payload }),\n  },\n});\n\nexport const { reducer, actions } = ui;\nexport const {\n  setDrawer,\n  setTab,\n  setInfobox,\n  setMouseOnCanvas,\n  setMouseInfo,\n  setSnack,\n  setNarrowDevice,\n} = actions;\n","import { Dispatch } from \"@reduxjs/toolkit\";\nimport { Root } from \"./reducer\";\nimport Engine from \"../engine/engine\";\nimport { updateSet } from \"./set\";\nimport Controller from \"./controller\";\nimport Improver from \"./improver\";\nimport * as url from \"./url\";\nimport throttle from \"lodash/throttle\";\nimport debounce from \"lodash/debounce\";\nimport Vector from \"../engine/math/vector\";\nimport {\n  setMouseOnCanvas,\n  setMouseInfo,\n  setInfobox,\n  setDrawer,\n  setSnack,\n  setNarrowDevice,\n  setTab,\n} from \"./ui\";\nimport * as colorActions from \"./colors\";\nimport { getPreset } from \"../engine/fractals\";\nimport { bindKeys } from \"../util/keybinder\";\n\nlet engine: Engine;\n\nexport const getEngine = () => engine;\n\nexport const initEngine = (canvas: HTMLCanvasElement): any => async (\n  dispatch: Dispatch<any>,\n  getState: () => Root,\n) => {\n  // ---- init global keyboard shortcuts\n  bindKeys(\"I\", () => dispatch(setInfobox(!getState().ui.infobox)));\n  bindKeys(\"esc\", () => dispatch(setDrawer(!getState().ui.drawer)));\n  bindKeys(\"D\", () => {\n    dispatch(setDrawer(true));\n    dispatch(setTab(\"debug\"));\n  });\n\n  // ---- init window size & capture resize events\n  const getWindowSize = () => [window.innerWidth, window.innerHeight];\n  [canvas.width, canvas.height] = getWindowSize();\n  window.addEventListener(\"resize\", () => {\n    [canvas.width, canvas.height] = getWindowSize();\n    engine.resize(canvas.width, canvas.height);\n    engine.draw();\n  });\n\n  // ---- update ui.smallDevice boolean when device (or orientation) changes\n  const onMediaChange = (media: any) =>\n    dispatch(setNarrowDevice(media.matches));\n  const matchMedia = window.matchMedia(\"(max-width: 450px)\");\n  onMediaChange(matchMedia);\n  matchMedia.addListener(onMediaChange);\n\n  window.addEventListener(\n    \"error\",\n    debounce(() => {\n      console.error(\"error caught, resetting engine\");\n      const init = url.readInit(dispatch, true);\n      engine.set({ ...init });\n      engine.draw();\n    }, 200),\n  );\n\n  // ---- capture canvas enter & leave events for infobox\n  canvas.addEventListener(\"mouseenter\", () => {\n    dispatch(setMouseOnCanvas(true));\n  });\n  canvas.addEventListener(\"mouseleave\", () => {\n    dispatch(setMouseOnCanvas(false));\n  });\n  canvas.addEventListener(\n    \"mousemove\",\n    throttle(evt => {\n      const cpx = engine.ctx.camera.scr2cpx(\n        new Vector(evt.offsetX, evt.offsetY),\n      );\n      const iter = engine.getIterationsAt(cpx);\n      dispatch(setMouseInfo({ x: cpx.x, y: cpx.y, iter }));\n    }, 50), // 20 fps max\n  );\n\n  // ---- read URL and infer start params\n  const { desc, painter } = url.readInit(dispatch);\n  engine = new Engine({ ...desc, painter, canvas });\n  // @ts-ignore\n  window.engine = engine;\n\n  const urlUpdate = debounce(() => {\n    url.update(engine);\n  }, 250);\n  engine.ctx.event.on(\"draw.start\", urlUpdate);\n  engine.ctx.event.on(\"draw.redraw\", urlUpdate);\n  engine.ctx.event.on(\"zoom.limit\", () => {\n    dispatch(setSnack(\"Sorry, FractalJS cannot zoom further...\"));\n  });\n  engine.ctx.event.on(\n    \"zoom.limit\",\n    debounce(() => {\n      dispatch(setSnack(undefined));\n    }, 5000),\n  );\n\n  new Controller(engine, dispatch);\n  Improver(engine, dispatch, getState); // add improvement capabilities\n  engine.draw();\n};\n\nexport const changeFractalType = (type: string): any => async (\n  dispatch: Dispatch<any>,\n  getState: () => Root,\n) => {\n  const setValues = getPreset(type);\n  dispatch(updateSet(setValues));\n  engine.ctx.camera.affineReset();\n  dispatch(colorActions.setPaint({ density: 20 }));\n  engine.painter.set({ density: 20 });\n  engine.set(setValues);\n  engine.draw();\n};\n\nexport const changeSmooth = (smooth: boolean): any => async (\n  dispatch: Dispatch<any>,\n  getState: () => Root,\n) => {\n  dispatch(updateSet({ smooth }));\n  engine.set({ smooth });\n  engine.draw();\n};\n\nexport const changeXY = (pt: Vector, w?: number): any => async (\n  dispatch: Dispatch<any>,\n) => {\n  if (w === undefined) {\n    dispatch(updateSet({ x: pt.x, y: pt.y }));\n    engine.ctx.camera.setPos(pt);\n  } else {\n    dispatch(updateSet({ x: pt.x, y: pt.y, w }));\n    engine.ctx.camera.setPos(pt, w);\n  }\n  engine.draw();\n};\n\nexport const setColorOffset = (val: number): any => async (\n  dispatch: Dispatch<any>,\n) => {\n  dispatch(colorActions.setOffset(val));\n  engine.painter.set({ offset: val });\n  engine.drawColor();\n};\n\nexport const setColorDensity = (val: number): any => async (\n  dispatch: Dispatch<any>,\n  getState: () => Root,\n) => {\n  dispatch(colorActions.setDensity(val));\n  engine.painter.set({ density: getState().colors.density });\n  engine.drawColor();\n};\n\nexport const setColorId = (id: number): any => async (\n  dispatch: Dispatch<any>,\n  getState: () => Root,\n) => {\n  dispatch(colorActions.setPaint({ id, fn: \"s\" }));\n  engine.painter.set({ id, fn: \"s\" });\n  engine.drawColor();\n};\n","import React from \"react\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { changeFractalType } from \"../../redux/rdxengine\";\nimport { Root } from \"../../redux/reducer\";\nimport { listForUi } from \"../../engine/fractals\";\n\nfunction Fractal() {\n  const dispatch = useDispatch();\n  const type = useSelector((state: Root) => state.set.fractalId);\n\n  const buttons = listForUi().map((o) => {\n    return (\n      <ListItem\n        key={o.fractalId}\n        button\n        onClick={() => dispatch(changeFractalType(o.fractalId))}\n        selected={type === o.fractalId}\n      >\n        <ListItemText primary={o.name} />\n      </ListItem>\n    );\n  });\n  return (\n    <div>\n      <List\n        component=\"nav\"\n        subheader={\n          <ListSubheader component=\"div\">Pick a fractal set</ListSubheader>\n        }\n      >\n        {buttons}\n      </List>\n    </div>\n  );\n}\n\nexport default Fractal;\n","import React from \"react\";\nimport throttle from \"lodash/throttle\";\nimport Slider from \"@material-ui/core/Slider\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Root } from \"../../redux/reducer\";\nimport {\n  setColorOffset,\n  setColorDensity,\n  setColorId,\n} from \"../../redux/rdxengine\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { getBufferFromId } from \"../../util/palette\";\nimport { Typography } from \"@material-ui/core\";\n\nconst DENSITY = (20 * 20) ** (1 / 100);\n\nconst gradients = (() => {\n  const res: { id: number; dataURL: string }[] = [];\n  const WIDTH = 100;\n  const HEIGHT = 50;\n  const RES = WIDTH;\n  const canvas = document.createElement(\"canvas\") as HTMLCanvasElement;\n  const context = canvas.getContext(\"2d\") as CanvasRenderingContext2D;\n  canvas.width = WIDTH;\n  canvas.height = HEIGHT;\n  const imageData = context.createImageData(canvas.width, canvas.height);\n  const imageBuffer = new Uint32Array(imageData.data.buffer);\n  [0, 2, 3, 4, 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19].forEach((id) => {\n    const colorBuffer = getBufferFromId(id, RES);\n    for (let i = 0; i < WIDTH; i += 1) {\n      for (let j = 0; j < HEIGHT; j += 1) {\n        imageBuffer[j * WIDTH + i] =\n          colorBuffer[Math.round(i * 0.6 + j * 0.6) % RES];\n      }\n    }\n    context.putImageData(imageData, 0, 0, 0, 0, canvas.width, canvas.height);\n    const dataURL = canvas.toDataURL(\"image/png\");\n    res.push({ id, dataURL });\n  });\n  return res;\n})();\n\nconst useStyles = makeStyles((theme) => ({\n  swatches: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    marginRight: -theme.spacing(1),\n    \"& > *\": {\n      paddingBottom: theme.spacing(1),\n      paddingRight: theme.spacing(1),\n      width: \"20%\",\n      height: \"56px\",\n      position: \"relative\",\n      \"& > img\": {\n        width: \"100%\",\n        height: \"100%\",\n        borderRadius: \"4px\",\n      },\n      \"& > i\": {\n        position: \"absolute\",\n        bottom: 0,\n        right: 0,\n        color: \"white\",\n        fontSize: \"36px\",\n        padding: \"0px\",\n        textShadow: \"2px 2px 2px #888\",\n      },\n    },\n  },\n  txt: {\n    width: \"100px\",\n  },\n}));\n\nfunction Palette() {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const colors = useSelector((state: Root) => state.colors);\n  const swatches = gradients.map((gradient) => (\n    <div key={gradient.id} onClick={() => dispatch(setColorId(gradient.id))}>\n      <img alt=\"\" src={gradient.dataURL} />\n      {colors.id === gradient.id ? (\n        <i className=\"material-icons\">check_circle</i>\n      ) : null}\n    </div>\n  ));\n\n  const densitySlider = Math.log(20 * colors.density) / Math.log(DENSITY);\n  const getDensity = (val: number) => (1 / 20) * DENSITY ** val;\n\n  return (\n    <div>\n      <List component=\"nav\" dense>\n        <ListSubheader component=\"div\">\n          Pick & adjust a color palette\n        </ListSubheader>\n        <ListItem>\n          <div className={classes.swatches}>{swatches}</div>\n        </ListItem>\n        <ListItem>\n          <Typography className={classes.txt}>Move</Typography>\n          <Slider\n            min={0}\n            max={1}\n            step={0.001}\n            value={colors.offset}\n            onChange={throttle((_, v) => dispatch(setColorOffset(v)), 100)}\n          />\n        </ListItem>\n        <ListItem>\n          <Typography className={classes.txt}>Stretch</Typography>\n          <Slider\n            min={0}\n            max={100}\n            step={1}\n            value={densitySlider}\n            onChange={throttle(\n              (_, v) => dispatch(setColorDensity(getDensity(v))),\n              100,\n            )}\n          />\n        </ListItem>\n      </List>\n    </div>\n  );\n}\n\nexport default Palette;\n","import React from \"react\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\";\nimport Switch from \"@material-ui/core/Switch\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { changeSmooth } from \"../../redux/rdxengine\";\nimport { Root } from \"../../redux/reducer\";\nimport { setInfobox } from \"../../redux/ui\";\n\nfunction Settings() {\n  const dispatch = useDispatch();\n  const smooth = useSelector((state: Root) => state.set.smooth);\n  const ui = useSelector((state: Root) => state.ui);\n\n  return (\n    <div>\n      <List\n        component=\"nav\"\n        subheader={\n          <ListSubheader component=\"div\">Advanced settings</ListSubheader>\n        }\n      >\n        <ListItem>\n          <ListItemText primary=\"Smooth rendering\" />\n          <ListItemSecondaryAction>\n            <Switch\n              edge=\"end\"\n              onChange={(event) => {\n                dispatch(changeSmooth(event.target.checked));\n              }}\n              checked={smooth}\n              color=\"primary\"\n            />\n          </ListItemSecondaryAction>\n        </ListItem>\n        {ui.narrowDevice ? null : (\n          <ListItem>\n            <ListItemText primary=\"Information box\" />\n            <ListItemSecondaryAction>\n              <Switch\n                edge=\"end\"\n                onChange={(event) => {\n                  dispatch(setInfobox(event.target.checked));\n                }}\n                checked={ui.infobox}\n                color=\"primary\"\n              />\n            </ListItemSecondaryAction>\n          </ListItem>\n        )}\n      </List>\n    </div>\n  );\n}\n\nexport default Settings;\n","export const isMobileDevice = () =>\n  typeof window.orientation !== \"undefined\" ||\n  navigator.userAgent.indexOf(\"IEMobile\") !== -1;\n\nexport const isTouchDevice = () =>\n  \"ontouchstart\" in window ||\n  navigator.maxTouchPoints > 0 ||\n  navigator.msMaxTouchPoints > 0;\n\nexport const isMouseDevice = () =>\n  matchMedia(\"(pointer:fine)\").matches || matchMedia(\"(hover:hover)\").matches;\n","import React from \"react\";\nimport { Typography } from \"@material-ui/core\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport { Divider } from \"@material-ui/core\";\nimport GitHubButton from \"react-github-btn\";\nimport { isMobileDevice, isTouchDevice, isMouseDevice } from \"../../util/misc\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    avatar: {\n      backgroundColor: theme.palette.primary.main,\n    },\n    inline: {\n      display: \"inline\",\n    },\n    key: {\n      display: \"inline-block\",\n      verticalAlign: \"middle\",\n      border: \"1px solid #888\",\n      background: \"#EEE\",\n      borderRadius: \"4px\",\n      padding: \"1px 4px\",\n      margin: \"2px 0px\",\n      fontSize: \"13px\",\n      minWidth: \"1.8em\",\n      textAlign: \"center\",\n      color: \"black\",\n    },\n  }),\n);\n\nconst Keys = () => {\n  const classes = useStyles();\n  return (\n    <small>\n      <span className={classes.key}>&#x2190;</span>{\" \"}\n      <span className={classes.key}>&#x2191;</span>{\" \"}\n      <span className={classes.key}>&#x2192;</span>{\" \"}\n      <span className={classes.key}>&#x2193;</span> ,{\" \"}\n      <span className={classes.key}>+</span>{\" \"}\n      <span className={classes.key}>-</span>\n      <br />\n      (+ <span className={classes.key}>S</span>{\" \"}\n      <span className={classes.key}>H</span>{\" \"}\n      <span className={classes.key}>R</span>,{\" \"}\n      <span className={classes.key}>V</span> )\n      <br />\n      (+ <span className={classes.key}>shift</span> )\n    </small>\n  );\n};\n\nconst Speech = () => {\n  const classes = useStyles();\n  return (\n    <Typography\n      component=\"span\"\n      variant=\"body1\"\n      className={classes.inline}\n      color=\"textPrimary\"\n    >\n      FractalJS is open-source. You can report bugs, or add you favorite fractal\n      set by heading to{\" \"}\n      <a\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        href=\"https://github.com/solendil/fractaljs/\"\n      >\n        GitHub\n      </a>\n      .\n    </Typography>\n  );\n};\n\nexport default function SimpleCard() {\n  const classes = useStyles();\n\n  return (\n    <>\n      <List component=\"nav\" style={{ maxWidth: `360px` }}>\n        <ListSubheader component=\"div\">Controls</ListSubheader>\n        {isTouchDevice() ? (\n          <ListItem>\n            <ListItemAvatar>\n              <Avatar className={classes.avatar}>\n                <i className=\"material-icons\">touch_app</i>\n              </Avatar>\n            </ListItemAvatar>\n            <ListItemText primary=\"Touch\" secondary=\"Swipe & Pinch to zoom\" />\n          </ListItem>\n        ) : null}\n        {isMouseDevice() ? (\n          <ListItem>\n            <ListItemAvatar>\n              <Avatar className={classes.avatar}>\n                <i className=\"material-icons\">mouse</i>\n              </Avatar>\n            </ListItemAvatar>\n            <ListItemText primary=\"Mouse\" secondary=\"Drag & wheel zoom\" />\n          </ListItem>\n        ) : null}\n        {!isMobileDevice() ? (\n          <ListItem>\n            <ListItemAvatar>\n              <Avatar className={classes.avatar}>\n                <i className=\"material-icons\">keyboard</i>\n              </Avatar>\n            </ListItemAvatar>\n            <ListItemText primary=\"Keyboard\" secondary={<Keys />} />\n          </ListItem>\n        ) : null}\n        <Divider />\n        <ListSubheader component=\"div\">About</ListSubheader>\n        <ListItem>\n          <Speech />\n        </ListItem>\n        <ListItem>\n          <GitHubButton\n            href=\"https://github.com/solendil/fractaljs\"\n            data-color-scheme=\"no-preference: light; light: light; dark: light;\"\n            data-size=\"large\"\n            data-show-count={true}\n            aria-label=\"Star solendil/fractaljs on GitHub\"\n          >\n            Star\n          </GitHubButton>{\" \"}\n        </ListItem>\n      </List>\n    </>\n  );\n}\n\n// const useStyles = makeStyles({\n//   bullet: {\n//     display: \"inline-block\",\n//     margin: \"0 2px\",\n//     transform: \"scale(0.8)\",\n//   },\n//   pos: {\n//     marginBottom: 12,\n//   },\n// });\n\n// export default function SimpleCard() {\n//   const classes = useStyles();\n//   const bull = <span className={classes.bullet}>â€¢</span>;\n\n//   return (\n//     // <Card>\n//     <CardContent>\n//       <Typography color=\"textSecondary\" gutterBottom>\n//         Word of the Day\n//       </Typography>\n//     </CardContent>\n//     // {/* </Card> */}\n//   );\n// }\n\n// function About() {\n//   return (\n//     <div style={{}}>\n//       <Typography component=\"div\">\n//         FractalJS is open-source. You can report bugs, or add you favorite\n//         fractal set by heading to{\" \"}\n//         <a target=\"_blank\" href=\"https://github.com/solendil/fractaljs/\">\n//           GitHub\n//         </a>\n//       </Typography>\n//     </div>\n//   );\n// }\n\n// export default About;\n","import React from \"react\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport { getEngine } from \"../../redux/rdxengine\";\n\nexport default function Debug() {\n  const engine = getEngine();\n  const camera = engine.ctx.camera;\n  return (\n    <div>\n      <List component=\"nav\">\n        <ListSubheader component=\"div\">Debug</ListSubheader>\n        <ListItem>Threads: {engine.ctx.nbThreads}</ListItem>\n        <ListItem>\n          Screen: {camera.screen.x} * {camera.screen.y}\n        </ListItem>\n      </List>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { IconButton } from \"@material-ui/core\";\n\ninterface Props {\n  className: string;\n}\n\n// hack typescript which does not know this property\ninterface ShareNavigator {\n  share: (props: any) => Promise<any>;\n}\n\nconst Share = (props: Props) => {\n  const nav = (navigator as unknown) as ShareNavigator;\n  if (!nav.share) return null;\n  return (\n    <IconButton\n      className={props.className}\n      onClick={() => {\n        nav.share({\n          title: \"FractalJS\",\n          text: \"Check out this fractal picture !\",\n          url: window.location.href,\n        });\n      }}\n    >\n      <i className=\"material-icons\">share</i>\n    </IconButton>\n  );\n};\n\nexport default Share;\n","import React from \"react\";\nimport map from \"lodash/map\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { navigation } from \"./Navigation\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport { useDispatch } from \"react-redux\";\nimport { setTab, setDrawer } from \"../redux/ui\";\nimport { fade } from \"@material-ui/core/styles/colorManipulator\";\nimport Share from \"./Share\";\n\nconst useStyles = makeStyles((theme) => ({\n  bar: {\n    backgroundColor: fade(theme.palette.primary.main, 0.8),\n    backdropFilter: \"blur(8px)\",\n    position: \"fixed\",\n    display: \"flex\",\n    [theme.breakpoints.only(\"xs\")]: {\n      width: \"100%\",\n      height: \"56px\",\n      bottom: 0,\n    },\n    [theme.breakpoints.up(\"sm\")]: {\n      height: \"100%\",\n      flexDirection: \"column\",\n      left: 0,\n      flexWrap: \"wrap-reverse\",\n    },\n  },\n  icons: {\n    color: \"white\",\n    [theme.breakpoints.only(\"xs\")]: {\n      width: \"64px\",\n    },\n    [theme.breakpoints.up(\"sm\")]: {\n      width: \"56px\",\n    },\n  },\n  brand: {\n    [theme.breakpoints.only(\"xs\")]: {\n      display: \"none\",\n    },\n    color: \"white\",\n    fontSize: \"20px\",\n    lineHeight: \"56px\",\n    writingMode: \"vertical-rl\",\n    transform: \"rotate(180deg)\",\n    fontFamily: \"roboto\",\n    paddingBottom: \"56px\",\n    paddingTop: \"0.5em\",\n    letterSpacing: \"3px\",\n    fontWeight: 500,\n    flexGrow: 1,\n    textDecoration: \"none\",\n  },\n}));\n\nconst ToolBar = () => {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const buttons = map(navigation, (def, tabId) =>\n    !def.hidden ? (\n      <IconButton\n        key={tabId}\n        className={classes.icons}\n        onClick={() => {\n          dispatch(setTab(tabId));\n          dispatch(setDrawer(true));\n        }}\n      >\n        <i className=\"material-icons\">{def.icon}</i>\n      </IconButton>\n    ) : null,\n  ).filter(Boolean);\n  buttons.push(\n    <a\n      href=\"https://github.com/solendil/FractalJS\"\n      target=\"_\"\n      className={classes.brand}\n      key=\"brand\"\n    >\n      FractalJS\n    </a>,\n  );\n  buttons.splice(2, 0, <Share key=\"share\" className={classes.icons} />);\n\n  return <div className={classes.bar}>{buttons}</div>;\n};\n\nexport default ToolBar;\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport SwipeableDrawer from \"@material-ui/core/SwipeableDrawer\";\nimport useMediaQuery from \"@material-ui/core/useMediaQuery\";\nimport Fractal from \"./pages/Fractal\";\nimport Palette from \"./pages/Palette\";\nimport Settings from \"./pages/Settings\";\nimport About from \"./pages/About\";\nimport Debug from \"./pages/Debug\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Root } from \"../redux/reducer\";\nimport { setDrawer } from \"../redux/ui\";\nimport Divider from \"@material-ui/core/Divider\";\nimport MyToolbar from \"./Toolbar\";\n\nexport const navigation: { [key: string]: any } = {\n  fractal: { icon: \"home\", component: <Fractal /> },\n  palette: { icon: \"invert_colors\", component: <Palette /> },\n  // social: { icon: \"share\", component: <Social /> },\n  settings: { icon: \"settings\", component: <Settings /> },\n  about: { icon: \"info_outline\", component: <About /> },\n  debug: { hidden: true, component: <Debug /> },\n};\n\nconst useStyles = makeStyles((theme) => ({\n  appBar: {\n    top: \"auto\",\n    bottom: 0,\n  },\n  drawer: {\n    minWidth: \"360px\",\n    [theme.breakpoints.up(\"sm\")]: {\n      width: \"360px\",\n    },\n  },\n  trans: {\n    // if we wanna make a transparent background\n    // backgroundColor: \"rgb(255, 255, 255, 0.85)\",\n    // backdropFilter: \"blur(5px)\",\n    [theme.breakpoints.only(\"xs\")]: {\n      borderTopLeftRadius: \"10px\",\n      borderTopRightRadius: \"10px\",\n    },\n  },\n  handle: {\n    width: \"33%\",\n    margin: \"4px auto -2px auto\",\n    height: \"4px\",\n  },\n}));\n\nconst Navigation = () => {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const { drawer, tab } = useSelector((state: Root) => ({\n    drawer: state.ui.drawer,\n    tab: state.ui.tab,\n  }));\n  const bigDevice = useMediaQuery(\"(min-width:450px)\");\n  const content = navigation[tab || \"fractal\"].component;\n\n  return (\n    <>\n      <MyToolbar />\n      <SwipeableDrawer\n        anchor={bigDevice ? \"left\" : \"bottom\"}\n        open={drawer}\n        disableDiscovery\n        disableSwipeToOpen\n        PaperProps={{ className: classes.trans }}\n        BackdropProps={{ invisible: true }}\n        onClose={() => dispatch(setDrawer(false))}\n        onOpen={() => dispatch(setDrawer(true))}\n      >\n        <div className={classes.drawer}>\n          {!bigDevice ? <Divider className={classes.handle} /> : null}\n          {content}\n        </div>\n      </SwipeableDrawer>\n    </>\n  );\n};\n\nexport default Navigation;\n","import React from \"react\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Box from \"@material-ui/core/Box\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Typography } from \"@material-ui/core\";\nimport { useSelector } from \"react-redux\";\nimport { Root } from \"../redux/reducer\";\n\nconst useStyles = makeStyles((theme) => ({\n  box: {\n    position: \"fixed\",\n    bottom: 0,\n    right: 0,\n    margin: \"16px\",\n    background: \"white\",\n    padding: \"16px\",\n  },\n}));\n\nfunction InfoBox() {\n  const classes = useStyles();\n  const set = useSelector((state: Root) => state.set);\n  const ui = useSelector((state: Root) => state.ui);\n  if (ui.narrowDevice) return null;\n  if (!ui.infobox) return null;\n  const d: any = {};\n  if (ui.mouseOnCanvas) {\n    d.x = ui.mouse.x;\n    d.y = ui.mouse.y;\n    d.iter = ui.mouse.iter;\n    d.w = set.w;\n  } else {\n    d.x = set.x;\n    d.y = set.y;\n    d.iter = set.iter;\n    d.w = set.w;\n  }\n  return (\n    <Paper elevation={3} className={classes.box}>\n      <Typography color=\"primary\" gutterBottom variant=\"h6\">\n        {ui.mouseOnCanvas ? \"Mouse\" : \"Screen\"}\n      </Typography>\n      <Typography component=\"div\">\n        <Box fontFamily=\"Monospace\">X: {d.x.toFixed(16)}</Box>\n        <Box fontFamily=\"Monospace\">Y: {d.y.toFixed(16)}</Box>\n        <Box fontFamily=\"Monospace\">iterations: {d.iter.toFixed(2)}</Box>\n        <Box fontFamily=\"Monospace\">extent: {d.w.toExponential(2)}</Box>\n      </Typography>\n    </Paper>\n  );\n}\n\nexport default InfoBox;\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Root } from \"../redux/reducer\";\nimport { makeStyles } from \"@material-ui/core\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\n\nconst useStyles = makeStyles((theme) => ({\n  snackbar: {\n    [theme.breakpoints.only(\"xs\")]: {\n      bottom: 64,\n    },\n  },\n}));\n\nconst MySnackbar = () => {\n  const ui = useSelector((state: Root) => state.ui);\n  const classes = useStyles();\n  if (!ui.snack) return null;\n\n  return (\n    <Snackbar\n      open={true}\n      className={classes.snackbar}\n      message=\"Sorry, FractalJS cannot zoom further...\"\n    ></Snackbar>\n  );\n};\n\nexport default MySnackbar;\n","import React, { useRef } from \"react\";\nimport \"./App.scss\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Root } from \"../redux/reducer\";\nimport Navigation from \"./Navigation\";\nimport useMediaQuery from \"@material-ui/core/useMediaQuery\";\nimport { initEngine } from \"../redux/rdxengine\";\nimport InfoBox from \"./InfoBox\";\nimport Snackbar from \"./Snackbar\";\n\nconst App = () => {\n  const dispatch = useDispatch();\n  const ref = useRef(null);\n  const ui = useSelector((state: Root) => state.ui);\n  const bigDevice = useMediaQuery(\"(min-width:450px)\");\n\n  React.useEffect(() => {\n    const canvas = (ref.current as unknown) as HTMLCanvasElement;\n    dispatch(initEngine(canvas));\n  }, [dispatch]);\n\n  let canvasClass = \"\";\n  if (ui.drawer)\n    canvasClass = bigDevice ? \"offset-left\" : `offset-top-${ui.tab}`;\n\n  return (\n    <div>\n      <canvas ref={ref} className={canvasClass}></canvas>\n      <Navigation />\n      <InfoBox />\n      <Snackbar />\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { combineReducers } from \"@reduxjs/toolkit\";\nimport { reducer as ui } from \"./ui\";\nimport { reducer as set } from \"./set\";\nimport { reducer as colors } from \"./colors\";\n\nconst root = combineReducers({\n  ui,\n  set,\n  colors,\n});\n\nexport default root;\nexport type Root = ReturnType<typeof root>;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./ui/App\";\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { configureStore } from \"@reduxjs/toolkit\";\nimport reducer from \"./redux/reducer\";\nimport { Provider } from \"react-redux\";\nimport { createMuiTheme } from \"@material-ui/core/styles\";\n\nconst store = configureStore({ reducer });\n\nconst theme = createMuiTheme({\n  palette: {\n    // type: \"dark\",\n  },\n  breakpoints: {\n    values: {\n      xs: 0,\n      sm: 450, // 'sm' value at 450 (ie mobile portrait width) is our only real point\n      md: 960,\n      lg: 1280,\n      xl: 1920,\n    },\n  },\n});\n\nReactDOM.render(\n  <Provider store={store}>\n    <ThemeProvider theme={theme}>\n      <App />\n    </ThemeProvider>\n  </Provider>,\n  document.getElementById(\"root\"),\n);\n\nserviceWorker.register();\n"],"sourceRoot":""}