(this.webpackJsonpfratcaljs=this.webpackJsonpfratcaljs||[]).push([[0],{120:function(e,t,a){e.exports=function(){return new Worker(a.p+"520087e4063d59e7b0e5.worker.js")}},137:function(e,t,a){e.exports=a(260)},142:function(e,t,a){},148:function(e,t,a){var r={"./burningbird.ts":149,"./burningship.ts":150,"./example.ts":151,"./julia.ts":152,"./mandelbrot.ts":153,"./mandelbrot3.ts":154,"./mandelbrot4.ts":155,"./phoenix.ts":156,"./tippetts.ts":157};function n(e){var t=s(e);return a(t)}function s(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=s,e.exports=n,n.id=148},149:function(e,t,a){"use strict";a.r(t);var r=1/Math.log(2);t.default={fractalId:"burningbird",uiOrder:2.5,name:"Burning Bird",preset:{x:-.46,y:.07,w:3.26,iter:50},fn:{normal:(e,t,a)=>{var r,n=0,s=0,i=0,o=0,c=0;for(t=-t;r=(n+n)*s+t,n=i-o+e,s=Math.abs(r),!(++c>=a)&&!((i=n*n)+(o=s*s)>4););return c},smooth:(e,t,a)=>{var n,s,i=0,o=0,c=0,l=0,h=0;for(t=-t;s=(i+i)*o+t,i=c-l+e,o=Math.abs(s),!(++h>=a)&&!((c=i*i)+(l=o*o)>4););if(h===a)return h;for(n=0;n<4;++n)s=(i+i)*o+t,c=(i=c-l+e)*i,l=(o=Math.abs(s))*o;return 5+h-Math.log(Math.log(c+l))*r}}}},150:function(e,t,a){"use strict";a.r(t);var r=1/Math.log(2);t.default={fractalId:"burningship",uiOrder:2,name:"Burning Ship",preset:{x:-.4,y:.55,w:3,iter:50},fn:{normal:(e,t,a)=>{var r,n,s=0,i=0,o=0,c=0,l=0;for(t=-t;n=(s+s)*i+t,r=o-c+e,s=Math.abs(r),i=Math.abs(n),!(++l>=a)&&!((o=s*s)+(c=i*i)>4););return l},smooth:(e,t,a)=>{var n,s,i,o=0,c=0,l=0,h=0,d=0;for(t=-t;i=(o+o)*c+t,s=l-h+e,o=Math.abs(s),c=Math.abs(i),!(++d>=a)&&!((l=o*o)+(h=c*c)>4););if(d===a)return d;for(n=0;n<4;++n)i=(o+o)*c+t,s=l-h+e,l=(o=Math.abs(s))*o,h=(c=Math.abs(i))*c;return 5+d-Math.log(Math.log(l+h))*r}}}},151:function(e,t,a){"use strict";a.r(t),t.default={fractalId:"example",hidden:!0,uiOrder:-1,name:"example",preset:{x:-.7,y:0,w:2.5,iter:50},fn:{normal:(e,t,a)=>0,smooth:(e,t,a)=>0}}},152:function(e,t,a){"use strict";a.r(t);const r=1/Math.log(2);t.default={fractalId:"juliaex1",uiOrder:5,name:"Julia",preset:{x:0,y:0,w:2.2,iter:50},fn:{normal:function(e,t,a){for(var r=e,n=t,s=e*e,i=t*t,o=0;o<a&&s+i<=4;++o)n=(r+r)*n+.01,s=(r=s-i+.285)*r,i=n*n;return o},smooth:function(e,t,a){for(var n=e,s=t,i=e*e,o=t*t,c=0,l=0;c<a&&i+o<=4;++c)s=(n+n)*s+.01,i=(n=i-o+.285)*n,o=s*s;if(c===a)return c;for(l=0;l<4;++l)s=(n+n)*s+.01,i=(n=i-o+.285)*n,o=s*s;return 5+c-Math.log(Math.log(i+o))*r}}}},153:function(e,t,a){"use strict";a.r(t);var r=1/Math.log(2);t.default={fractalId:"mandelbrot",uiOrder:0,name:"Mandelbrot",preset:{x:-.7,y:0,w:2.5,iter:50},fn:{normal:(e,t,a)=>{for(var r=0,n=0,s=0,i=0,o=0;o<a&&s+i<=4;++o)n=(r+r)*n+t,s=(r=s-i+e)*r,i=n*n;return o},smooth:(e,t,a)=>{for(var n=0,s=0,i=0,o=0,c=0,l=0;c<a&&i+o<=4;++c)s=(n+n)*s+t,i=(n=i-o+e)*n,o=s*s;if(c===a)return c;for(l=0;l<4;++l)s=(n+n)*s+t,i=(n=i-o+e)*n,o=s*s;return 5+c-Math.log(Math.log(i+o))*r}}}},154:function(e,t,a){"use strict";a.r(t);var r=1/Math.log(4);t.default={fractalId:"mandelbrot3",uiOrder:3,name:"Multibrot *3",preset:{x:0,y:0,w:3,iter:50},fn:{normal:(e,t,a)=>{for(var r=0,n=0,s=0,i=0,o=0;r=s*r-3*r*i+e,n=3*s*n-i*n+t,!(++o>=a)&&!((s=r*r)+(i=n*n)>4););return o},smooth:(e,t,a)=>{for(var n,s,i=0,o=0,c=0,l=0,h=0;i=c*i-3*i*l+e,o=s=3*c*o-l*o+t,!(++h>=a)&&!((c=i*i)+(l=o*o)>4););if(h===a)return h;for(n=0;n<4;++n)s=3*c*o-l*o+t,c=(i=c*i-3*i*l+e)*i,l=(o=s)*o;return 5+h-Math.log(Math.log(c+l))*r}}}},155:function(e,t,a){"use strict";a.r(t);var r=1/Math.log(4);t.default={fractalId:"mandelbrot4",uiOrder:4,name:"Multibrot *4",preset:{x:0,y:0,w:3,iter:50},fn:{normal:(e,t,a)=>{for(var r,n=0,s=0,i=0,o=0,c=0;r=4*i*n*s-4*n*o*s+t,n=i*i-6*i*o+o*o+e,s=r,!(++c>=a)&&!((i=n*n)+(o=s*s)>4););return c},smooth:(e,t,a)=>{for(var n,s=0,i=0,o=0,c=0,l=0;n=4*o*s*i-4*s*c*i+t,s=o*o-6*o*c+c*c+e,i=n,!(++l>=a)&&!((o=s*s)+(c=i*i)>4););return l===a?l:5+l-Math.log(Math.log(o+c))*r}}}},156:function(e,t,a){"use strict";a.r(t);var r=1/Math.log(2);t.default={fractalId:"phoenixex1",uiOrder:6,name:"Phoenix",preset:{x:-.7,y:-.05,w:1.6,iter:250},fn:{normal:function(e,t,a){for(var r,n,s=-t,i=e,o=0,c=0,l=0,h=0,d=0;d<a&&l+h<=4;++d)l=(r=s*s-i*i+.5667+-.5*o)*r,h=(n=2*s*i+-.5*c)*n,o=s,c=i,s=r,i=n;return d},smooth:function(e,t,a){for(var n,s,i=-t,o=e,c=0,l=0,h=0,d=0,u=0;u<a&&h+d<=4;++u)h=(n=i*i-o*o+.5667+-.5*c)*n,d=(s=2*i*o+-.5*l)*s,c=i,l=o,i=n,o=s;if(u===a)return u;for(var m=0;m<4;++m)h=(n=i*i-o*o+.5667+-.5*c)*n,d=(s=2*i*o+-.5*l)*s,c=i,l=o,i=n,o=s;return 5+u-Math.log(Math.log(i*i+o*o))*r}}}},157:function(e,t,a){"use strict";a.r(t);t.default={fractalId:"tippetts",uiOrder:1,name:"Tippetts",preset:{x:-.5,y:0,w:4,iter:50},fn:{normal:(e,t,a)=>{for(var r=0,n=0,s=0,i=0,o=0;o<a&&s+i<=4;++o)s=(r=s-i+e)*r,i=(n=(r+r)*n+t)*n;return o}}}},260:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(11),i=a.n(s),o=(a(142),a(7)),c=a(291),l=a(304),h=a(301),d=a(294),u=a(312),m=a(295),f=a(23),p=a.n(f),w=a(31),v=a(6),x=a(74);class b{constructor(){this.listeners=void 0,this.listeners={}}on(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}notify(e,t){setTimeout(()=>{const a=this.listeners[e]||[];t&&(t.evt=e),a.forEach(e=>{e(t)})},0)}}var g=a(36),y=a(120),E=a.n(y);class k{constructor(e,t){this.id=void 0,this.available=!0,this.tile=void 0,this.worker=void 0,this.callback=void 0,this.id=e,this.createWebWorker(),this.callback=t}createWebWorker(){this.worker=new E.a,this.worker.postMessage({action:"init",id:this.id}),this.worker.onmessage=this.onmessage.bind(this)}cancel(){if(this.available)throw new Error("Canceling an available worker");this.worker.terminate(),this.createWebWorker(),this.tile.buffer=new Float32Array(this.tile.width*this.tile.height),this.available=!0}draw(e){if(!this.available)throw new Error("Worker already busy");this.tile=e.tile,this.available=!1,this.worker.postMessage(e,[e.tile.buffer.buffer])}onmessage(e){const t=e.data;this.tile.buffer=t.tile.buffer,this.available=!0,this.callback(this,t)}}var F=a(121),O=a.n(F);class M{constructor(e,t){this.scheduleId=0,this.orders=[],this.workers=[],this.upperCallback=void 0,this.handlers=void 0,this.upperCallback=t;for(let a=0;a<e.nbThreads;a+=1){const e=this.onWorkerResponse.bind(this);this.workers.push(new k(a,e))}this.throttledSchedule=O.a.throttle(this.throttledSchedule.bind(this),200)}onWorkerResponse(e,t){t.scheduleId===this.scheduleId&&this.upperCallback(t);const a=this.orders.shift();a&&e.draw(a),this.isWorking||this.handlers.accept()}get availableWorkers(){return this.workers.filter(e=>e.available)}get busyWorkers(){return this.workers.filter(e=>!e.available)}get isWorking(){return this.orders.length||this.busyWorkers.length}throttledSchedule(e){this.orders=e.map(e=>Object(v.a)({},e,{scheduleId:this.scheduleId})),this.busyWorkers.forEach(e=>e.cancel()),this.availableWorkers.forEach(e=>{const t=this.orders.shift();t&&e.draw(t)})}schedule(e){var t=this;return Object(w.a)(p.a.mark((function a(){return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.scheduleId++,t.isWorking&&(t.orders=[],t.handlers&&t.handlers.reject("Scheduler interrupted")),t.throttledSchedule(e),a.abrupt("return",new Promise((e,a)=>{t.handlers={accept:e,reject:a}}));case 4:case"end":return a.stop()}}),a)})))()}}class j{constructor(e){this.canvas=void 0,this.offCanvas=void 0,this.context=void 0,this.lastId=null,this.lastType=null,this.lastMatrix=null,this.canvas=e.canvas,this.context=e.context,this.offCanvas=document.createElement("canvas"),this.offCanvas.width=this.canvas.width,this.offCanvas.height=this.canvas.height}redraw(e,t,a){if(this.lastType!==t&&(this.lastMatrix=null),this.lastId===a)return;let r;if(this.lastMatrix){const t=this.lastMatrix.inverse().multiply(e).inverse(),a=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);this.offCanvas.getContext("2d").putImageData(a,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f),this.context.drawImage(this.offCanvas,0,0),this.context.setTransform(1,0,0,1,0,0);const n=(t.c*t.f-t.d*t.e+t.e)/(t.a*t.d-t.a-t.b*t.c-t.d+1),s=(t.a*t.f-t.b*t.e-t.f)/(t.a*-t.d+t.a+t.b*t.c+t.d-1);t.a>1.001&&t.d>1.001?r={x:n,y:s,reverse:!1}:t.a<.99&&t.d<.99?r={x:n,y:s,reverse:!0}:(Math.abs(t.e)>.01||Math.abs(t.f)>.01)&&(r={x:this.canvas.width/2,y:this.canvas.height/2,reverse:!0},t.e<-.01&&(r.x=0),t.e>.01&&(r.x=this.canvas.width),t.f<-.01&&(r.y=0),t.f>.01&&(r.y=this.canvas.height))}else this.lastType=t;return this.lastId=a,this.lastMatrix=e,r}}const I=a(148),S={};I.keys().forEach(e=>{const t=I(e).default;S[t.fractalId]=t});const T=e=>{const t=S[e];return Object(v.a)({fractalId:e},t.preset)},C=Object(v.a)({},{nbTiles:100,supersampling:!0},{},{});let N=0;class D{constructor(e,t,a,r){this.id=void 0,this.x1=void 0,this.x2=void 0,this.y1=void 0,this.y2=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.buffer=void 0,this.id=N++,this.x1=e,this.x2=t,this.y1=a,this.y2=r,this.x=(e+t)/2,this.y=(a+r)/2,this.width=t-e+1,this.height=r-a+1,this.buffer=new Float32Array(this.width*this.height)}static getTiling(e,t){const a=C.nbTiles,r=e/t,n=Math.round(Math.sqrt(a/r)),s=Math.round(Math.sqrt(a/r)*r);console.log("Tiling [".concat(e," x ").concat(t,"] with ").concat(a," tiles --\x3e "),"[".concat(s," * ").concat(n,"] = ").concat(n*s," tiles of "),"~ [".concat(Math.round(e/s)," x ").concat(Math.round(t/n),"]"));const i=[];for(let o=0;o<n;o+=1)for(let a=0;a<s;a+=1){const r=Math.round(a*e/s),c=Math.round((a+1)*e/s)-1,l=Math.round(o*t/n),h=Math.round((o+1)*t/n)-1;i.push(new D(r,c,l,h))}return i}}class P{constructor(e,t,a){this.ctx=void 0,this.painter=void 0,this.scheduler=void 0,this.redrawer=void 0,this.width=void 0,this.height=void 0,this.imageData=void 0,this.imageBuffer=void 0,this.tiles=void 0,this.ctx=e,this.resize(),this.callback=this.callback.bind(this),this.scheduler=new M(e,this.callback),this.painter=t,this.redrawer=new j(e)}resize(){const e=this.ctx.canvas;this.imageData=this.ctx.context.createImageData(e.width,e.height),this.imageBuffer=new Uint32Array(this.imageData.data.buffer),this.width=e.width,this.height=e.height,this.tiles=D.getTiling(this.width,this.height)}getIterationsAt(e){return((e,t)=>{const a=S[e];return t&&a.fn.smooth||a.fn.normal})(this.ctx.fractalId,this.ctx.smooth)(e.x,e.y,this.ctx.iter)}getHistogram(){const e=new Array(this.ctx.iter+1).fill(0);var t,a=Object(g.a)(this.tiles);try{for(a.s();!(t=a.n()).done;){const a=t.value;for(let t in a.buffer){const r=Math.round(a.buffer[t]);r>=0&&r<=this.ctx.iter&&(e[r]+=1)}}}catch(r){a.e(r)}finally{a.f()}return e}drawColor(){this.ctx.event.notify("draw.redraw",{}),this.tiles.forEach(e=>{this.painter.paint(e,this.imageBuffer,this.width)}),this.ctx.context.putImageData(this.imageData,0,0,0,0,this.width,this.height)}draw(e){this.ctx.event.notify("draw.start",{});this.redrawer.redraw;let t;this.redrawer&&(t=this.redrawer.redraw(this.ctx.camera.matrix,this.ctx.fractalId,e.id||-1));const a=Object.assign({},this.ctx.camera.matrix,{type:this.ctx.fractalId,smooth:this.ctx.smooth,iter:this.ctx.iter}),r=this.tiles.map(t=>({action:"draw",tile:t,params:e,model:a}));return t&&(r.forEach(e=>{e.dist=Math.sqrt(Math.pow(e.tile.x-t.x,2)+Math.pow(e.tile.y-t.y,2))}),r.sort((e,a)=>t.reverse?a.dist-e.dist:e.dist-a.dist)),this.scheduler.schedule(r)}callback(e){if("end-draw"!==e.action)throw new Error;const t=e.tile;this.painter.paint(t,this.imageBuffer,this.width),this.ctx.context.putImageData(this.imageData,0,0,t.x1,t.y1,t.width,t.height)}}const W={0:"0#080560;0.2#2969CB;0.40#F1FEFE;0.60#FCA425;0.85#000000",1:"0.0775#78591e;0.55#d6e341",2:"0#0000FF;0.33#FFFFFF;0.66#FF0000",3:"0.08#09353e;0.44#1fc3e6;0.77#08173e",4:"0#000085;0.25#fffff5;0.5#ffb500;0.75#9c0000",5:"0#000000;0.25#000000;0.5#7f7f7f;0.75#ffffff;0.975#ffffff",10:"0#000000;0.25#16A085;0.5#FFFFFF;0.75#16A085",11:"0#000000;0.25#27AE60;0.5#FFFFFF;0.75#27AE60",12:"0#000000;0.25#2980B9;0.5#FFFFFF;0.75#2980B9",13:"0#000000;0.25#8E44AD;0.5#FFFFFF;0.75#8E44AD",14:"0#000000;0.25#2C3E50;0.5#FFFFFF;0.75#2C3E50",15:"0#000000;0.25#F39C12;0.5#FFFFFF;0.75#F39C12",16:"0#000000;0.25#D35400;0.5#FFFFFF;0.75#D35400",17:"0#000000;0.25#C0392B;0.5#FFFFFF;0.75#C0392B",18:"0#000000;0.25#BDC3C7;0.5#FFFFFF;0.75#BDC3C7",19:"0#000000;0.25#7F8C8D;0.5#FFFFFF;0.75#7F8C8D"};function R(e,t){let a,r=e.length;if(r!==t.length)throw new Error("Need an equal count of xs and ys.");if(0===r)return function(e){return 0};if(1===r){const e=+t[0];return function(t){return e}}const n=[];for(a=0;a<r;a++)n.push(a);n.sort((t,a)=>e[t]<e[a]?-1:1);let s=e,i=t;for(e=[],t=[],a=0;a<r;a++)e.push(+s[n[a]]),t.push(+i[n[a]]);let o=[],c=[],l=[];for(a=0;a<r-1;a++){let r=e[a+1]-e[a],n=t[a+1]-t[a];c.push(r),o.push(n),l.push(n/r)}const h=[l[0]];for(a=0;a<c.length-1;a++){let e=l[a],t=l[a+1];if(e*t<=0)h.push(0);else{let r=c[a],n=c[a+1],s=r+n;h.push(3*s/((s+n)/e+(s+r)/t))}}h.push(l[l.length-1]);let d=[],u=[];for(a=0;a<h.length-1;a++){let e=h[a],t=l[a],r=1/c[a],n=e+h[a+1]-t-t;d.push((t-e-n)*r),u.push(n*r*r)}return function(a){let r=e.length-1;if(a===e[r])return t[r];let n,s=0,i=u.length-1;for(;s<=i;){n=Math.floor(.5*(s+i));const r=e[n];if(r<a)s=n+1;else{if(!(r>a))return t[n];i=n-1}}r=Math.max(0,i);let o=a-e[r],c=o*o;return t[r]+h[r]*o+d[r]*c+u[r]*o*c}}const A=(e,t=400)=>((e,t)=>{const a=[],r=[],n=[],s=[],i=new Int32Array(e);return t.split(";").forEach(e=>{const t=e.split("#");a.push(Number(t[0])),r.push(parseInt(t[1].substring(0,2),16)),n.push(parseInt(t[1].substring(2,4),16)),s.push(parseInt(t[1].substring(4,6),16))}),(()=>{a.push(a[0]+1),r.push(r[0]),n.push(n[0]),s.push(s[0]);const t=R(a,r),o=R(a,n),c=R(a,s),l=new Uint8Array(i.buffer);let h=0;for(let r=0;r<e;r+=1){let n=r/e;n<a[0]&&(n+=1),l[h+0]=t(n),l[h+1]=o(n),l[h+2]=c(n),l[h+3]=255,h+=4}})(),i})(t,W[e]);class L{constructor(e){this.id=NaN,this.offset=0,this.fn="s",this.density=0,this.resolution=0,this.buffer=new Int32Array,this.set(e)}set(e){"fn"in e&&(this.fn=e.fn),"offset"in e&&(this.offset=e.offset),"density"in e&&(this.density=e.density),this.id!==e.id&&(this.id=e.id,this.buffer=A(e.id,1e3),this.resolution=this.buffer.length)}paint(e,t,a){var r,n,s,i,o=this.offset*this.resolution,c=this.density,l=this.resolution,h=this.buffer,d=0,u=0;for("s"===this.fn&&(c*=7,o=(this.offset+.85)%1*this.resolution),n=0;n<e.height;n+=1)for(u=(n+e.y1)*a+e.x1,r=0;r<e.width;r+=1)0===(s=e.buffer[d])?i=4278190080:("s"===this.fn&&(s=Math.sqrt(s)),i=h[~~((s*c+o)%l)]),t[u]=i,d+=1,u+=1}}class z{constructor(e,t){this.x=void 0,this.y=void 0,e instanceof z?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}midPoint(e){return new z((e.x+this.x)/2,(e.y+this.y)/2)}minus(e){return new z(this.x-e.x,this.y-e.y)}plus(e){return new z(this.x+e.x,this.y+e.y)}distanceTo(e){const t=this.x-e.x,a=this.y-e.y;return Math.sqrt(t*t+a*a)}times(e){return e instanceof z?new z(this.x*e.x,this.y*e.y):new z(this.x*e,this.y*e)}minVal(){return Math.min(this.x,this.y)}}class B{constructor(e,t,a,r,n,s){this.a=e,this.b=t,this.c=a,this.d=r,this.e=n,this.f=s}static fromRaw(e){return new B(e.a,e.b,e.c,e.d,e.e,e.f)}transform(e){return new z(e.x*this.a+e.y*this.c+this.e,e.x*this.b+e.y*this.d+this.f)}isIdentity(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f}isInvertible(){const e=this.a*this.d-this.b*this.c;return Math.abs(e)>1e-15}inverse(){if(!this.isInvertible())return this.inverseGaussJordan();const e=this.a*this.d-this.b*this.c;return new B(this.d/e,-this.b/e,-this.c/e,this.a/e,(this.c*this.f-this.d*this.e)/e,-(this.a*this.f-this.b*this.e)/e)}multiply(e){return new B(this.a*e.a+this.c*e.b,this.b*e.a+this.d*e.b,this.a*e.c+this.c*e.d,this.b*e.c+this.d*e.d,this.a*e.e+this.c*e.f+this.e,this.b*e.e+this.d*e.f+this.f)}inverseGaussJordan(){function e(e,t,a,r){const n=e[t],s=e[a];for(let i=0;i<6;i++)n[i]+=s[i]*r}function t(e,t,a){const r=e[t];for(let n=0;n<6;n++)r[n]*=a}const a=[[this.a,this.c,this.e,1,0,0],[this.b,this.d,this.f,0,1,0],[0,0,1,0,0,1]];return e(a,1,2,-a[1][2]),e(a,0,2,-a[0][2]),e(a,1,0,-a[1][0]/a[0][0]),e(a,0,1,-a[0][1]/a[1][1]),t(a,0,1/a[0][0]),t(a,1,1/a[1][1]),new B(a[0][3],a[1][3],a[0][4],a[1][4],a[0][5],a[1][5])}toString(){return"".concat(this.a," ").concat(this.c," ").concat(this.e,"\n").concat(this.b," ").concat(this.d," ").concat(this.f,"\n0 0 1")}static GetTriangleToTriangle(e,t,a,r,n,s,i,o,c,l,h,d){const u=new B(e-n,t-s,a-n,r-s,n,s),m=new B(i-h,o-d,c-h,l-d,h,d),f=u.inverse();return m.multiply(f)}static GetRotationMatrix(e){const t=Math.cos(e),a=Math.sin(e);return new B(t,a,-a,t,0,0)}static GetScaleMatrix(e,t){return new B(e,0,0,t,0,0)}static GetShearMatrix(e,t){return new B(1,t,e,1,0,0)}}B.identity=new B(1,0,0,1,0,0);class G{constructor(e,t,a,r=B.identity){this.matrix_inv=void 0,this.matrix=void 0,this.viewportMatrix=void 0,this.screen=void 0,this.resolutionLimit=void 0,this.pos=void 0,this.w=void 0,this.viewportMatrix=r,this.screen=e;const n=e.minVal();this.resolutionLimit=7e-16*n,this.pos=t,this.w=a,this.matrix=B.identity,this.matrix_inv=B.identity,this.reproject()}reproject(){this.w=Math.max(this.w,this.resolutionLimit);const e=((e,t,a)=>{const r=e.transform(new z(1,-1)),n=e.transform(new z(-1,1)),s=e.transform(new z(-1,-1));if(t>=a){const e=(t-a)/2,i=e+a;return B.GetTriangleToTriangle(i,a,e,0,e,a,r.x,r.y,n.x,n.y,s.x,s.y)}{const e=(a-t)/2,i=e+t;return B.GetTriangleToTriangle(t,i,0,e,0,i,r.x,r.y,n.x,n.y,s.x,s.y)}})(this.viewportMatrix,this.screen.x,this.screen.y),t=(a=this.pos.x,r=this.pos.y,n=this.w,B.GetTriangleToTriangle(1,0,0,1,0,0,a+n/2,r,a,r+n/2,a,r));var a,r,n;this.matrix=t.multiply(e),this.matrix_inv=this.matrix.inverse()}clone(){return new G(this.screen,this.pos,this.w,this.viewportMatrix)}scr2cpx(e){return this.matrix.transform(e)}cpx2scr(e){return this.matrix_inv.transform(e)}getPos(){return this.pos}setPos(e,t){this.pos=e,t&&(this.w=t)}resize(e,t){this.screen=new z(e,t);const a=Math.min(e,t);this.resolutionLimit=7e-16*a,this.reproject()}isZoomLimit(){return this.w<=this.resolutionLimit}}class U{constructor(e,t){this.ctx=void 0,this.painter=void 0,this.renderer=void 0,this.paramsFetcher=void 0,this.paramsFetcher=t;const a=t();let r=navigator.hardwareConcurrency||4;r>=6&&r--,this.ctx={canvas:e,context:e.getContext("2d"),nbThreads:r,event:new b,camera:new G(new z(e.width,e.height),new z(a.x,a.y),a.w,B.fromRaw(a.viewport)),smooth:a.smooth,iter:a.iter,fractalId:a.fractalId},this.painter=new L(a.painter),this.renderer=new P(this.ctx,this.painter,this)}get canvas(){return this.ctx.canvas}fetchParams(){const e=this.paramsFetcher();this.ctx.fractalId=e.fractalId,this.ctx.smooth=e.smooth,this.ctx.iter=e.iter,this.painter.set({offset:e.painter.offset,density:e.painter.density,id:e.painter.id,fn:e.painter.fn});const t=this.ctx.camera;t.setPos(new z(e.x,e.y),e.w),t.viewportMatrix=B.fromRaw(e.viewport),t.reproject()}draw(e){var t=this;return Object(w.a)(p.a.mark((function a(){var r,n,s,i;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.fetchParams(),e||(e={details:"normal"}),r=(new Date).getTime(),a.next=5,t.renderer.draw(e);case 5:return n=a.sent,s=(new Date).getTime(),i=s-r,console.log("Frame '".concat(e.details,"' drawn in ").concat(i,"ms")),a.abrupt("return",n);case 10:case"end":return a.stop()}}),a)})))()}drawColor(){this.fetchParams(),this.renderer.drawColor()}resize(e,t){this.ctx.camera.resize(e,t),this.renderer.resize()}getHistogram(){return this.renderer.getHistogram()}getIterationsAt(e){return this.renderer.getIterationsAt(e)}}var H=a(20);const _=Object(H.b)({name:"set",initialState:{fractalId:"mandelbrot",smooth:!0,x:0,y:0,w:0,iter:0,viewport:{a:1,b:0,c:0,d:1,e:0,f:0}},reducers:{setSet:(e,t)=>t.payload,updateSet:(e,t)=>Object(v.a)({},e,{},t.payload)}}),q=_.reducer,J=_.actions,Y=J.setSet,K=J.updateSet;var V=a(87),X=a.n(V);const Z={left:37,up:38,right:39,down:40,"+":107,"-":109,esc:27,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90},Q=[],$=[];document.addEventListener("keyup",e=>{Q[e.keyCode]=!1}),document.addEventListener("keydown",e=>{Q[e.keyCode]=!0;const t=e.shiftKey?.1:1;var a,r=Object(g.a)($);try{for(r.s();!(a=r.n()).done;){const e=a.value;if(e.combo.every(e=>Q[e]))return void e.func(t)}}catch(n){r.e(n)}finally{r.f()}});const ee=(e,t)=>{const a=e.split(" "),r=[];var n,s=Object(g.a)(a);try{for(s.s();!(n=s.n()).done;){const e=n.value;if(!(e in Z))throw new Error("Unknown key".concat(e));r.push(Z[e])}}catch(i){s.e(i)}finally{s.f()}$.push({combo:r,func:t}),$.sort((e,t)=>t.combo.length-e.combo.length)},te=Math.PI/18;class ae{constructor(e,t){this.dispatch=t,this.engine=void 0,this.camera=void 0,this.engine=e,this.camera=e.ctx.camera,this.setupKeyboard(),this.setupMouse(),this.setupTouch()}pan(e){const t=this.camera,a=t.screen.times(e),r=t.scr2cpx(new z(0,0)),n=t.scr2cpx(a),s=r.minus(n),i=t.getPos().plus(s);this.dispatch(ze(i))}viewportTransform(e,t,a){this.dispatch(Ue(e,t,a))}zoom(e,t){const a=this.camera;if(e<1&&a.isZoomLimit())return void this.engine.ctx.event.notify("zoom.limit");const r=t||a.screen.times(.5),n=a.scr2cpx(r),s=a.getPos().minus(n),i=n.plus(s.times(e));this.dispatch(ze(i,a.w*e))}setupKeyboard(){ee("up",e=>this.pan(new z(0,.1*e))),ee("down",e=>this.pan(new z(0,-.1*e))),ee("right",e=>this.pan(new z(-.1*e,0))),ee("left",e=>this.pan(new z(.1*e,0))),ee("+",e=>this.zoom(1/((1.3-1)*e+1))),ee("-",e=>this.zoom((1.3-1)*e+1)),ee("V",()=>this.dispatch(Ge())),ee("R left",e=>this.viewportTransform("rotation",-te*e)),ee("R right",e=>this.viewportTransform("rotation",+te*e)),ee("S right",e=>this.viewportTransform("scale",1/(1+.1*e),1)),ee("S left",e=>this.viewportTransform("scale",1+.1*e,1)),ee("S up",e=>this.viewportTransform("scale",1,1/(1+.1*e))),ee("S down",e=>this.viewportTransform("scale",1,1+.1*e)),ee("H right",e=>this.viewportTransform("shear",-.1*e,0)),ee("H left",e=>this.viewportTransform("shear",.1*e,0)),ee("H up",e=>this.viewportTransform("shear",0,-.1*e)),ee("H down",e=>this.viewportTransform("shear",0,.1*e)),ee("G",()=>this.dispatch(Be()))}setupTouch(){var e=new X.a(this.engine.canvas,{});let t,a,r=!1;e.get("pan").set({direction:X.a.DIRECTION_ALL,threshold:1}),e.get("pinch").set({enable:!0}),e.on("doubletap",e=>{const t=new z(e.center.x,e.center.y);this.zoom(.4,new z(t))}),e.on("panstart",e=>{r=!0,t=new z(e.center.x,e.center.y),a=this.camera.clone()}),e.on("panend",e=>{r=!1}),e.on("panmove",e=>{if(r){const r=new z(e.center.x,e.center.y).minus(t),n=a.scr2cpx(new z(0,0)),s=a.scr2cpx(r).minus(n),i=a.getPos().minus(s);this.dispatch(ze(i))}});var n=!1;let s;e.on("pinchstart",e=>{console.log("pinchstart"),n=!0,s=new z(e.center.x,e.center.y),a=this.camera.clone()}),e.on("pinchend",(function(e){console.log("pinchend"),n=!1})),e.on("pinch",e=>{if(n){var t=a.scr2cpx(s),r=a.scr2cpx(new z(e.center.x,e.center.y)),i=B.GetTriangleToTriangle(t.x,t.y,t.x+1,t.y,t.x,t.y+1,r.x,r.y,r.x+e.scale,r.y,r.x,r.y+e.scale),o=i.inverse().transform(a.pos);let n=a.w/i.a;n<this.camera.resolutionLimit&&(this.engine.ctx.event.notify("zoom.limit"),n=this.camera.resolutionLimit),this.dispatch(ze(o,n))}})}setupMouse(){this.engine.canvas.addEventListener("wheel",e=>{const t=e||window.event;t.preventDefault();const a=t.shiftKey?.1:1;let r=t.deltaY;r=r>0?(1.3-1)*a+1:1/((1.3-1)*a+1);const n=new z(t.offsetX,t.offsetY);this.zoom(r,n)})}}const re=Object(H.b)({name:"colors",initialState:{offset:0,id:0,density:20,fn:"s"},reducers:{setColorId:(e,t)=>Object(v.a)({},e,{id:t.payload}),setOffset:(e,t)=>Object(v.a)({},e,{offset:t.payload}),setDensity:(e,t)=>Object(v.a)({},e,{density:t.payload}),setPaint:(e,t)=>Object(v.a)({},e,{},t.payload)}}),ne=re.reducer,se=re.actions,ie=se.setOffset,oe=se.setColorId,ce=se.setDensity,le=se.setPaint,he=Object(H.b)({name:"ui",initialState:{active:!0,x:0,y:0},reducers:{setGuide:(e,t)=>Object(v.a)({},e,{},t.payload)}}),de=he.reducer,ue=he.actions.setGuide,me={t:"mandelbrot",i:"50",fs:"1",ct:"0",co:"0",cd:"20",cf:"n",va:"1.0000",vb:"0.0000",vc:"0.0000",vd:"1.0000"};const fe=()=>{try{const e=document.location.hash;if(e.startsWith("#B"))return function(e){const t=e.substr(2).split("&").reduce((e,t)=>{const a=t.split("_");return Object.assign(e,{[a[0]]:a[1]})},{}),a=Object(v.a)({},me,{},t),r={x:parseFloat(a.x),y:parseFloat(a.y),w:parseFloat(a.w),iter:parseInt(a.i),fractalId:a.t,smooth:1===parseInt(a.fs),viewport:Object(v.a)({},B.identity)};r.viewport={a:parseFloat(a.va),b:parseFloat(a.vb),c:parseFloat(a.vc),d:parseFloat(a.vd),e:0,f:0};const n={offset:parseInt(a.co)/100,density:parseFloat(a.cd),id:parseInt(a.ct,10),fn:a.cf};let s={active:!1,x:0,y:0};return"gx"in a&&(s={active:!0,x:parseFloat(a.gx),y:parseFloat(a.gy)}),{desc:r,painter:n,guide:s}}(e)}catch(e){console.error("Could not read URL",e)}return null},pe=(e,t=!1)=>{const a=fe();if(!a||t){let t=Object(v.a)({},T("mandelbrot"),{smooth:!0,viewport:Object(v.a)({},B.identity)}),a={offset:0,density:20,id:0,fn:"s"};e(Y(t)),e(oe(a.id)),e(ie(0)),e(ce(20))}else{const t=a.desc,r=a.painter,n=a.guide;e(Y(t)),e(ue(n)),e(oe(r.id)),e(ie(r.offset)),e(ce(r.density))}};var we=a(50),ve=a.n(we),xe=a(51),be=a.n(xe);const ge=Object(H.b)({name:"ui",initialState:{drawer:!1,mouseOnCanvas:!1,tab:"fractal",infobox:!1,square:!1,showPois:!0,mouse:{x:0,y:0,iter:0},narrowDevice:!1,orientableDevice:!1,screen:{width:0,height:0,min:0}},reducers:{setUi:(e,t)=>Object(v.a)({},e,{},t.payload),toggleSquare:e=>Object(v.a)({},e,{square:!e.square}),setDrawer:(e,t)=>Object(v.a)({},e,{drawer:t.payload}),setTab:(e,t)=>Object(v.a)({},e,{tab:t.payload}),setScreenSize:(e,t)=>{const a=Object(v.a)({},e,{screen:t.payload});return a.screen.min=Math.min(a.screen.width,a.screen.height),a},setInfobox:(e,t)=>Object(v.a)({},e,{infobox:t.payload}),setMouseOnCanvas:(e,t)=>Object(v.a)({},e,{mouseOnCanvas:t.payload}),setMouseInfo:(e,t)=>Object(v.a)({},e,{mouse:t.payload}),setNarrowDevice:(e,t)=>Object(v.a)({},e,{narrowDevice:t.payload}),setSnack:(e,t)=>Object(v.a)({},e,{snack:t.payload})}}),ye=ge.reducer,Ee=ge.actions,ke=Ee.setUi,Fe=Ee.setDrawer,Oe=Ee.setTab,Me=Ee.setInfobox,je=Ee.setMouseOnCanvas,Ie=Ee.setMouseInfo,Se=Ee.setSnack,Te=Ee.setNarrowDevice,Ce=Ee.toggleSquare,Ne=Ee.setScreenSize,De=(e,t)=>{t.beginPath(),t.moveTo(e.x-20,e.y),t.lineTo(e.x+20,e.y),t.moveTo(e.x,e.y-20),t.lineTo(e.x,e.y+20),t.stroke()};class Pe{constructor(e,t,a){this.canvas=e,this.engine=t,this.getState=a,this.context=void 0,this.context=e.getContext("2d")}draw(){const e=this.getState().guide;if(!e.active)return void(this.canvas.hidden=!0);this.canvas.hidden=!1;const t=this.engine.ctx.camera.cpx2scr(new z(e.x,e.y));this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.lineWidth=3,this.context.strokeStyle="#000000",De(t.plus(new z(3,3)),this.context),this.context.strokeStyle="#FFFFFF",De(t,this.context)}}let We,Re,Ae;const Le=(e,t)=>(a,r)=>{ee("I",()=>a(Me(!r().ui.infobox))),ee("esc",()=>a(Fe(!r().ui.drawer))),ee("D",()=>{a(Fe(!0)),a(Oe("debug"))}),ee("Q",()=>a(Ce())),ee("P",()=>(e=>{const t={name:"",fractalId:e.set.fractalId,x:e.set.x,y:e.set.y,w:e.set.w};console.log("---- POI"),console.log(JSON.stringify(t,null,2))})(r())),ee("M",()=>a(ke({showPois:!r().ui.showPois})));const n=()=>[window.innerWidth,window.innerHeight],s=()=>{const r=n(),s=Object(x.a)(r,2),i=s[0],o=s[1];var c=n(),l=Object(x.a)(c,2);e.width=l[0],e.height=l[1];var h=n(),d=Object(x.a)(h,2);t.width=d[0],t.height=d[1],a(Ne({width:i,height:o}))};s(),window.addEventListener("resize",()=>{s(),We.resize(e.width,e.height),We.draw()});const i=e=>a(Te(e.matches)),o=window.matchMedia("(max-width: 450px)");i(o),o.addListener(i),window.addEventListener("error",be()(()=>{console.error("error caught, resetting engine"),pe(a,!0),We.draw()},200)),e.addEventListener("mouseenter",()=>{a(je(!0))}),e.addEventListener("mouseleave",()=>{a(je(!1))}),e.addEventListener("mousemove",ve()(e=>{const t=We.ctx.camera.scr2cpx(new z(e.offsetX,e.offsetY)),r=We.getIterationsAt(t);a(Ie({x:t.x,y:t.y,iter:r}))},50));pe(a),We=new U(e,()=>{const e=r();return Object(v.a)({},e.set,{painter:e.colors})}),window.engine=We,Ae=be()(()=>{(e=>{try{const t={};t.t=e.set.fractalId,t.x=e.set.x,t.y=e.set.y,t.w=e.set.w,t.i=String(e.set.iter),t.fs=e.set.smooth?"1":"0",t.ct=String(e.colors.id),t.co=String(Math.round(100*e.colors.offset)),t.cd=String(+e.colors.density.toFixed(2)),t.cf=e.colors.fn,t.va=e.set.viewport.a.toFixed(4),t.vb=e.set.viewport.b.toFixed(4),t.vc=e.set.viewport.c.toFixed(4),t.vd=e.set.viewport.d.toFixed(4),e.guide.active&&(t.gx=e.guide.x,t.gy=e.guide.y);for(let e in t)t[e]===me[e]&&delete t[e];const a=Object.entries(t).map(([e,t])=>"".concat(e,"_").concat(t)).join("&");window.history.replaceState("","","#B".concat(a))}catch(t){console.error("Could not set URL",t)}})(r())},250),We.ctx.event.on("draw.start",Ae),We.ctx.event.on("draw.redraw",Ae),We.ctx.event.on("zoom.limit",()=>{a(Se("Sorry, FractalJS cannot zoom further..."))}),We.ctx.event.on("zoom.limit",be()(()=>{a(Se(void 0))},5e3)),Re=new Pe(t,We,r),We.ctx.event.on("draw.start",()=>{Re.draw()}),new ae(We,a),function(e,t,a){const r=e,n=r.draw.bind(r);let s=0,i="";const o=e=>new Promise(t=>setTimeout(()=>t(),e)),c=()=>{const e=r.getHistogram(),t=r.ctx.camera.screen.x*r.ctx.camera.screen.y,a=r.ctx.iter;let n=0;for(let r=Math.round(.9*a);r<=a;r+=1)n+=e[r];const s=100*n/t;return{shouldIncrease:s>.2,shouldDecrease:s<.05,txt:"10% fringe is ".concat(n,"px or ").concat(s.toFixed(2),"%")}};r.draw=Object(w.a)(p.a.mark((function e(){var a,l,h,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s+=1,a=s,(l=r.ctx.fractalId+r.ctx.smooth)===i){e.next=9;break}return e.next=7,n({details:"subsampling",size:4});case 7:if(s===a){e.next=9;break}return e.abrupt("return");case 9:return i=l,e.next=12,n({details:"normal",id:a});case 12:if(s===a){e.next=14;break}return e.abrupt("return");case 14:h=c();case 15:if(!h.shouldIncrease){e.next=26;break}return d=Math.round(1.5*r.ctx.iter),t(K({iter:d})),r.ctx.iter=d,e.next=21,n({details:"normal",id:a});case 21:if(s===a){e.next=23;break}return e.abrupt("return");case 23:h=c(),e.next=15;break;case 26:if(h.shouldDecrease&&(d=Math.round(Math.max(50,r.ctx.iter/1.5)),t(K({iter:d})),r.ctx.iter=d),!C.supersampling){e.next=34;break}return e.next=30,o(1e3);case 30:if(s===a){e.next=32;break}return e.abrupt("return");case 32:return e.next=34,n({details:"supersampling",size:4,id:a});case 34:e.next=38;break;case 36:e.prev=36,e.t0=e.catch(0);case 38:case"end":return e.stop()}}),e,null,[[0,36]])})))}(We,a),We.draw()},ze=(e,t)=>a=>{a(K(void 0===t?{x:e.x,y:e.y}:{x:e.x,y:e.y,w:t})),We.draw()},Be=()=>function(){var e=Object(w.a)(p.a.mark((function e(t,a){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=a().ui).mouseOnCanvas&&(t(ue({active:!0,x:r.mouse.x,y:r.mouse.y})),Re.draw(),Ae());case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ge=()=>e=>{e(K({viewport:Object(v.a)({},B.identity)})),We.draw()},Ue=(e,t,a)=>(r,n)=>{let s=B.identity;switch(e){case"rotation":s=B.GetRotationMatrix(t);break;case"shear":s=B.GetShearMatrix(t,a);break;case"scale":s=B.GetScaleMatrix(t,a)}let i=B.fromRaw(n().set.viewport);i=i.multiply(s),r(K({viewport:Object(v.a)({},i)})),We.draw()};var He=a(292);const _e=Object(c.a)(e=>({swatches:{display:"flex",flexWrap:"wrap",marginLeft:-e.spacing(1),"& > *":{"& > *":{textTransform:"none",width:"100%"},width:"50%",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)}}}));var qe=function(){const e=_e(),t=Object(o.b)(),a=Object(o.c)(e=>e.set.fractalId),r=Object.values(S).filter(e=>!e.hidden).sort((e,t)=>(e.uiOrder||0)-(t.uiOrder||0)).map(e=>n.a.createElement("div",{key:e.fractalId},n.a.createElement(He.a,{variant:a===e.fractalId?"contained":"outlined",color:a===e.fractalId?"primary":"default",onClick:()=>t((e=>t=>{const a=T(e);t(K(a)),t(K({viewport:Object(v.a)({},B.identity)})),t(le({density:20})),t(ue({active:!1})),We.draw()})(e.fractalId))},e.name)));return n.a.createElement("div",null,n.a.createElement(d.a,{component:"nav",subheader:n.a.createElement(m.a,{component:"div"},"Pick a fractal set")},n.a.createElement(u.a,null,n.a.createElement("div",{className:e.swatches},r))))},Je=a(311),Ye=a(75);const Ke=Math.pow(400,.01),Ve=(()=>{const e=[],t=document.createElement("canvas"),a=t.getContext("2d");t.width=100,t.height=50;const r=a.createImageData(t.width,t.height),n=new Uint32Array(r.data.buffer);return[0,2,3,4,5,10,11,12,13,14,15,16,17,18,19].forEach(s=>{const i=A(s,100);for(let e=0;e<100;e+=1)for(let t=0;t<50;t+=1)n[100*t+e]=i[Math.round(.6*e+.6*t)%100];a.putImageData(r,0,0,0,0,t.width,t.height);const o=t.toDataURL("image/png");e.push({id:s,dataURL:o})}),e})(),Xe=Object(c.a)(e=>({swatches:{display:"flex",flexWrap:"wrap",marginRight:-e.spacing(1),"& > *":{paddingBottom:e.spacing(1),paddingRight:e.spacing(1),width:"20%",height:"56px",position:"relative","& > img":{width:"100%",height:"100%",borderRadius:"4px"},"& > i":{position:"absolute",bottom:0,right:0,color:"white",fontSize:"36px",padding:"0px",textShadow:"2px 2px 2px #888"}}},txt:{width:"100px"}}));var Ze=function(){const e=Xe(),t=Object(o.b)(),a=Object(o.c)(e=>e.colors),r=Ve.map(e=>n.a.createElement("div",{key:e.id,onClick:()=>{return t((a=e.id,e=>{e(le({id:a,fn:"s"})),We.drawColor()}));var a}},n.a.createElement("img",{alt:"",src:e.dataURL}),a.id===e.id?n.a.createElement("i",{className:"material-icons"},"check_circle"):null)),s=Math.log(20*a.density)/Math.log(Ke);return n.a.createElement("div",null,n.a.createElement(d.a,{component:"nav",dense:!0},n.a.createElement(m.a,{component:"div"},"Pick & adjust a color palette"),n.a.createElement(u.a,null,n.a.createElement("div",{className:e.swatches},r)),n.a.createElement(u.a,null,n.a.createElement(Ye.a,{className:e.txt},"Move"),n.a.createElement(Je.a,{min:0,max:1,step:.001,value:a.offset,onChange:ve()((e,a)=>{return t((r=a,e=>{e(ie(r)),We.drawColor()}));var r},100)})),n.a.createElement(u.a,null,n.a.createElement(Ye.a,{className:e.txt},"Stretch"),n.a.createElement(Je.a,{min:0,max:100,step:1,value:s,onChange:ve()((e,a)=>{return t((e=>t=>{t(ce(e)),We.drawColor()})((r=a,.05*Math.pow(Ke,r))));var r},100)}))))},Qe=a(296),$e=a(297),et=a(306);var tt=function(){const e=Object(o.b)(),t=Object(o.c)(e=>e.set.smooth),a=Object(o.c)(e=>e.ui);return n.a.createElement("div",null,n.a.createElement(d.a,{component:"nav",subheader:n.a.createElement(m.a,{component:"div"},"Advanced settings")},n.a.createElement(u.a,null,n.a.createElement(Qe.a,{primary:"Smooth rendering"}),n.a.createElement($e.a,null,n.a.createElement(et.a,{edge:"end",onChange:t=>{e((e=>t=>{t(K({smooth:e})),We.draw()})(t.target.checked))},checked:t,color:"primary"}))),a.narrowDevice?null:n.a.createElement(u.a,null,n.a.createElement(Qe.a,{primary:"Information box"}),n.a.createElement($e.a,null,n.a.createElement(et.a,{edge:"end",onChange:t=>{e(Me(t.target.checked))},checked:a.infobox,color:"primary"})))))},at=a(309),rt=a(299),nt=a(307),st=a(300),it=a(125);const ot=Object(c.a)(e=>Object(at.a)({avatar:{backgroundColor:e.palette.primary.main},inline:{display:"inline"},keyboard:{"& > span":{display:"inline-block",verticalAlign:"middle",border:"1px solid #888",background:"#EEE",borderRadius:"4px",padding:"1px 4px",margin:"2px 0px",fontSize:"14px",minWidth:"1.8em",textAlign:"center",color:"black",marginRight:"0.4em"}}})),ct=()=>{const e=ot();return n.a.createElement("span",{className:e.keyboard},n.a.createElement("span",null,"\ud83e\udc1c"),n.a.createElement("span",null,"\ud83e\udc1d"),n.a.createElement("span",null,"\ud83e\udc1e"),n.a.createElement("span",null,"\ud83e\udc1f")," : move",n.a.createElement("br",null),n.a.createElement("span",null,n.a.createElement("b",null,"+")),n.a.createElement("span",null,n.a.createElement("b",null,"-"))," ",": zoom",n.a.createElement("br",null),n.a.createElement("span",null,"R")," + ",n.a.createElement("span",null,"\ud83e\udc1c"),n.a.createElement("span",null,"\ud83e\udc1e")," : rotate",n.a.createElement("br",null),n.a.createElement("span",null,"S")," + ",n.a.createElement("span",null,"\ud83e\udc1c"),n.a.createElement("span",null,"\ud83e\udc1d"),n.a.createElement("span",null,"\ud83e\udc1e"),n.a.createElement("span",null,"\ud83e\udc1f")," : scale x or y",n.a.createElement("br",null),n.a.createElement("span",null,"H")," + ",n.a.createElement("span",null,"\ud83e\udc1c"),n.a.createElement("span",null,"\ud83e\udc1d"),n.a.createElement("span",null,"\ud83e\udc1e"),n.a.createElement("span",null,"\ud83e\udc1f")," : shear x or y",n.a.createElement("br",null),n.a.createElement("span",null,"V")," : reset viewport",n.a.createElement("br",null),"all + ",n.a.createElement("span",null,"shift")," : smaller movement",n.a.createElement("br",null),n.a.createElement("span",null,"G")," : set a guide point")},lt=()=>{const e=ot();return n.a.createElement(Ye.a,{component:"span",variant:"body1",className:e.inline,color:"textPrimary"},"FractalJS is open-source. You can report bugs, or add you favorite fractal set by heading to"," ",n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/solendil/fractaljs/"},"GitHub"),".")};function ht(){const e=ot();return n.a.createElement(n.a.Fragment,null,n.a.createElement(d.a,{component:"nav",style:{maxWidth:"360px"}},n.a.createElement(m.a,{component:"div"},"Controls"),"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?n.a.createElement(u.a,null,n.a.createElement(rt.a,null,n.a.createElement(nt.a,{className:e.avatar},n.a.createElement("i",{className:"material-icons"},"touch_app"))),n.a.createElement(Qe.a,{primary:"Touch",secondary:"Swipe & Pinch to zoom"})):null,matchMedia("(pointer:fine)").matches||matchMedia("(hover:hover)").matches?n.a.createElement(u.a,null,n.a.createElement(rt.a,null,n.a.createElement(nt.a,{className:e.avatar},n.a.createElement("i",{className:"material-icons"},"mouse"))),n.a.createElement(Qe.a,{primary:"Mouse",secondary:"Drag & wheel zoom"})):null,"undefined"===typeof window.orientation&&-1===navigator.userAgent.indexOf("IEMobile")?n.a.createElement(u.a,null,n.a.createElement(rt.a,null,n.a.createElement(nt.a,{className:e.avatar},n.a.createElement("i",{className:"material-icons"},"keyboard"))),n.a.createElement(Qe.a,{primary:"Keyboard",secondary:n.a.createElement(ct,null)})):null,n.a.createElement(st.a,null),n.a.createElement(m.a,{component:"div"},"About"),n.a.createElement(u.a,null,n.a.createElement(lt,null)),n.a.createElement(u.a,null,n.a.createElement(it.a,{href:"https://github.com/solendil/fractaljs","data-color-scheme":"no-preference: light; light: light; dark: light;","data-size":"large","data-show-count":!0,"aria-label":"Star solendil/fractaljs on GitHub"},"Star")," ")))}function dt(){const e=We,t=e.ctx.camera;return n.a.createElement("div",null,n.a.createElement(d.a,{component:"nav"},n.a.createElement(m.a,{component:"div"},"Debug"),n.a.createElement(u.a,null,"Threads: ",e.ctx.nbThreads),n.a.createElement(u.a,null,"Screen: ",t.screen.x," * ",t.screen.y)))}var ut=a(126),mt=a.n(ut),ft=a(298),pt=a(127);var wt=e=>{const t=navigator;return t.share?n.a.createElement(ft.a,{className:e.className,onClick:()=>{t.share({title:"FractalJS",text:"Check out this fractal picture !",url:window.location.href})}},n.a.createElement("i",{className:"material-icons"},"share")):null};const vt=Object(c.a)(e=>({bar:{backgroundColor:Object(pt.fade)(e.palette.primary.main,.8),backdropFilter:"blur(8px)",position:"fixed",display:"flex",[e.breakpoints.only("xs")]:{width:"100%",height:"56px",bottom:0},[e.breakpoints.up("sm")]:{height:"100%",flexDirection:"column",left:0,flexWrap:"wrap-reverse"}},icons:{color:"white",[e.breakpoints.only("xs")]:{width:"60px"},[e.breakpoints.up("sm")]:{width:"56px"}},selected:{color:e.palette.secondary.main},brand:{[e.breakpoints.only("xs")]:{display:"none"},color:"white",fontSize:"20px",lineHeight:"56px",writingMode:"vertical-rl",transform:"rotate(180deg)",fontFamily:"roboto",paddingBottom:"56px",paddingTop:"0.5em",letterSpacing:"3px",fontWeight:500,flexGrow:1,textDecoration:"none"}}));var xt=()=>{const e=vt(),t=Object(o.b)(),a=Object(o.c)(e=>e.ui.showPois),r=mt()(bt,(a,r)=>a.hidden?null:n.a.createElement(ft.a,{key:r,className:e.icons,onClick:()=>{t(Oe(r)),t(Fe(!0))}},n.a.createElement("i",{className:"material-icons"},a.icon))).filter(Boolean);r.push(n.a.createElement("a",{href:"https://github.com/solendil/FractalJS",target:"_",className:e.brand,key:"brand"},"FractalJS"));const s=n.a.createElement(ft.a,{className:"".concat(e.icons," ").concat(a?e.selected:""),key:"pois",onClick:()=>t(ke({showPois:!a}))},n.a.createElement("i",{className:"material-icons"},"map"));return r.splice(2,0,s),r.splice(2,0,n.a.createElement(wt,{key:"share",className:e.icons})),n.a.createElement("div",{className:e.bar},r)};const bt={fractal:{icon:"collections",component:n.a.createElement(qe,null)},palette:{icon:"format_paint",component:n.a.createElement(Ze,null)},settings:{icon:"settings",component:n.a.createElement(tt,null)},about:{icon:"help",component:n.a.createElement(ht,null)},debug:{hidden:!0,component:n.a.createElement(dt,null)}},gt=Object(c.a)(e=>({appBar:{top:"auto",bottom:0},drawer:{minWidth:"360px",[e.breakpoints.up("sm")]:{width:"360px"}},trans:{[e.breakpoints.only("xs")]:{borderTopLeftRadius:"10px",borderTopRightRadius:"10px"}},handle:{width:"33%",margin:"4px auto -2px auto",height:"4px"}}));var yt=()=>{const e=gt(),t=Object(o.b)(),a=Object(o.c)(e=>({drawer:e.ui.drawer,tab:e.ui.tab})),r=a.drawer,s=a.tab,i=Object(h.a)("(min-width:450px)"),c=bt[s||"fractal"].component;return n.a.createElement(n.a.Fragment,null,n.a.createElement(xt,null),n.a.createElement(l.a,{anchor:i?"left":"bottom",open:r,disableDiscovery:!0,disableSwipeToOpen:!0,PaperProps:{className:e.trans},BackdropProps:{invisible:!0},onClose:()=>t(Fe(!1)),onOpen:()=>t(Fe(!0))},n.a.createElement("div",{className:e.drawer},i?null:n.a.createElement(st.a,{className:e.handle}),c)))},Et=a(302),kt=a(305);const Ft=Object(c.a)(e=>({box:{position:"fixed",bottom:0,right:0,margin:"16px",background:"white",padding:"16px"}}));var Ot=function(){const e=Ft(),t=Object(o.c)(e=>e.set),a=Object(o.c)(e=>e.ui);if(a.narrowDevice)return null;if(!a.infobox)return null;const r={};return a.mouseOnCanvas?(r.x=a.mouse.x,r.y=a.mouse.y,r.iter=a.mouse.iter,r.w=t.w):(r.x=t.x,r.y=t.y,r.iter=t.iter,r.w=t.w),n.a.createElement(Et.a,{elevation:3,className:e.box},n.a.createElement(Ye.a,{color:"primary",gutterBottom:!0,variant:"h6"},a.mouseOnCanvas?"Mouse":"Screen"),n.a.createElement(Ye.a,{component:"div"},n.a.createElement(kt.a,{fontFamily:"Monospace"},"X: ",r.x.toFixed(16)),n.a.createElement(kt.a,{fontFamily:"Monospace"},"Y: ",r.y.toFixed(16)),n.a.createElement(kt.a,{fontFamily:"Monospace"},"iterations: ",r.iter.toFixed(2)),n.a.createElement(kt.a,{fontFamily:"Monospace"},"extent: ",r.w.toExponential(2))))},Mt=a(308);const jt=Object(c.a)(e=>({snackbar:{[e.breakpoints.only("xs")]:{bottom:64}}}));var It=()=>{const e=Object(o.c)(e=>e.ui),t=jt();return e.snack?n.a.createElement(Mt.a,{open:!0,className:t.snackbar,message:"Sorry, FractalJS cannot zoom further..."}):null};var St=e=>{const t=e.x,a=e.y,r=e.w,s=e.camera,i=B.GetTriangleToTriangle(0,0,0,360,360,360,t-r/2,a+r/2,t-r/2,a-r/2,t+r/2,a-r/2),o=s.matrix_inv.multiply(i),c={transform:"matrix(".concat(o.a,", ").concat(o.b,", ").concat(o.c,", ").concat(o.d,", ").concat(o.e,", ").concat(o.f,")")};return n.a.createElement("div",{className:"poi",style:c},n.a.createElement("div",{className:"frame"}),n.a.createElement("div",{className:"bottom"},e.name))},Tt=a(25);const Ct=[{name:"The Mandelbrot set",fractalId:"mandelbrot",x:-.7700865783521146,y:.0005149610839296841,w:3.2541397276576007},{name:"The seahorse valley",fractalId:"mandelbrot",x:-.8850169319618038,y:.20430236940113136,w:.5341582685511642},{name:'Double-spirals on the left, "seahorses" on the right',fractalId:"mandelbrot",x:-.761898850758455,y:.13624533125298993,w:.06172323608813737},{name:'"Seahorse" upside down',fractalId:"mandelbrot",x:-.7434670975470078,y:.1264225543830674,w:.01619893159287557},{name:"Seahorse tail",fractalId:"mandelbrot",x:-.7435575011333871,y:.13141411010448878,w:.0023624968121003496},{name:"Part of the tail",fractalId:"mandelbrot",x:-.7436534729475947,y:.13188172343759305,w:.0007349349876731434},{name:"Satellite",fractalId:"mandelbrot",x:-.7436414448061901,y:.13182674539039832,w:.00012108054070541848},{name:"Satellite",fractalId:"mandelbrot",x:-.7436431541413343,y:.13182586483571457,w:14770086109824968e-21},{name:'"Antenna" of the satellite',fractalId:"mandelbrot",x:-.7436447696546592,y:.13182527423151064,w:2970883958121094e-21},{name:'The "seahorse valley" of the satellite',fractalId:"mandelbrot",x:-.7436441018154397,y:.13182604877870288,w:6.725696241359014e-7},{name:"Double-spirals",fractalId:"mandelbrot",x:-.7436438803098491,y:.13182591847076758,w:1.6094281332162775e-7},{name:"Satellites of second order",fractalId:"mandelbrot",x:-.7436438993338419,y:.13182589080585413,w:5.0066736140673944e-8},{name:"Island",fractalId:"mandelbrot",x:-.7436438886058956,y:.13182590433282593,w:4.1947898743490354e-9},{name:"Double hook",fractalId:"mandelbrot",x:-.7436438871772372,y:.13182590424946874,w:6.117797120607018e-10},{name:"Islands",fractalId:"mandelbrot",x:-.7436438870371828,y:.13182590420568097,w:5260191508094819e-26},{name:"Detail of one island",fractalId:"mandelbrot",x:-.7436438870365094,y:.13182590421022766,w:7448163315952692e-27},{name:"Detail of the spiral",fractalId:"mandelbrot",x:-.7436438870357782,y:.13182590421248866,w:42535996934475523e-29},{name:"Frequency overload",fractalId:"tippetts",x:-.7036494534576752,y:.39624415815626096,w:.0056686048452011415},{name:"Crossroad",fractalId:"tippetts",x:.27818862424130375,y:-.8136071097929828,w:.004360465265539319},{name:"Yummy waves",fractalId:"tippetts",x:-1.4111616659280735,y:-.0028525496453486393,w:.009579942188389867}];let Nt=0;const Dt=(()=>{const e={};return Ct.sort((e,t)=>e.w-t.w),Ct.forEach(t=>{t.fractalId in e||(e[t.fractalId]=[]),e[t.fractalId].push({id:Nt++,name:t.name,x:t.x,y:t.y,w:t.w})}),e})();var Pt=e=>{const t=e.scr,a={transform:"translate(".concat(t.x,"px, ").concat(t.y,"px) translate(-50%, -50%)")};return n.a.createElement("div",{className:"cross",style:a},n.a.createElement("div",{className:"h1"}),n.a.createElement("div",{className:"h2"}),n.a.createElement("div",{className:"v1"}),n.a.createElement("div",{className:"v2"}))};const Wt=Object(Tt.a)(e=>e.set,e=>e.ui.screen,(e,t)=>new G(new z(t.width,t.height),new z(e.x,e.y),e.w,B.fromRaw(e.viewport)));var Rt=()=>{const e=Object(o.c)(e=>Wt(e)),t=Object(o.c)(e=>e.ui.screen),a=Object(o.c)(e=>e.set.fractalId),r=(Dt[a]||[]).map(t=>Object(v.a)({},t,{width:t.w*e.matrix_inv.a})),s=r.filter(e=>e.width<50).map(t=>Object(v.a)({},t,{scr:e.cpx2scr(new z(t.x,t.y))})),i=[];s.forEach(e=>{var t,a=Object(g.a)(i);try{for(a.s();!(t=a.n()).done;){let a=t.value;if(e.scr.distanceTo(a.scr)<15)return}}catch(r){a.e(r)}finally{a.f()}i.push(e)});const c=i.map(e=>n.a.createElement(Pt,Object.assign({key:e.id},e))),l=r.filter(e=>e.width>=50&&e.width<2*t.min).map(a=>n.a.createElement(St,Object.assign({key:a.id,camera:e,screen:t},a)));return n.a.createElement("div",null,l,c)};var At=()=>{const e=Object(o.c)(e=>e.ui.square),t=Object(o.c)(e=>e.ui.showPois);return n.a.createElement("div",{className:"pois offset"},e?n.a.createElement("div",{className:"squares"},n.a.createElement("div",{className:"square"}),n.a.createElement("div",{className:"third"})):null,t?n.a.createElement(Rt,null):null)};var Lt=()=>{const e=Object(o.b)(),t=Object(r.useRef)(null),a=Object(r.useRef)(null),s=Object(o.c)(e=>e.ui.drawer),i=Object(o.c)(e=>e.ui.tab),c=Object(h.a)("(min-width:450px)");n.a.useEffect(()=>{const r=t.current,n=a.current;e(Le(r,n))},[e]);let l="";return s&&(l=c?"offset-left":"offset-top-".concat(i)),n.a.createElement("div",{className:"main ".concat(l)},n.a.createElement("canvas",{ref:t,className:"offset"}),n.a.createElement("canvas",{ref:a,className:"offset guide"}),n.a.createElement(At,null),n.a.createElement(yt,null),n.a.createElement(Ot,null),n.a.createElement(It,null))},zt=a(303);const Bt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Gt(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}var Ut=a(22);var Ht=Object(Ut.combineReducers)({ui:ye,guide:de,set:q,colors:ne}),_t=a(128);a(246)(n.a,{trackHooks:!0,trackAllPureComponents:!0,trackExtraHooks:[[a(247),"useSelector"]]});const qt=Object(H.a)({reducer:Ht}),Jt=Object(_t.a)({palette:{primary:{main:"#1976d2"},secondary:{main:"#ffc107"}},breakpoints:{values:{xs:0,sm:450,md:960,lg:1280,xl:1920}}});i.a.render(n.a.createElement(o.a,{store:qt},n.a.createElement(zt.a,{theme:Jt},n.a.createElement(Lt,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="".concat(".","/service-worker.js");Bt?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then(a=>{const r=a.headers.get("content-type");404===a.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):Gt(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Gt(t,e)})}}()}},[[137,1,2]]]);
//# sourceMappingURL=main.c57c9716.chunk.js.map