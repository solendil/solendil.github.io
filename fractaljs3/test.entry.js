!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=53)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e={ALL:100,DEBUG:100,INFO:200,WARN:300,ERROR:400,OFF:500},t={},n=console,r=function(){},o=function(t){return this.error=t<=e.ERROR?n.error.bind(n,"["+this.id+"] - ERROR - %s"):r,this.warn=t<=e.WARN?n.warn.bind(n,"["+this.id+"] - WARN - %s"):r,this.info=t<=e.INFO?n.info.bind(n,"["+this.id+"] - INFO - %s"):r,this.debug=t<=e.DEBUG?n.log.bind(n,"["+this.id+"] - DEBUG - %s"):r,this.log=n.log.bind(n,"["+this.id+"] %s"),this.currentLevel=t,this};return e.get=function(e){var n=t[e];if(!n){var r={id:e,level:o};r.level(i.ALL),n=r.log;for(var a in r)n[a]=r[a];t[e]=n}return n},e}();t.default=i},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];2===n.length?(this.x=n[0],this.y=n[1]):(this.x=n[0].x,this.y=n[0].y)}return r(e,[{key:"minus",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"plus",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"times",value:function(t){return t instanceof e?new e(this.x*t.x,this.y*t.y):new e(this.x*t,this.y*t)}}]),e}();t.default=o},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t){function n(e,t){for(var n=0;n<e.length;n++){var i=e[n],r=h[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(u(i.parts[o],t))}else{for(var a=[],o=0;o<i.parts.length;o++)a.push(u(i.parts[o],t));h[i.id]={id:i.id,refs:1,parts:a}}}}function i(e){for(var t=[],n={},i=0;i<e.length;i++){var r=e[i],o=r[0],a=r[1],s=r[2],u=r[3],f={css:a,media:s,sourceMap:u};n[o]?n[o].parts.push(f):t.push(n[o]={id:o,parts:[f]})}return t}function r(e,t){var n=b(),i=g[g.length-1];if("top"===e.insertAt)i?i.nextSibling?n.insertBefore(t,i.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),g.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function o(e){e.parentNode.removeChild(e);var t=g.indexOf(e);t>=0&&g.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",r(e,t),t}function s(e){var t=document.createElement("link");return t.rel="stylesheet",r(e,t),t}function u(e,t){var n,i,r;if(t.singleton){var u=y++;n=v||(v=a(t)),i=f.bind(null,n,u,!1),r=f.bind(null,n,u,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(t),i=c.bind(null,n),r=function(){o(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(t),i=l.bind(null,n),r=function(){o(n)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}function f(e,t,n,i){var r=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=m(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function l(e,t){var n=t.css,i=t.media;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function c(e,t){var n=t.css,i=t.sourceMap;i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var r=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}var h={},d=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},p=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),b=d(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,y=0,g=[];e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");t=t||{},"undefined"==typeof t.singleton&&(t.singleton=p()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var r=i(e);return n(r,t),function(e){for(var o=[],a=0;a<r.length;a++){var s=r[a],u=h[s.id];u.refs--,o.push(u)}if(e){var f=i(e);n(f,t)}for(var a=0;a<o.length;a++){var u=o[a];if(0===u.refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete h[u.id]}}}};var m=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(1),s=i(a),u=function(){function e(t,n,i,o,a,s){r(this,e),t instanceof e?(this.a=t.a,this.c=t.c,this.e=t.e,this.b=t.b,this.d=t.d,this.f=t.f):(this.a=t,this.c=i,this.e=a,this.b=n,this.d=o,this.f=s)}return o(e,[{key:"transform",value:function(e){return new s.default(e.x*this.a+e.y*this.c+this.e,e.x*this.b+e.y*this.d+this.f)}},{key:"transformXY",value:function(e,t){return{x:e*this.a+t*this.c+this.e,y:e*this.b+t*this.d+this.f}}},{key:"isIdentity",value:function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f}},{key:"isInvertible",value:function(){var e=this.a*this.d-this.b*this.c;return Math.abs(e)>1e-15}},{key:"inverse",value:function(){if(!this.isInvertible())return this.inverseGaussJordan();var t=this.a*this.d-this.b*this.c;return new e(this.d/t,-this.b/t,-this.c/t,this.a/t,(this.c*this.f-this.d*this.e)/t,-(this.a*this.f-this.b*this.e)/t)}},{key:"multiply",value:function(t){return new e(this.a*t.a+this.c*t.b,this.b*t.a+this.d*t.b,this.a*t.c+this.c*t.d,this.b*t.c+this.d*t.d,this.a*t.e+this.c*t.f+this.e,this.b*t.e+this.d*t.f+this.f)}},{key:"inverseGaussJordan",value:function(){function t(e,t,n,i){for(var r=e[t],o=e[n],a=0;a<6;a++)r[a]+=o[a]*i}function n(e,t,n){for(var i=e[t],r=0;r<6;r++)i[r]*=n}var i=[[this.a,this.c,this.e,1,0,0],[this.b,this.d,this.f,0,1,0],[0,0,1,0,0,1]];return t(i,1,2,-i[1][2]),t(i,0,2,-i[0][2]),t(i,1,0,-i[1][0]/i[0][0]),t(i,0,1,-i[0][1]/i[1][1]),n(i,0,1/i[0][0]),n(i,1,1/i[1][1]),new e(i[0][3],i[1][3],i[0][4],i[1][4],i[0][5],i[1][5])}},{key:"toString",value:function(){return this.a+" "+this.c+" "+this.e+"\n"+this.b+" "+this.d+" "+this.f+"\n0 0 1"}}],[{key:"Identity",value:function(){return new e(1,0,0,1,0,0)}},{key:"GetTriangleToTriangle",value:function(t,n,i,r,o,a,s,u,f,l,c,h){var d=new e(t-o,n-a,i-o,r-a,o,a),p=new e(s-c,u-h,f-c,l-h,c,h),b=d.inverse();return p.multiply(b)}},{key:"GetRotationMatrix",value:function(t){var n=Math.cos(t),i=Math.sin(t);return new e(n,i,-i,n,0,0)}},{key:"GetScaleMatrix",value:function(t,n){return new e(t,0,0,n,0,0)}},{key:"GetShearMatrix",value:function(t,n){return new e(1,n,t,1,0,0)}}]),e}();t.default=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(18),s=i(a),u=n(1),f=i(u),l=n(0),c=i(l),h=c.default.get("controller").level(c.default.INFO),d=.3,p=.1,b=.1,v=.1,y=Math.PI/18,g=function(){function e(t){r(this,e),this.engine=t,this.camera=t.camera,this.setupKeyboard(),this.setupMouse()}return o(e,[{key:"pan",value:function(e){h.info("pan",e);var t=this.camera,n=t.screenSize.times(e),i=t.scr2cpx(new f.default(0,0)),r=t.scr2cpx(n),o=i.minus(r),a=t.getPos().plus(o);t.setPos(a),this.engine.draw()}},{key:"affineTransform",value:function(e,t,n){h.info("transform",e,t,n),this.camera.affineTransform(e,t,n),this.engine.draw()}},{key:"affineReset",value:function(){this.camera.affineReset(),this.engine.draw()}},{key:"zoom",value:function(e,t){var n=this.camera;if(e<1&&n.isZoomLimit())return void this.engine.notify("zoom.limit");var i=t||n.screenSize.times(.5),r=n.scr2cpx(i);h.info("zoom",e,i,r);var o=n.getPos(),a=o.minus(r),s=r.plus(a.times(e));n.setPos(s,n.w*e),this.engine.draw()}},{key:"setupKeyboard",value:function(){var e=this;s.default.bind("up",function(t){return e.pan(new f.default(0,p*t))}),s.default.bind("down",function(t){return e.pan(new f.default(0,-p*t))}),s.default.bind("right",function(t){return e.pan(new f.default(-p*t,0))}),s.default.bind("left",function(t){return e.pan(new f.default(p*t,0))}),s.default.bind("+",function(t){return e.zoom(1/(1+d*t))}),s.default.bind("-",function(t){return e.zoom(1+d*t)}),s.default.bind("V",function(){return e.affineReset()}),s.default.bind("R left",function(t){return e.affineTransform("Rotation",-y*t)}),s.default.bind("R right",function(t){return e.affineTransform("Rotation",+y*t)}),s.default.bind("S right",function(t){return e.affineTransform("Scale",1/(1+b*t),1)}),s.default.bind("S left",function(t){return e.affineTransform("Scale",1+b*t,1)}),s.default.bind("S up",function(t){return e.affineTransform("Scale",1,1/(1+b*t))}),s.default.bind("S down",function(t){return e.affineTransform("Scale",1,1+b*t)}),s.default.bind("H right",function(t){return e.affineTransform("Shear",-v*t,0)}),s.default.bind("H left",function(t){return e.affineTransform("Shear",v*t,0)}),s.default.bind("H up",function(t){return e.affineTransform("Shear",0,-v*t)}),s.default.bind("H down",function(t){return e.affineTransform("Shear",0,v*t)})}},{key:"setupMouse",value:function(){var e=this,t=this.engine.canvas,n=!1,i=void 0,r=void 0;t.addEventListener("mousedown",function(t){var o=t||window.event;0===o.button&&(n=!0,i=new f.default(o.screenX,o.screenY),r=e.camera.clone())}),window.addEventListener("mouseup",function(){n=!1}),window.addEventListener("mousemove",function(t){var o=t||window.event;if(n){var a=new f.default(o.screenX,o.screenY),s=a.minus(i),u=r.scr2cpx(new f.default(0,0)),l=r.scr2cpx(s),c=l.minus(u),h=r.getPos().minus(c);e.camera.setPos(h),e.engine.draw()}});var o=function(t){var n=t||window.event;n.preventDefault();var i=n.shiftKey?.1:1,r=n.deltaY||n.wheelDelta;r=r>0?1+d*i:1/(1+d*i);var o=new f.default(n.offsetX,n.offsetY);e.zoom(r,o)};"onwheel"in t?t.onwheel=o:t.onmousewheel=o}}]),e}();t.default=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(0),s=i(a),u=n(17),f=i(u),l=n(11),c=i(l),h=n(9),d=i(h),p=n(8),b=i(p),v=s.default.get("engine").level(s.default.INFO),y=function(){function e(t){if(r(this,e),v.debug("start",t),!t.canvas)throw new Error;this.canvas=t.canvas,this.nbThreads=t.nbThreads||navigator.hardwareConcurrency||4,this.event=new f.default,this.camera=new b.default(t.canvas.width,t.canvas.height,t.x,t.y,t.w),this.painter=new d.default(t.colors),this.renderer=new c.default(this.canvas,this.nbThreads,this.painter,this),this.set(t)}return o(e,[{key:"on",value:function(){var e;(e=this.event).on.apply(e,arguments)}},{key:"notify",value:function(){var e;(e=this.event).notify.apply(e,arguments)}},{key:"set",value:function(e){"type"in e&&(this.type=e.type),"smooth"in e&&(this.smooth=e.smooth),"iter"in e&&(this.iter=e.iter),"x"in e&&this.camera.setPos({x:e.x,y:e.y},e.w),"colors"in e&&this.painter.set(e.colors)}},{key:"draw",value:function(e){return this.renderer.draw(e)}},{key:"drawColor",value:function(){this.renderer.drawColor()}},{key:"resize",value:function(e,t){this.camera.resize(e,t),this.renderer.resize(e,t)}}]),e}();t.default=y},function(e,t,n){var i=n(19);"string"==typeof i&&(i=[[e.i,i,""]]),n(3)(i,{}),i.locals&&(e.exports=i.locals)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(4),s=i(a),u=n(1),f=i(u),l=function(e,t,n){return s.default.GetTriangleToTriangle(1,0,0,1,0,0,e+n/2,t,e,t+n/2,e,t)},c=function(e,t,n){var i=e.transformXY(1,-1),r=e.transformXY(-1,1),o=e.transformXY(-1,-1);if(t>=n){var a=(t-n)/2,u=a+n;return s.default.GetTriangleToTriangle(u,n,a,0,a,n,i.x,i.y,r.x,r.y,o.x,o.y)}var f=(n-t)/2,l=f+t;return s.default.GetTriangleToTriangle(t,l,0,f,0,l,i.x,i.y,r.x,r.y,o.x,o.y)},h=function(){function e(t,n,i,o,a){r(this,e),this.affineMatrix=s.default.Identity(),this.screenSize=new f.default(t,n);var u=Math.min(t,n);this.resolutionLimit=1.11e-15*u,this.x=i,this.y=o,this.w=a,this.reproject()}return o(e,[{key:"reproject",value:function(){this.w=Math.max(this.w,this.resolutionLimit);var e=c(this.affineMatrix,this.screenSize.x,this.screenSize.y),t=l(this.x,this.y,this.w);this.matrix=t.multiply(e),this.matrix_inv=this.matrix.inverse()}},{key:"affineTransform",value:function(e,t,n){var i="Get"+e+"Matrix",r=s.default[i](t,n);this.affineMatrix=this.affineMatrix.multiply(r),this.reproject()}},{key:"affineReset",value:function(){this.affineMatrix=s.default.Identity(),this.reproject()}},{key:"clone",value:function(){return new e(this.screenSize.x,this.screenSize.y,this.x,this.y,this.w)}},{key:"scr2cpx",value:function(e){return this.matrix.transform(e)}},{key:"cpx2scr",value:function(e){return this.matrix_inv.transform(e)}},{key:"getPos",value:function(){return new f.default(this.x,this.y)}},{key:"setPos",value:function(e,t){this.x=e.x,this.y=e.y,t&&(this.w=t),this.reproject()}},{key:"resize",value:function(e,t){this.screenSize=new f.default(e,t);var n=Math.min(e,t);this.resolutionLimit=1.11e-15*n,this.reproject()}},{key:"isZoomLimit",value:function(){return this.w<=this.resolutionLimit}}]),e}();t.default=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(0),s=i(a),u=s.default.get("painter").level(s.default.WARN),f=function(){function e(t){r(this,e),this.set(t)}return o(e,[{key:"set",value:function(e){u.info("set",e),"offset"in e&&(this.offset=e.offset),"density"in e&&(this.density=e.density),"id"in e&&(this.id=e.id),"buffer"in e&&(this.buffer=e.buffer,this.resolution=this.buffer.length)}},{key:"paint",value:function(e,t,n){var i,r,o,a,s,f=performance.now(),l=this.offset*this.resolution,c=this.density,h=this.resolution,d=this.buffer,p=0,b=0;for(o=0;o<e.height;o+=1)for(b=(o+e.y1)*n+e.x1,r=0;r<e.width;r+=1)a=e.buffer[p],s=0===a?4278190080:d[~~((a*c+l)%h)],t[b]=s,p+=1,b+=1;i=performance.now()-f,u.debug("tile painted ! "+e.width*e.height+" pixels in "+i.toFixed(2)+"ms")}}]),e}();t.default=f},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.canvas=t,this.context=t.getContext("2d"),this.offCanvas=document.createElement("canvas"),this.offCanvas.width=t.width,this.offCanvas.height=t.height}return r(e,[{key:"redraw",value:function(e,t){if(this.lastType!==t.type&&(this.lastMatrix=null),this.lastMatrix){var n=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),i=this.lastMatrix.inverse().multiply(e).inverse();this.offCanvas.getContext("2d").putImageData(n,0,0),this.context.transform(i.a,i.b,i.c,i.d,i.e,i.f),this.context.drawImage(this.offCanvas,0,0),this.context.setTransform(1,0,0,1,0,0),this.lastMatrix=e}else this.lastMatrix=e,this.lastType=t.type}}]),e}();t.default=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(0),s=i(a),u=n(16),f=i(u),l=n(10),c=i(l),h=n(14),d=i(h),p=s.default.get("renderer").level(s.default.INFO),b=100,v="undefined"==typeof window,y=function(){function e(t,n,i,o){r(this,e),this.canvas=t,this.resize(),this.callback=this.callback.bind(this),this.scheduler=new f.default(n,this.callback),this.painter=i,this.engine=o,p.debug("built")}return o(e,[{key:"resize",value:function(){this.scheduler&&this.scheduler.interrupt();var e=this.canvas;this.context=e.getContext("2d"),this.imageData=this.context.createImageData(e.width,e.height),this.imageBuffer=new Uint32Array(this.imageData.data.buffer),this.width=e.width,this.height=e.height,v||(this.redrawer=new c.default(e));var t=this.width/this.height,n=Math.round(Math.sqrt(b/t)),i=Math.round(Math.sqrt(b/t)*t);p.debug("Screen "+this.width+"px * "+this.height+"px (ratio "+t.toFixed(2)+"),"+(" "+i+" * "+n+" = "+n*i+" tiles ("+b+" asked)")+(", each ~ "+Math.round(e.width/i)+"px * "+Math.round(this.canvas.height/n)+"px")),this.tiles=[];for(var r=0;r<n;r+=1)for(var o=0;o<i;o+=1){var a={i:o,j:r,id:this.tiles.length};a.x1=Math.round(o*e.width/i),a.x2=Math.round((o+1)*e.width/i)-1,a.y1=Math.round(r*e.height/n),a.y2=Math.round((r+1)*e.height/n)-1,a.x=(a.x1+a.x2)/2,a.y=(a.y1+a.y2)/2,a.width=a.x2-a.x1+1,a.height=a.y2-a.y1+1,a.buffer=new Float32Array(a.width*a.height),a.indexScreen=a.y1*e.width+a.x1,this.tiles.push(a)}}},{key:"getIterationsAt",value:function(e){var t=(0,d.default)(this.engine);return t(e.x,e.y,this.engine.iter)}},{key:"getHistogram",value:function(){var e=new Array(this.engine.iter+1).fill(0),t=!0,n=!1,i=void 0;try{for(var r,o=this.tiles[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=!0,u=!1,f=void 0;try{for(var l,c=a.buffer[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var h=l.value;h=Math.round(h),h>=0&&h<=this.engine.iter&&(e[h]+=1)}}catch(e){u=!0,f=e}finally{try{!s&&c.return&&c.return()}finally{if(u)throw f}}}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}return e}},{key:"drawColor",value:function(){var e=this;this.tiles.forEach(function(t){e.painter.paint(t,e.imageBuffer,e.width)}),this.context.putImageData(this.imageData,0,0,0,0,this.width,this.height)}},{key:"draw",value:function(e){var t=this,n=this.engine;n.notify("draw.start",{}),this.scheduler.interrupt(),this.redrawer&&this.redrawer.redraw(n.camera.matrix,n),this.timeStart=performance.now();var i=Object.assign({},n.camera.matrix,{type:n.type,smooth:n.smooth,iter:n.iter}),r=this.tiles.map(function(t){return{action:"draw",tile:t,params:e,model:i}}),o=this.scheduler.schedule(r).then(function(){var e=performance.now()-t.timeStart;p.info("frame rendered in "+e+"ms")}).catch(function(){p.info("scheduler encountered a problem")});return o}},{key:"callback",value:function(e){if(p.debug("received callback",e),"end-draw"!==e.action)throw new Error;var t=e.tile;this.tiles[t.id].buffer=t.buffer,this.painter.paint(t,this.imageBuffer,this.width),this.context.putImageData(this.imageData,0,0,t.x1,t.y1,t.width,t.height)}}]),e}();t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=4;t.default={mandelbrot:function(e,t,n){for(var r=0,o=0,a=0,s=0,u=0;u<n&&a+s<=i;++u)o=(r+r)*o+t,r=a-s+e,a=r*r,s=o*o;return u},burningship:function(e,t,n){var r,o,a=0,s=0,u=0,f=0,l=0;for(t=-t;(o=(a+a)*s+t,r=u-f+e,a=Math.abs(r),s=Math.abs(o),!(++l>=n))&&(u=a*a,f=s*s,!(u+f>i)););return l},mandelbrot3:function(e,t,n){for(var r,o,a=0,s=0,u=0,f=0,l=0;(r=u*a-3*a*f+e,o=3*u*s-f*s+t,a=r,s=o,!(++l>=n))&&(u=a*a,f=s*s,!(u+f>i)););return l},mandelbrot4:function(e,t,n){for(var r,o,a=0,s=0,u=0,f=0,l=0;(r=u*u-6*u*f+f*f+e,o=4*u*a*s-4*a*f*s+t,a=r,s=o,!(++l>=n))&&(u=a*a,f=s*s,!(u+f>i)););return l},tippetts:function(e,t,n){for(var r=0,o=0,a=0,s=0,u=0;u<n&&a+s<=i;++u)r=a-s+e,o=(r+r)*o+t,a=r*r,s=o*o;return u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=4,r=1/Math.log(2),o=1/Math.log(4);t.default={mandelbrot:function(e,t,n){for(var o=0,a=0,s=0,u=0,f=0,l=0;f<n&&s+u<=i;++f)a=(o+o)*a+t,o=s-u+e,s=o*o,u=a*a;if(f===n)return f;for(l=0;l<4;++l)a=(o+o)*a+t,o=s-u+e,s=o*o,u=a*a;return 5+f-Math.log(Math.log(s+u))*r},mandelbrot3:function(e,t,n){for(var r,a,s,u=0,f=0,l=0,c=0,h=0;(a=l*u-3*u*c+e,s=3*l*f-c*f+t,u=a,f=s,!(++h>=n))&&(l=u*u,c=f*f,!(l+c>i)););if(h===n)return h;for(r=0;r<4;++r)a=l*u-3*u*c+e,s=3*l*f-c*f+t,u=a,f=s,l=u*u,c=f*f;return 5+h-Math.log(Math.log(l+c))*o},mandelbrot4:function(e,t,n){for(var r,a,s=0,u=0,f=0,l=0,c=0;(r=f*f-6*f*l+l*l+e,a=4*f*s*u-4*s*l*u+t,s=r,u=a,!(++c>=n))&&(f=s*s,l=u*u,!(f+l>i)););return c===n?c:5+c-Math.log(Math.log(f+l))*o},burningship:function(e,t,n){var o,a,s,u=0,f=0,l=0,c=0,h=0;for(t=-t;(s=(u+u)*f+t,a=l-c+e,u=Math.abs(a),f=Math.abs(s),!(++h>=n))&&(l=u*u,c=f*f,!(l+c>i)););if(h===n)return h;for(o=0;o<4;++o)s=(u+u)*f+t,a=l-c+e,u=Math.abs(a),f=Math.abs(s),l=u*u,c=f*f;return 5+h-Math.log(Math.log(l+c))*r}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return e.smooth&&e.type in u.default?u.default[e.type]:a.default[e.type]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(12),a=i(o),s=n(13),u=i(s)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(0),s=i(a),u=(s.default.get("batch").level(s.default.WARN),0),f=function(){function e(t){var n=this;if(r(this,e),0===t.length)throw new Error;this.orders=t,this.id=u,this.nbDone=0,this.nbTodo=t.length,u+=1,this.promise=new Promise(function(e,t){n.promiseHandlers={resolve:e,reject:t}})}return o(e,[{key:"nextOrder",value:function(){if(0===this.orders.length)throw new Error;var e=this.orders.shift();return e.batchId=this.id,e}},{key:"done",value:function(e){this.nbDone+=1,this.isFinished()&&this.promiseHandlers.resolve()}},{key:"hasMore",value:function(){return this.orders.length>0}},{key:"isFinished",value:function(){return this.nbDone===this.nbTodo}}]),e}();t.default=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(0),s=i(a),u=n(15),f=i(u),l=void 0;l=n(20);var c=s.default.get("scheduler").level(s.default.INFO),h=function(){function e(t,n){if(r(this,e),!t)throw new Error;this.batch=null,this.workers=[],this.onmessage=this.onmessage.bind(this),this.callback=n,this.nbThreads=t,this.createWorkers()}return o(e,[{key:"createWorkers",value:function(){for(var e=0;e<this.nbThreads;e+=1){var t=new l;t.onmessage=this.onmessage,t.postMessage({action:"init",id:e}),this.workers.push(t)}}},{key:"dispatchOrder",value:function(e,t){if(t){var n=t.tile;0===n.buffer.length&&(c.warn("recreate neutered buffer",t),n.buffer=new Float32Array(n.width*n.height)),e.postMessage(t,[n.buffer.buffer])}}},{key:"endDraw",value:function(e,t){if(!this.batch||this.batch.id!==t.batchId)return void c.debug("drop old tile");if(this.callback(t),this.batch.done(t),this.batch.hasMore()){var n=this.batch.nextOrder();this.dispatchOrder(e,n)}this.batch.isFinished()&&(this.batch=null)}},{key:"onmessage",value:function(e){var t=e.data,n=e.target;switch(c.debug("received",t.action,t),t.action){case"end-draw":this.endDraw(n,t);break;default:throw new Error("Illegal action",t)}}},{key:"interrupt",value:function(){this.batch&&(c.debug("interrupting"),this.batch.promiseHandlers.reject(),this.batch=null)}},{key:"schedule",value:function(e){var t=this;if(this.batch)throw new Error;return this.batch=new f.default(e),c.debug("new scheduling batch with id",this.batch.id),this.workers.forEach(function(e){var n=t.batch.nextOrder();t.dispatchOrder(e,n)}),this.batch.promise}}]),e}();t.default=h},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e),this.listeners={}}return r(e,[{key:"on",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"notify",value:function(e,t){var n=this;setTimeout(function(){var i=n.listeners[e]||[];t&&(t.evt=e),i.forEach(function(e){e(t)})},0)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=[],t={left:37,up:38,right:39,down:40,"+":107,"-":109,H:72,R:82,S:83,V:86},n=[];document.addEventListener("keyup",function(t){e[t.keyCode]=!1}),document.addEventListener("keydown",function(t){e[t.keyCode]=!0;var i=t.shiftKey?.1:1,r=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var f=s.value,l=f.combo.every(function(t){return e[t]});if(l)return void f.func(i)}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}});var i=function(e,i){var r=e.split(" "),o=[],a=!0,s=!1,u=void 0;try{for(var f,l=r[Symbol.iterator]();!(a=(f=l.next()).done);a=!0){var c=f.value;if(!(c in t))throw new Error("Unknown key"+c);o.push(t[c])}}catch(e){s=!0,u=e}finally{try{!a&&l.return&&l.return()}finally{if(s)throw u}}n.push({combo:o,func:i}),n.sort(function(e,t){return t.combo.length-e.combo.length})};return{bind:i}}()},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,"*{margin:0;box-sizing:border-box}canvas#main{position:fixed;left:0}canvas#main,canvas#main.offset{transition:left .3s ease-in-out}canvas#main.offset{left:150px}.ui{position:fixed;z-index:1;-webkit-user-select:none;font-family:Roboto,Lucida Grande,Lucida Sans Unicode,Verdana,sans-serif}.ui a{color:#000;text-decoration:none}.burger{position:absolute;padding:16px;color:#fff;line-height:0;display:inline-block;cursor:pointer;background-color:rgba(0,0,0,.2)}.burger:hover{background-color:#3f51b5;box-shadow:2px 2px 5px 0 rgba(0,0,0,.4);transition:all .2s ease-in-out}.sidebar{position:absolute;display:flex;flex-direction:column;width:300px;height:100vh;background-color:#fff;box-shadow:4px 0 10px 0 rgba(0,0,0,.4);left:-320px}.sidebar,.sidebar.visible{transition:left .3s ease-in-out}.sidebar.visible{left:0}.toolbox{cursor:pointer;background-color:#3f51b5;font-size:24px;height:56px}.toolbox .switch{padding:16px}.toolbox .switch,.toolbox .tab{line-height:0;display:inline-block;color:#ccc}.toolbox .tab{padding:16px 12px}.toolbox .tab:hover{color:#fff}.toolbox .tab.selected{padding-bottom:13px;border-bottom:3px solid #ffd740;color:#fff}.content{overflow-y:auto;padding-top:8px;display:none}.content.visible{display:block}.infobox{position:fixed;bottom:0;right:0;background:#fff;margin:16px;font-family:monospace;padding:16px;box-shadow:2px 2px 20px 0 rgba(0,0,0,.4);-webkit-user-select:auto;display:none}.infobox.visible{display:block}.infobox .title{font-family:Roboto;font-weight:700;padding-bottom:.5em}.snackbar{position:fixed;bottom:0;left:50%;color:#fff;text-align:center;border-radius:2px;letter-spacing:.3px;font-size:14px;background:#323232;min-width:288px;max-width:568px;padding:14px 24px;transform:translate(-50%,100%)}.snackbar,.snackbar.visible{transition:all .3s ease-in-out}.snackbar.visible{transform:translate(-50%)}.list{margin-top:8px}.list .subheader{font-size:14px;padding:17px 16px;line-height:14px;color:rgba(0,0,0,.54);font-weight:500}.list .subheader.accent{color:#3f51b5}.list .subheader:first-child{padding-top:9px}.list hr{margin:0;border:none;border-bottom:1px solid rgba(0,0,0,.12)}.list .list-item-misc{padding:16px}.list .list-item-slider{padding:8px 24px}.list .list-item-one-line{display:flex}.list .list-item-one-line .icon{padding:12px 16px;color:#3f51b5}.list .list-item-one-line .text{padding:16px;line-height:16px}.list .list-item-one-line.selectable{cursor:pointer}.list .list-item-one-line.selectable:hover{background-color:#ffe57f}.list .list-item-one-line.selected{background-color:#ffc400}.list .list-item-more{display:flex}.list .list-item-more .avatar{padding:14px 20px 0 16px}.list .list-item-more .avatar i{color:#fff;background-color:#3f51b5;padding:6px;border-radius:18px}.list .list-item-more .text{padding:16px 16px 16px 0}.list .list-item-checkbox{padding:16px 0;line-height:16px;height:48px;position:relative;display:block}.list .list-item-checkbox .label{position:absolute;left:72px}.list .list-item-checkbox .checkbox{position:absolute;top:12px;left:16px;display:inline-block;width:24px;height:24px;overflow:hidden;border:2px solid rgba(0,0,0,.54);border-radius:2px;color:transparent;transition:all .2s ease-in-out}.list p{color:rgba(0,0,0,.54);font-size:14px}.list .social a{color:#fff}.swatches{line-height:0}.swatches .swatch{position:relative;display:inline-block;padding:2px}.swatches .swatch img{-webkit-filter:contrast(90%) brightness(80%);position:relative}.swatches .swatch .border{box-sizing:content-box;position:absolute;display:none;width:100%;height:100%;background-color:#ffc400;padding:6px;top:-6px;left:-6px;z-index:1;box-shadow:6px 6px 20px 0 #222}.swatches .swatch.selected img,.swatches .swatch:hover img{-webkit-filter:contrast(100%) brightness(100%)}.swatches .swatch.selected img{z-index:2}.swatches .swatch.selected .border{display:block}.noUi-target{border:none;box-shadow:none}.noUi-background{background:none}.noUi-base{background:#3f51b5;border-top:7px solid #fff;border-bottom:8px solid #fff}.noUi-horizontal .noUi-handle{width:15px;height:15px;left:-7px;top:-6px;border-radius:8px;background:#3f51b5;box-shadow:none;border:none;position:relative;z-index:4}.noUi-origin{background:#aaa}.noUi-handle:after,.noUi-handle:before{display:none}input[type=checkbox]{position:absolute;z-index:-1000;left:-1000px;overflow:hidden;clip:rect(0 0 0 0);height:1px;width:1px;margin:-1px}input[type=checkbox]:checked+.list-item-checkbox .checkbox{background-color:#3f51b5;border:none;color:#fff;transition:all .2s ease-in-out}.key{display:inline-block;vertical-align:middle;border:1px solid #888;background:#eee;border-radius:4px;padding:1px 4px;margin:2px 0;font-size:13px;min-width:1.8em;text-align:center}",""]);
},function(e,t,n){e.exports=function(){return new Worker(n.p+"04bbceb4d4a1ca5aca44.worker.js")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(6),o=i(r),a=n(5),s=i(a),u=n(1);i(u),n(7),setTimeout(function(){var e=document.getElementById("maincanvas");e.width=window.innerWidth,e.height=window.innerHeight;var t=new o.default({canvas:e,nbThreads:1,colors:{offset:0,density:20,bufferId:0}});new s.default(t)},100)}]);